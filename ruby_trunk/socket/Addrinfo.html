<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Addrinfo &mdash; socket</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Addrinfo",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../index.html'>Home</a> &raquo; 
        <a href='../index.html'>Ruby-2.5.0</a> &raquo; 
        <a href='index.html'>socket</a> &raquo; 
        <a href='_index.html#alpha_A'>Index (A)</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>Addrinfo&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Addrinfo</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          Data
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          Data
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Data</span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'>Data</li>
          <li class='next'>Addrinfo</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2566'>ext/socket/raddrinfo.c</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L6'>ext/socket/lib/socket.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The Addrinfo class maps <code>struct addrinfo</code> to ruby.  This
structure identifies an Internet host and a service.</p>

  </div>
</div>
</div>        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#foreach-class_method" title=".foreach (class method)">.<strong>foreach</strong>(nodename, service, family = nil, socktype = nil, protocol = nil, flags = nil, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>iterates over the list of <code>Addrinfo</code> objects obtained by
<a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">.getaddrinfo</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#getaddrinfo-class_method" title="getaddrinfo (class method)">.<strong>getaddrinfo</strong>(nodename, service, family, socktype, protocol, flags)  &#x21d2; Addrinfo, ... </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a list of addrinfo objects as an array.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip-class_method" title="ip (class method)">.<strong>ip</strong>(host)  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for IP address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(sockaddr)  &#x21d2; Addrinfo </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a new instance of <code>Addrinfo</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#tcp-class_method" title="tcp (class method)">.<strong>tcp</strong>(host, port)  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for TCP address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#udp-class_method" title="udp (class method)">.<strong>udp</strong>(host, port)  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for UDP address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unix-class_method" title="unix (class method)">.<strong>unix</strong>(path[, socktype])  &#x21d2; Addrinfo </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns an addrinfo object for UNIX socket address.</p></div>
    </div>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#ip%3F-instance_method" title="#ip? (instance method)">#<strong>ip?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is internet (IPv4/IPv6) address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4%3F-instance_method" title="#ipv4? (instance method)">#<strong>ipv4?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is IPv4 address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4_loopback%3F-instance_method" title="#ipv4_loopback? (instance method)">#<strong>ipv4_loopback?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4 loopback address (127.0.0.0/8).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4_multicast%3F-instance_method" title="#ipv4_multicast? (instance method)">#<strong>ipv4_multicast?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4 multicast address (224.0.0.0/4).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv4_private%3F-instance_method" title="#ipv4_private? (instance method)">#<strong>ipv4_private?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4 private address (10.0.0.0/8, 172.16.0.0/12,
192.168.0.0/16).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6%3F-instance_method" title="#ipv6? (instance method)">#<strong>ipv6?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is IPv6 address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_linklocal%3F-instance_method" title="#ipv6_linklocal? (instance method)">#<strong>ipv6_linklocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 link local address (ff80::/10).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_loopback%3F-instance_method" title="#ipv6_loopback? (instance method)">#<strong>ipv6_loopback?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 loopback address (::1).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_global%3F-instance_method" title="#ipv6_mc_global? (instance method)">#<strong>ipv6_mc_global?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast global scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_linklocal%3F-instance_method" title="#ipv6_mc_linklocal? (instance method)">#<strong>ipv6_mc_linklocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast link-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_nodelocal%3F-instance_method" title="#ipv6_mc_nodelocal? (instance method)">#<strong>ipv6_mc_nodelocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast node-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_orglocal%3F-instance_method" title="#ipv6_mc_orglocal? (instance method)">#<strong>ipv6_mc_orglocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast organization-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_mc_sitelocal%3F-instance_method" title="#ipv6_mc_sitelocal? (instance method)">#<strong>ipv6_mc_sitelocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast site-local scope address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_multicast%3F-instance_method" title="#ipv6_multicast? (instance method)">#<strong>ipv6_multicast?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 multicast address (ff00::/8).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_sitelocal%3F-instance_method" title="#ipv6_sitelocal? (instance method)">#<strong>ipv6_sitelocal?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 site local address (ffc0::/10).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_unique_local%3F-instance_method" title="#ipv6_unique_local? (instance method)">#<strong>ipv6_unique_local?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 unique local address (fc00::/7, RFC4193).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_unspecified%3F-instance_method" title="#ipv6_unspecified? (instance method)">#<strong>ipv6_unspecified?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv6 unspecified address (::).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_v4compat%3F-instance_method" title="#ipv6_v4compat? (instance method)">#<strong>ipv6_v4compat?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4-compatible IPv6 address (::/80).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#ipv6_v4mapped%3F-instance_method" title="#ipv6_v4mapped? (instance method)">#<strong>ipv6_v4mapped?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true for IPv4-mapped IPv6 address (::ffff:0:0/80).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#unix%3F-instance_method" title="#unix? (instance method)">#<strong>unix?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>returns true if addrinfo is UNIX address.</p></div>
    </div>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#afamily-instance_method" title="#afamily (instance method)">#<strong>afamily</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the address family as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#bind-instance_method" title="#bind (instance method)">#<strong>bind</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket bound to self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#canonname-instance_method" title="#canonname (instance method)">#<strong>canonname</strong>  &#x21d2; String<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the canonical name as an string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect-instance_method" title="#connect (instance method)">#<strong>connect</strong>([opts]) {|socket| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket connected to the address of self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect_from-instance_method" title="#connect_from (instance method)">#<strong>connect_from</strong>([local_addr_args], [opts]) {|socket| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket connected to the address of self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#connect_to-instance_method" title="#connect_to (instance method)">#<strong>connect_to</strong>([remote_addr_args], [opts]) {|socket| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a socket connected to <em>remote_addr_args</em> and bound to self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#family_addrinfo-instance_method" title="#family_addrinfo (instance method)">#<strong>family_addrinfo</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates an <code>Addrinfo</code> object from the arguments.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#getnameinfo-instance_method" title="#getnameinfo (instance method)">#<strong>getnameinfo</strong>  &#x21d2; Array, service </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns nodename and service as a pair of strings.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a string which shows addrinfo in human-readable form.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect_sockaddr-instance_method" title="#inspect_sockaddr (instance method)">#<strong>inspect_sockaddr</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns a string which shows the sockaddr in <em>addrinfo</em> with
human-readable form.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip_address-instance_method" title="#ip_address (instance method)">#<strong>ip_address</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the IP address as a string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip_port-instance_method" title="#ip_port (instance method)">#<strong>ip_port</strong>  &#x21d2; port </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the port number as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ip_unpack-instance_method" title="#ip_unpack (instance method)">#<strong>ip_unpack</strong>  &#x21d2; Array, port </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the IP address and port number as 2-element array.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ipv6_to_ipv4-instance_method" title="#ipv6_to_ipv4 (instance method)">#<strong>ipv6_to_ipv4</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns IPv4 address of IPv4 mapped/compatible IPv6 address.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#listen-instance_method" title="#listen (instance method)">#<strong>listen</strong>(backlog = Socket::SOMAXCONN)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a listening socket bound to self.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#pfamily-instance_method" title="#pfamily (instance method)">#<strong>pfamily</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the protocol family as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#protocol-instance_method" title="#protocol (instance method)">#<strong>protocol</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the socket type as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#socktype-instance_method" title="#socktype (instance method)">#<strong>socktype</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the socket type as an integer.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_s-instance_method" title="#to_sockaddr (instance method)">#<strong>to_sockaddr</strong>  &#x21d2; String </a>
      (also: #to_sockaddr)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>returns the socket address as packed struct sockaddr string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_sockaddr-instance_method" title="#to_sockaddr (instance method)">#<strong>to_sockaddr</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#to_s-instance_method" title="Addrinfo#to_s (method)">#to_s</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unix_path-instance_method" title="#unix_path (instance method)">#<strong>unix_path</strong>  &#x21d2; path </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the socket path as a string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#connect_internal-instance_method" title="#connect_internal (instance method)">#<strong>connect_internal</strong>(local_addrinfo, timeout = nil)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>creates a new <a href="Socket.html" title="Socket (class)">::Socket</a> connected to the address of <code>local_addrinfo</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#marshal_dump-instance_method" title="#marshal_dump (instance method)">#<strong>marshal_dump</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#marshal_load-instance_method" title="#marshal_load (instance method)">#<strong>marshal_load</strong>(ary)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    <div class='inline-block'>
      <span class='overload'>.<strong>new</strong>(sockaddr)  &#x21d2; <code>Addrinfo</code> </span>
      <span class='overload'>.<strong>new</strong>(sockaddr, family)  &#x21d2; <code>Addrinfo</code> </span>
      <span class='overload'>.<strong>new</strong>(sockaddr, family, socktype)  &#x21d2; <code>Addrinfo</code> </span>
      <span class='overload'>.<strong>new</strong>(sockaddr, family, socktype, protocol)  &#x21d2; <code>Addrinfo</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a new instance of <code>Addrinfo</code>. The instance contains
sockaddr, family, socktype, protocol. sockaddr means struct sockaddr which
can be used for connect(2), etc. family, socktype and protocol are integers
which is used for arguments of socket(2).</p>

<p>sockaddr is specified as an array or a string. The array should be
compatible to the value of <a href="IPSocket.html#addr-instance_method" title="IPSocket#addr (method)">IPSocket#addr</a> or <a href="UNIXSocket.html#addr-instance_method" title="UNIXSocket#addr (method)">UNIXSocket#addr</a>. The string
should be struct sockaddr as generated by <a href="Socket.html#sockaddr_in-class_method" title="Socket.sockaddr_in (method)">Socket.sockaddr_in</a> or
<a href="Socket.html#unpack_sockaddr_un-class_method" title="Socket.unpack_sockaddr_un (method)">Socket.unpack_sockaddr_un</a>.</p>

<p>sockaddr examples:</p>
<ul><li><dl class="rdoc-list label-list"><dt>"AF_INET", 46102, "localhost.localdomain", "127.0.0.1"
<dd></dd></dl>
</li><li><dl class="rdoc-list label-list"><dt>"AF_INET6", 42304, "ip6-localhost", "::1"
<dd></dd></dl>
</li><li><dl class="rdoc-list label-list"><dt>"AF_UNIX", "/tmp/sock"
<dd></dd></dl>
</li><li>
<p><a href="Socket.html" title="Socket (class)">::Socket</a>.sockaddr_in("smtp", "2001:DB8::1")</p>
</li><li>
<p><a href="Socket.html" title="Socket (class)">::Socket</a>.sockaddr_in(80, "172.18.22.42")</p>
</li><li>
<p><a href="Socket.html" title="Socket (class)">::Socket</a>.sockaddr_in(80, "<a
href="www.ruby-lang.org">www.ruby-lang.org</a>")</p>
</li><li>
<p><a href="Socket.html" title="Socket (class)">::Socket</a>.sockaddr_un("/tmp/sock")</p>
</li></ul>

<p>In an AF_INET/AF_INET6 sockaddr array, the 4th element, numeric IP address,
is used to construct socket address in the <code>Addrinfo</code> instance.
If the 3rd element, textual host name, is non-nil, it is also recorded but
used only for <a href="#inspect-instance_method" title="Addrinfo#inspect (method)">#inspect</a>.</p>

<p>family is specified as an integer to specify the protocol family such as
<code>Socket::PF_INET</code>. It can be a symbol or a string which is the constant
name with or without PF_ prefix such as :INET, :INET6, :UNIX, "PF_INET",
etc. If omitted, PF_UNSPEC is assumed.</p>

<p>socktype is specified as an integer to specify the socket type such as
<code>Socket::SOCK_STREAM</code>. It can be a symbol or a string which is the constant
name with or without SOCK_ prefix such as :STREAM, :DGRAM, :RAW,
"SOCK_STREAM", etc. If omitted, 0 is assumed.</p>

<p>protocol is specified as an integer to specify the protocol such as
<code>Socket::IPPROTO_TCP</code>. It must be an integer, unlike family and socktype.
If omitted, 0 is assumed. Note that 0 is reasonable value for most
protocols, except raw socket.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1036-L1114'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1036</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_initialize(int argc, VALUE *argv, VALUE self)
{
    rb_addrinfo_t *rai;
    VALUE sockaddr_arg, sockaddr_ary, pfamily, socktype, protocol;
    int i_pfamily, i_socktype, i_protocol;
    struct sockaddr *sockaddr_ptr;
    socklen_t sockaddr_len;
    VALUE canonname = Qnil, inspectname = Qnil;

    if (check_addrinfo(self))
        rb_raise(rb_eTypeError, &quot;already initialized socket address&quot;);
    DATA_PTR(self) = rai = alloc_addrinfo();

    rb_scan_args(argc, argv, &quot;13&quot;, &amp;sockaddr_arg, &amp;pfamily, &amp;socktype, &amp;protocol);

    i_pfamily = NIL_P(pfamily) ? PF_UNSPEC : rsock_family_arg(pfamily);
    i_socktype = NIL_P(socktype) ? 0 : rsock_socktype_arg(socktype);
    i_protocol = NIL_P(protocol) ? 0 : NUM2INT(protocol);

    sockaddr_ary = rb_check_array_type(sockaddr_arg);
    if (!NIL_P(sockaddr_ary)) {
        VALUE afamily = rb_ary_entry(sockaddr_ary, 0);
        int af;
        StringValue(afamily);
        if (rsock_family_to_int(RSTRING_PTR(afamily), RSTRING_LEN(afamily), &amp;af) == -1)
	    rb_raise(rb_eSocket, &quot;unknown address family: %s&quot;, StringValueCStr(afamily));
        switch (af) {
          case AF_INET: /* [&quot;AF_INET&quot;, 46102, &quot;localhost.localdomain&quot;, &quot;127.0.0.1&quot;] */
#ifdef INET6
          case AF_INET6: /* [&quot;AF_INET6&quot;, 42304, &quot;ip6-localhost&quot;, &quot;::1&quot;] */
#endif
          {
            VALUE service = rb_ary_entry(sockaddr_ary, 1);
            VALUE nodename = rb_ary_entry(sockaddr_ary, 2);
            VALUE numericnode = rb_ary_entry(sockaddr_ary, 3);
            int flags;

            service = INT2NUM(NUM2INT(service));
            if (!NIL_P(nodename))
                StringValue(nodename);
            StringValue(numericnode);
            flags = AI_NUMERICHOST;
#ifdef AI_NUMERICSERV
            flags |= AI_NUMERICSERV;
#endif

            init_addrinfo_getaddrinfo(rai, numericnode, service,
                    INT2NUM(i_pfamily ? i_pfamily : af), INT2NUM(i_socktype), INT2NUM(i_protocol),
                    INT2NUM(flags),
                    nodename, service);
            break;
          }

#ifdef HAVE_SYS_UN_H
          case AF_UNIX: /* [&quot;AF_UNIX&quot;, &quot;/tmp/sock&quot;] */
          {
            VALUE path = rb_ary_entry(sockaddr_ary, 1);
            StringValue(path);
            init_unix_addrinfo(rai, path, SOCK_STREAM);
            break;
          }
#endif

          default:
            rb_raise(rb_eSocket, &quot;unexpected address family&quot;);
        }
    }
    else {
        StringValue(sockaddr_arg);
        sockaddr_ptr = (struct sockaddr *)RSTRING_PTR(sockaddr_arg);
        sockaddr_len = RSTRING_SOCKLEN(sockaddr_arg);
        init_addrinfo(rai, sockaddr_ptr, sockaddr_len,
                      i_pfamily, i_socktype, i_protocol,
                      canonname, inspectname);
    }

    return self;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="foreach-class_method">
  <h3 class='signature  first'>
    .<strong>foreach</strong>(nodename, service, family = nil, socktype = nil, protocol = nil, flags = nil, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>iterates over the list of <code>Addrinfo</code> objects obtained by
<a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">.getaddrinfo</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_foreach'>foreach</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_x'>x</span> <span class='rbrace'>}</span>
<span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1:80 TCP (:80)&gt;
</span><span class='comment'>#   #&lt;Addrinfo: 127.0.0.1:80 UDP (:80)&gt;
</span><span class='comment'>#   #&lt;Addrinfo: [::1]:80 TCP (:80)&gt;
</span><span class='comment'>#   #&lt;Addrinfo: [::1]:80 UDP (:80)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L226-L228'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


226
227
228</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 226</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_foreach'>foreach</span><span class='lparen'>(</span><span class='id identifier rubyid_nodename'>nodename</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='comma'>,</span> <span class='id identifier rubyid_family'>family</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_socktype'>socktype</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_protocol'>protocol</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_getaddrinfo'><a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">getaddrinfo</a></span><span class='lparen'>(</span><span class='id identifier rubyid_nodename'>nodename</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='comma'>,</span> <span class='id identifier rubyid_family'>family</span><span class='comma'>,</span> <span class='id identifier rubyid_socktype'>socktype</span><span class='comma'>,</span> <span class='id identifier rubyid_protocol'>protocol</span><span class='comma'>,</span> <span class='id identifier rubyid_flags'>flags</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="getaddrinfo-class_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family, socktype, protocol, flags)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family, socktype, protocol)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family, socktype)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service, family)  &#x21d2; <code>Addrinfo</code>, ... </span>
      <span class='overload'>.<strong>getaddrinfo</strong>(nodename, service)  &#x21d2; <code>Addrinfo</code>, ... </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a list of addrinfo objects as an array.</p>

<p>This method converts nodename (hostname) and service (port) to addrinfo.
Since the conversion is not unique, the result is a list of addrinfo
objects.</p>

<p>nodename or service can be nil if no conversion intended.</p>

<p>family, socktype and protocol are hint for preferred protocol. If the
result will be used for a socket with SOCK_STREAM, SOCK_STREAM should be
specified as socktype. If so, <code>getaddrinfo</code> returns addrinfo
list appropriate for SOCK_STREAM. If they are omitted or nil is given, the
result is not restricted.</p>

<p>Similarly, PF_INET6 as family restricts for IPv6.</p>

<p>flags should be bitwise OR of Socket::AI_??? constants such as follows.
Note that the exact list of the constants depends on OS.</p>

<pre class="code ruby"><code class="ruby">AI_PASSIVE      Get address to use with bind()
AI_CANONNAME    Fill in the canonical name
AI_NUMERICHOST  Prevent host name resolution
AI_NUMERICSERV  Prevent service name resolution
AI_V4MAPPED     Accept IPv4-mapped IPv6 addresses
AI_ALL          Allow all addresses
AI_ADDRCONFIG   Accept only if any address is assigned</code></pre>

<p>Note that socktype should be specified whenever application knows the usage
of the address. Some platform causes an error when socktype is omitted and
servname is specified as an integer because some port numbers, 512 for
example, are ambiguous without socktype.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_getaddrinfo'>getaddrinfo</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.kame.net</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>STREAM</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [#&lt;Addrinfo: 203.178.141.194:80 TCP (www.kame.net)&gt;,
</span><span class='comment'>#    #&lt;Addrinfo: [2001:200:dff:fff1:216:3eff:feb1:44d7]:80 TCP (www.kame.net)&gt;]</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2375-L2382'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2375
2376
2377
2378
2379
2380
2381
2382</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2375</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_getaddrinfo(int argc, VALUE *argv, VALUE self)
{
    VALUE node, service, family, socktype, protocol, flags;

    rb_scan_args(argc, argv, &quot;24&quot;, &amp;node, &amp;service, &amp;family, &amp;socktype, &amp;protocol, &amp;flags);
    return addrinfo_list_new(node, service, family, socktype, protocol, flags);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip-class_method">
  <h3 class='signature '>
    .<strong>ip</strong>(host)  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for IP address.</p>

<p>The port, socktype, protocol of the result is filled by zero. So, it is not
appropriate to create a socket.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_ip'>ip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1 (localhost)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2395-L2406'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2395
2396
2397
2398
2399
2400
2401
2402
2403
2404
2405
2406</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2395</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_ip(VALUE self, VALUE host)
{
    VALUE ret;
    rb_addrinfo_t *rai;
    ret = addrinfo_firstonly_new(host, Qnil,
            INT2NUM(PF_UNSPEC), INT2FIX(0), INT2FIX(0), INT2FIX(0));
    rai = get_addrinfo(ret);
    rai-&gt;socktype = 0;
    rai-&gt;protocol = 0;
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="tcp-class_method">
  <h3 class='signature '>
    .<strong>tcp</strong>(host, port)  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for TCP address.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'>tcp</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>smtp</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1:25 TCP (localhost:smtp)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2416-L2421'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2416
2417
2418
2419
2420
2421</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2416</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_tcp(VALUE self, VALUE host, VALUE port)
{
    return addrinfo_firstonly_new(host, port,
            INT2NUM(PF_UNSPEC), INT2NUM(SOCK_STREAM), INT2NUM(IPPROTO_TCP), INT2FIX(0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="udp-class_method">
  <h3 class='signature '>
    .<strong>udp</strong>(host, port)  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for UDP address.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_udp'>udp</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>daytime</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='comment'>#=&gt; #&lt;Addrinfo: 127.0.0.1:13 UDP (localhost:daytime)&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2431-L2436'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2431
2432
2433
2434
2435
2436</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2431</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_udp(VALUE self, VALUE host, VALUE port)
{
    return addrinfo_firstonly_new(host, port,
            INT2NUM(PF_UNSPEC), INT2NUM(SOCK_DGRAM), INT2NUM(IPPROTO_UDP), INT2FIX(0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unix-class_method">
  <h3 class='signature '>
    .<strong>unix</strong>(path[, socktype])  &#x21d2; <code>Addrinfo</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns an addrinfo object for UNIX socket address.</p>

<p><em>socktype</em> specifies the socket type. If it is omitted, :STREAM is
used.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'>unix</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>         <span class='comment'>#=&gt; #&lt;Addrinfo: /tmp/sock SOCK_STREAM&gt;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'>unix</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>DGRAM</span><span class='rparen'>)</span> <span class='comment'>#=&gt; #&lt;Addrinfo: /tmp/sock SOCK_DGRAM&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2452-L2471'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2452
2453
2454
2455
2456
2457
2458
2459
2460
2461
2462
2463
2464
2465
2466
2467
2468
2469
2470
2471</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2452</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_s_unix(int argc, VALUE *argv, VALUE self)
{
    VALUE path, vsocktype, addr;
    int socktype;
    rb_addrinfo_t *rai;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;path, &amp;vsocktype);

    if (NIL_P(vsocktype))
        socktype = SOCK_STREAM;
    else
        socktype = rsock_socktype_arg(vsocktype);

    addr = addrinfo_s_allocate(rb_cAddrinfo);
    DATA_PTR(addr) = rai = alloc_addrinfo();
    init_unix_addrinfo(rai, path, socktype);
    OBJ_INFECT(addr, path);
    return addr;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="ip?-instance_method">
  <h3 class='signature ro first'>
    #<strong>ip?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is internet (IPv4/IPv6) address. returns false
otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip?'>ip?</span> <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip?'>ip?</span>       <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip?'>ip?</span>    <span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1829-L1835'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1829
1830
1831
1832
1833
1834
1835</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1829</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_p(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    return IS_IP_FAMILY(family) ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is IPv4 address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv4?'>ipv4?</span> <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv4?'>ipv4?</span>       <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv4?'>ipv4?</span>    <span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1849-L1854'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1849
1850
1851
1852
1853
1854</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1849</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_p(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return ai_get_afamily(rai) == AF_INET ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4_loopback?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4_loopback?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4 loopback address (127.0.0.0/8). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2071-L2079'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2071
2072
2073
2074
2075
2076
2077
2078
2079</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2071</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_loopback_p(VALUE self)
{
    uint32_t a;
    if (!extract_in_addr(self, &amp;a)) return Qfalse;
    if ((a &amp; 0xff000000) == 0x7f000000) /* 127.0.0.0/8 */
        return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4_multicast?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4_multicast?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4 multicast address (224.0.0.0/4). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2085-L2093'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2085
2086
2087
2088
2089
2090
2091
2092
2093</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2085</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_multicast_p(VALUE self)
{
    uint32_t a;
    if (!extract_in_addr(self, &amp;a)) return Qfalse;
    if ((a &amp; 0xf0000000) == 0xe0000000) /* 224.0.0.0/4 */
        return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv4_private?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv4_private?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4 private address (10.0.0.0/8, 172.16.0.0/12,
192.168.0.0/16). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2055-L2065'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2055
2056
2057
2058
2059
2060
2061
2062
2063
2064
2065</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2055</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv4_private_p(VALUE self)
{
    uint32_t a;
    if (!extract_in_addr(self, &amp;a)) return Qfalse;
    if ((a &amp; 0xff000000) == 0x0a000000 || /* 10.0.0.0/8 */
        (a &amp; 0xfff00000) == 0xac100000 || /* 172.16.0.0/12 */
        (a &amp; 0xffff0000) == 0xc0a80000)   /* 192.168.0.0/16 */
        return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is IPv6 address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6?'>ipv6?</span> <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6?'>ipv6?</span>       <span class='comment'>#=&gt; true
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6?'>ipv6?</span>    <span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1868-L1877'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1868
1869
1870
1871
1872
1873
1874
1875
1876
1877</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1868</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_p(VALUE self)
{
#ifdef AF_INET6
    rb_addrinfo_t *rai = get_addrinfo(self);
    return ai_get_afamily(rai) == AF_INET6 ? Qtrue : Qfalse;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_linklocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_linklocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 link local address (ff80::/10). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2146-L2152'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2146
2147
2148
2149
2150
2151
2152</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2146</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_linklocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_LINKLOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_loopback?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_loopback?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 loopback address (::1). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2122-L2128'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2122
2123
2124
2125
2126
2127
2128</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2122</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_loopback_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_LOOPBACK(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_global?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_global?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast global scope address. It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2254-L2260'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2254
2255
2256
2257
2258
2259
2260</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2254</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_global_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_GLOBAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_linklocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_linklocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast link-local scope address. It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2218-L2224'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2218
2219
2220
2221
2222
2223
2224</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2218</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_linklocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_LINKLOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_nodelocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_nodelocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast node-local scope address. It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2206-L2212'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2206
2207
2208
2209
2210
2211
2212</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2206</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_nodelocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_NODELOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_orglocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_orglocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast organization-local scope address. It
returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2242-L2248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2242
2243
2244
2245
2246
2247
2248</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2242</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_orglocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_ORGLOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_mc_sitelocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_mc_sitelocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast site-local scope address. It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2230-L2236'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2230
2231
2232
2233
2234
2235
2236</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2230</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_mc_sitelocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MC_SITELOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_multicast?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_multicast?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 multicast address (ff00::/8). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2134-L2140'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2134
2135
2136
2137
2138
2139
2140</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2134</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_multicast_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_MULTICAST(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_sitelocal?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_sitelocal?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 site local address (ffc0::/10). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2158-L2164'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2158
2159
2160
2161
2162
2163
2164</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2158</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_sitelocal_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_SITELOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_unique_local?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_unique_local?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 unique local address (fc00::/7, RFC4193). It returns
false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2170-L2176'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2170
2171
2172
2173
2174
2175
2176</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2170</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_unique_local_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_UNIQUE_LOCAL(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_unspecified?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_unspecified?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv6 unspecified address (::). It returns false otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2110-L2116'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2110
2111
2112
2113
2114
2115
2116</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2110</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_unspecified_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_UNSPECIFIED(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_v4compat?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_v4compat?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4-compatible IPv6 address (::/80). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2194-L2200'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2194
2195
2196
2197
2198
2199
2200</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2194</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_v4compat_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_V4COMPAT(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_v4mapped?-instance_method">
  <h3 class='signature ro'>
    #<strong>ipv6_v4mapped?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true for IPv4-mapped IPv6 address (::ffff:0:0/80). It returns false
otherwise.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2182-L2188'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2182
2183
2184
2185
2186
2187
2188</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2182</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_v4mapped_p(VALUE self)
{
    struct in6_addr *addr = extract_in6_addr(self);
    if (addr &amp;&amp; IN6_IS_ADDR_V4MAPPED(addr)) return Qtrue;
    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unix?-instance_method">
  <h3 class='signature ro'>
    #<strong>unix?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns true if addrinfo is UNIX address. returns false otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unix?'>unix?</span> <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unix?'>unix?</span>       <span class='comment'>#=&gt; false
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unix?'>unix?</span>    <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1891-L1900'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1891
1892
1893
1894
1895
1896
1897
1898
1899
1900</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1891</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_unix_p(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
#ifdef AF_UNIX
    return ai_get_afamily(rai) == AF_UNIX ? Qtrue : Qfalse;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="afamily-instance_method">
  <h3 class='signature  first'>
    #<strong>afamily</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the address family as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_afamily'>afamily</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>AF_INET</span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1719-L1724'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1719
1720
1721
1722
1723
1724</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1719</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_afamily(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(ai_get_afamily(rai));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bind-instance_method">
  <h3 class='signature '>
    #<strong>bind</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket bound to self.</p>

<p>If a block is given, it is called with the socket and the value of the
block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_udp'><a href="#udp-class_method" title="Addrinfo.udp (method)">udp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>9981</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_local_address'>local_address</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_recv'>recv</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span> <span class='comment'>#=&gt; &quot;hello&quot;
</span><span class='rbrace'>}</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L174-L193'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 174</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bind'>bind</span>
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Socket.html#new-class_method" title="Socket.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_ipv6only!'>ipv6only!</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipv6?'>ipv6?</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_setsockopt'>setsockopt</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='const'>SOCKET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>REUSEADDR</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_sock'>sock</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sock'>sock</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="canonname-instance_method">
  <h3 class='signature '>
    #<strong>canonname</strong>  &#x21d2; <code>String</code><sup>?</sup>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the canonical name as an string.</p>

<p>nil is returned if no canonical name.</p>

<p>The canonical name is set by <a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">.getaddrinfo</a> when AI_CANONNAME is
specified.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_list'>list</span> <span class='op'>=</span> <span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_getaddrinfo'><a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">getaddrinfo</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>INET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>STREAM</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>AI_CANONNAME</span><span class='rparen'>)</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_list'>list</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='comment'>#=&gt; #&lt;Addrinfo: 221.186.184.68:80 TCP carbon.ruby-lang.org (www.ruby-lang.org)&gt;
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_list'>list</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_canonname'>canonname</span> <span class='comment'>#=&gt; &quot;carbon.ruby-lang.org&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1810-L1815'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1810
1811
1812
1813
1814
1815</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1810</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_canonname(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return rai-&gt;canonname;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>connect</strong>([opts]) {|socket| ... } </span>
      <span class='overload'>#<strong>connect</strong>([opts])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket connected to the address of self.</p>

<p>The optional argument <em>opts</em> is options represented by a hash.
<em>opts</em> may have following options:</p>
<dl class="rdoc-list label-list"><dt>:timeout
<dd>
<p>specify the timeout in seconds.</p>
</dd></dl>

<p>If a block is given, it is called with the socket and the value of the
block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L136-L138'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


136
137
138</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 136</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_connect_internal'>connect_internal</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_from-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>connect_from</strong>([local_addr_args], [opts]) {|socket| ... } </span>
      <span class='overload'>#<strong>connect_from</strong>([local_addr_args], [opts])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket connected to the address of self.</p>

<p>If one or more arguments given as <em>local_addr_args</em>, it is used as
the local address of the socket. <em>local_addr_args</em> is given for
family_addrinfo to obtain actual address.</p>

<p>If <em>local_addr_args</em> is not given, the local address of the socket
is not bound.</p>

<p>The optional last argument <em>opts</em> is options represented by a hash.
<em>opts</em> may have following options:</p>
<dl class="rdoc-list label-list"><dt>:timeout
<dd>
<p>specify the timeout in seconds.</p>
</dd></dl>

<p>If a block is given, it is called with the socket and the value of the
block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_connect_from'>connect_from</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span>

<span class='comment'># Addrinfo object can be taken for the argument.
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_connect_from'>connect_from</span><span class='lparen'>(</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L113-L115'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


113
114
115</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 113</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect_from'>connect_from</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_connect_internal'>connect_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_internal-instance_method">
  <h3 class='signature priv'>
    #<strong>connect_internal</strong>(local_addrinfo, timeout = nil)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a new <a href="Socket.html" title="Socket (class)">::Socket</a> connected to the address of <code>local_addrinfo</code>.</p>

<p>If <em>local_addrinfo</em> is nil, the address of the socket is not bound.</p>

<p>The <em>timeout</em> specify the seconds for timeout. <code>Errno::ETIMEDOUT</code> is
raised when timeout occur.</p>

<p>If a block is given the created socket is yielded for each address.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L50-L79'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 50</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect_internal'>connect_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_local_addrinfo'>local_addrinfo</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># :yields: socket
</span>  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Socket.html#new-class_method" title="Socket.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_ipv6only!'>ipv6only!</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipv6?'>ipv6?</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span> <span class='id identifier rubyid_local_addrinfo'>local_addrinfo</span> <span class='kw'>if</span> <span class='id identifier rubyid_local_addrinfo'>local_addrinfo</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_timeout'>timeout</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_connect_nonblock'>connect_nonblock</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='label'>exception:</span> <span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='int'>0</span> <span class='comment'># success or EISCONN, other errors raise
</span>        <span class='kw'>break</span>
      <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_wait_writable'>wait_writable</span>
        <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_wait_writable'>wait_writable</span><span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span> <span class='kw'>or</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ETIMEDOUT</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user specified timeout</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>end</span> <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_sock'>sock</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sock'>sock</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="connect_to-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>connect_to</strong>([remote_addr_args], [opts]) {|socket| ... } </span>
      <span class='overload'>#<strong>connect_to</strong>([remote_addr_args], [opts])  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a socket connected to <em>remote_addr_args</em> and bound to self.</p>

<p>The optional last argument <em>opts</em> is options represented by a hash.
<em>opts</em> may have following options:</p>
<dl class="rdoc-list label-list"><dt>:timeout
<dd>
<p>specify the timeout in seconds.</p>
</dd></dl>

<p>If a block is given, it is called with the socket and the value of the
block is returned. The socket is returned otherwise.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_connect_to'>connect_to</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
  <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET / HTTP/1.0\r\nHost: www.ruby-lang.org\r\n\r\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
<span class='rbrace'>}</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L159-L162'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


159
160
161
162</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 159</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_connect_to'>connect_to</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_remote_addrinfo'>remote_addrinfo</span> <span class='op'>=</span> <span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_remote_addrinfo'>remote_addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_connect_internal'>connect_internal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="family_addrinfo-instance_method">
  <h3 class='signature '>
    #<strong>family_addrinfo</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates an <code>Addrinfo</code> object from the arguments.</p>

<p>The arguments are interpreted as similar to self.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.0.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>4649</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>www.ruby-lang.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; #&lt;Addrinfo: 221.186.184.68:80 TCP (www.ruby-lang.org:80)&gt;
</span>
<span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock2</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'>#=&gt; #&lt;Addrinfo: /tmp/sock2 SOCK_STREAM&gt;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L17-L39'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 17</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_family_addrinfo'>family_addrinfo</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no address specified</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='const'>Addrinfo</span> <span class='op'>===</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>too many arguments</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_addrinfo'>addrinfo</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span> <span class='op'>!=</span> <span class='id identifier rubyid_addrinfo'>addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span><span class='rparen'>)</span> <span class='op'>||</span>
       <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span> <span class='op'>!=</span> <span class='id identifier rubyid_addrinfo'>addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Addrinfo type mismatch</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_addrinfo'>addrinfo</span>
  <span class='kw'>elsif</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ip?'>ip?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IP address needs host and port but </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> arguments given</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>2</span>
    <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
    <span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_getaddrinfo'><a href="#getaddrinfo-class_method" title="Addrinfo.getaddrinfo (method)">getaddrinfo</a></span><span class='lparen'>(</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='kw'>elsif</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_unix?'>unix?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UNIX socket needs single path argument but </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> arguments given</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
    <span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unexpected family</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="getnameinfo-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>getnameinfo</strong>  &#x21d2; <code>Array</code>, <code>service</code> </span>
      <span class='overload'>#<strong>getnameinfo</strong>(flags)  &#x21d2; <code>Array</code>, <code>service</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns nodename and service as a pair of strings. This converts struct
sockaddr in addrinfo to textual representation.</p>

<p>flags should be bitwise OR of Socket::NI_??? constants.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getnameinfo'>getnameinfo</span> <span class='comment'>#=&gt; [&quot;localhost&quot;, &quot;www&quot;]
</span>
<span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_getnameinfo'>getnameinfo</span><span class='lparen'>(</span><span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>NI_NUMERICSERV</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; [&quot;localhost&quot;, &quot;80&quot;]</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1917-L1940'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1917
1918
1919
1920
1921
1922
1923
1924
1925
1926
1927
1928
1929
1930
1931
1932
1933
1934
1935
1936
1937
1938
1939
1940</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1917</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_getnameinfo(int argc, VALUE *argv, VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    VALUE vflags;
    char hbuf[1024], pbuf[1024];
    int flags, error;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;vflags);

    flags = NIL_P(vflags) ? 0 : NUM2INT(vflags);

    if (rai-&gt;socktype == SOCK_DGRAM)
        flags |= NI_DGRAM;

    error = getnameinfo(&amp;rai-&gt;addr.addr, rai-&gt;sockaddr_len,
                        hbuf, (socklen_t)sizeof(hbuf), pbuf, (socklen_t)sizeof(pbuf),
                        flags);
    if (error) {
        rsock_raise_socket_error(&quot;getnameinfo&quot;, error);
    }

    return rb_assoc_new(rb_str_new2(hbuf), rb_str_new2(pbuf));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    #<strong>inspect</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a string which shows addrinfo in human-readable form.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='comment'>#=&gt; &quot;#&lt;Addrinfo: 127.0.0.1:80 TCP (localhost)&gt;&quot;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>    <span class='comment'>#=&gt; &quot;#&lt;Addrinfo: /tmp/sock SOCK_STREAM&gt;&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1436-L1503'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1436
1437
1438
1439
1440
1441
1442
1443
1444
1445
1446
1447
1448
1449
1450
1451
1452
1453
1454
1455
1456
1457
1458
1459
1460
1461
1462
1463
1464
1465
1466
1467
1468
1469
1470
1471
1472
1473
1474
1475
1476
1477
1478
1479
1480
1481
1482
1483
1484
1485
1486
1487
1488
1489
1490
1491
1492
1493
1494
1495
1496
1497
1498
1499
1500
1501
1502
1503</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1436</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_inspect(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int internet_p;
    VALUE ret;

    ret = rb_sprintf(&quot;#&lt;%s: &quot;, rb_obj_classname(self));

    inspect_sockaddr(self, ret);

    if (rai-&gt;pfamily &amp;&amp; ai_get_afamily(rai) != rai-&gt;pfamily) {
        ID id = rsock_intern_protocol_family(rai-&gt;pfamily);
        if (id)
            rb_str_catf(ret, &quot; %s&quot;, rb_id2name(id));
        else
            rb_str_catf(ret, &quot; PF_\?\?\?(%d)&quot;, rai-&gt;pfamily);
    }

    internet_p = rai-&gt;pfamily == PF_INET;
#ifdef INET6
    internet_p = internet_p || rai-&gt;pfamily == PF_INET6;
#endif
    if (internet_p &amp;&amp; rai-&gt;socktype == SOCK_STREAM &amp;&amp;
        (rai-&gt;protocol == 0 || rai-&gt;protocol == IPPROTO_TCP)) {
        rb_str_cat2(ret, &quot; TCP&quot;);
    }
    else if (internet_p &amp;&amp; rai-&gt;socktype == SOCK_DGRAM &amp;&amp;
        (rai-&gt;protocol == 0 || rai-&gt;protocol == IPPROTO_UDP)) {
        rb_str_cat2(ret, &quot; UDP&quot;);
    }
    else {
        if (rai-&gt;socktype) {
            ID id = rsock_intern_socktype(rai-&gt;socktype);
            if (id)
                rb_str_catf(ret, &quot; %s&quot;, rb_id2name(id));
            else
                rb_str_catf(ret, &quot; SOCK_\?\?\?(%d)&quot;, rai-&gt;socktype);
        }

        if (rai-&gt;protocol) {
            if (internet_p) {
                ID id = rsock_intern_ipproto(rai-&gt;protocol);
                if (id)
                    rb_str_catf(ret, &quot; %s&quot;, rb_id2name(id));
                else
                    goto unknown_protocol;
            }
            else {
              unknown_protocol:
                rb_str_catf(ret, &quot; UNKNOWN_PROTOCOL(%d)&quot;, rai-&gt;protocol);
            }
        }
    }

    if (!NIL_P(rai-&gt;canonname)) {
        VALUE name = rai-&gt;canonname;
        rb_str_catf(ret, &quot; %s&quot;, StringValueCStr(name));
    }

    if (!NIL_P(rai-&gt;inspectname)) {
        VALUE name = rai-&gt;inspectname;
        rb_str_catf(ret, &quot; (%s)&quot;, StringValueCStr(name));
    }

    rb_str_buf_cat2(ret, &quot;&gt;&quot;);
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect_sockaddr-instance_method">
  <h3 class='signature '>
    #<strong>inspect_sockaddr</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns a string which shows the sockaddr in <em>addrinfo</em> with
human-readable form.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inspect_sockaddr'>inspect_sockaddr</span>     <span class='comment'>#=&gt; &quot;127.0.0.1:80&quot;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ip6-localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inspect_sockaddr'>inspect_sockaddr</span> <span class='comment'>#=&gt; &quot;[::1]:80&quot;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inspect_sockaddr'>inspect_sockaddr</span>        <span class='comment'>#=&gt; &quot;/tmp/sock&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1516-L1520'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1516
1517
1518
1519
1520</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1516</span></pre>
<pre class='code cpp'>

VALUE
rsock_addrinfo_inspect_sockaddr(VALUE self)
{
    return inspect_sockaddr(self, rb_str_new(&quot;&quot;, 0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip_address-instance_method">
  <h3 class='signature '>
    #<strong>ip_address</strong>  &#x21d2; <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the IP address as a string.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip_address'>ip_address</span>    <span class='comment'>#=&gt; &quot;127.0.0.1&quot;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip_address'>ip_address</span>          <span class='comment'>#=&gt; &quot;::1&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1978-L1992'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1978</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_address(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    VALUE vflags;
    VALUE ret;

    if (!IS_IP_FAMILY(family))
	rb_raise(rb_eSocket, &quot;need IPv4 or IPv6 address&quot;);

    vflags = INT2NUM(NI_NUMERICHOST|NI_NUMERICSERV);
    ret = addrinfo_getnameinfo(1, &amp;vflags, self);
    return rb_ary_entry(ret, 0);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip_port-instance_method">
  <h3 class='signature '>
    #<strong>ip_port</strong>  &#x21d2; <code>port</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the port number as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip_port'>ip_port</span>    <span class='comment'>#=&gt; 80
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip_port'>ip_port</span>          <span class='comment'>#=&gt; 80</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2003-L2039'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
2025
2026
2027
2028
2029
2030
2031
2032
2033
2034
2035
2036
2037
2038
2039</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2003</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_port(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    int port;

    if (!IS_IP_FAMILY(family)) {
      bad_family:
#ifdef AF_INET6
	rb_raise(rb_eSocket, &quot;need IPv4 or IPv6 address&quot;);
#else
	rb_raise(rb_eSocket, &quot;need IPv4 address&quot;);
#endif
    }

    switch (family) {
      case AF_INET:
        if (rai-&gt;sockaddr_len != sizeof(struct sockaddr_in))
            rb_raise(rb_eSocket, &quot;unexpected sockaddr size for IPv4&quot;);
        port = ntohs(rai-&gt;addr.in.sin_port);
        break;

#ifdef AF_INET6
      case AF_INET6:
        if (rai-&gt;sockaddr_len != sizeof(struct sockaddr_in6))
            rb_raise(rb_eSocket, &quot;unexpected sockaddr size for IPv6&quot;);
        port = ntohs(rai-&gt;addr.in6.sin6_port);
        break;
#endif

      default:
	goto bad_family;
    }

    return INT2NUM(port);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ip_unpack-instance_method">
  <h3 class='signature '>
    #<strong>ip_unpack</strong>  &#x21d2; <code>Array</code>, <code>port</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the IP address and port number as 2-element array.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip_unpack'>ip_unpack</span>    <span class='comment'>#=&gt; [&quot;127.0.0.1&quot;, 80]
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ip_unpack'>ip_unpack</span>          <span class='comment'>#=&gt; [&quot;::1&quot;, 80]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1951-L1967'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1951
1952
1953
1954
1955
1956
1957
1958
1959
1960
1961
1962
1963
1964
1965
1966
1967</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1951</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ip_unpack(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    VALUE vflags;
    VALUE ret, portstr;

    if (!IS_IP_FAMILY(family))
	rb_raise(rb_eSocket, &quot;need IPv4 or IPv6 address&quot;);

    vflags = INT2NUM(NI_NUMERICHOST|NI_NUMERICSERV);
    ret = addrinfo_getnameinfo(1, &amp;vflags, self);
    portstr = rb_ary_entry(ret, 1);
    rb_ary_store(ret, 1, INT2NUM(atoi(StringValueCStr(portstr))));
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ipv6_to_ipv4-instance_method">
  <h3 class='signature '>
    #<strong>ipv6_to_ipv4</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns IPv4 address of IPv4 mapped/compatible IPv6 address. It returns nil
if <code>self</code> is not IPv4 mapped/compatible IPv6 address.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::192.0.2.3</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>      <span class='comment'>#=&gt; #&lt;Addrinfo: 192.0.2.3&gt;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::ffff:192.0.2.3</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span> <span class='comment'>#=&gt; #&lt;Addrinfo: 192.0.2.3&gt;
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>              <span class='comment'>#=&gt; nil
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_ip'><a href="#ip-class_method" title="Addrinfo.ip (method)">ip</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>192.0.2.3</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>        <span class='comment'>#=&gt; nil
</span><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ipv6_to_ipv4'>ipv6_to_ipv4</span>      <span class='comment'>#=&gt; nil</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2272-L2291'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2272
2273
2274
2275
2276
2277
2278
2279
2280
2281
2282
2283
2284
2285
2286
2287
2288
2289
2290
2291</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2272</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_ipv6_to_ipv4(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    struct in6_addr *addr;
    int family = ai_get_afamily(rai);
    if (family != AF_INET6) return Qnil;
    addr = &amp;rai-&gt;addr.in6.sin6_addr;
    if (IN6_IS_ADDR_V4MAPPED(addr) || IN6_IS_ADDR_V4COMPAT(addr)) {
        struct sockaddr_in sin4;
        INIT_SOCKADDR_IN(&amp;sin4, sizeof(sin4));
        memcpy(&amp;sin4.sin_addr, (char*)addr + sizeof(*addr) - sizeof(sin4.sin_addr), sizeof(sin4.sin_addr));
        return rsock_addrinfo_new((struct sockaddr *)&amp;sin4, (socklen_t)sizeof(sin4),
                                  PF_INET, rai-&gt;socktype, rai-&gt;protocol,
                                  rai-&gt;canonname, rai-&gt;inspectname);
    }
    else {
        return Qnil;
    }
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="listen-instance_method">
  <h3 class='signature '>
    #<strong>listen</strong>(backlog = Socket::SOMAXCONN)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>creates a listening socket bound to self.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/lib/socket.rb#L196-L216'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/lib/socket.rb', line 196</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_listen'>listen</span><span class='lparen'>(</span><span class='id identifier rubyid_backlog'>backlog</span><span class='op'>=</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>SOMAXCONN</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sock'>sock</span> <span class='op'>=</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Socket.html#new-class_method" title="Socket.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_ipv6only!'>ipv6only!</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_ipv6?'>ipv6?</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_setsockopt'>setsockopt</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='const'>SOCKET</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>REUSEADDR</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_listen'>listen</span><span class='lparen'>(</span><span class='id identifier rubyid_backlog'>backlog</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_sock'>sock</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_sock'>sock</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_sock'>sock</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="marshal_dump-instance_method">
  <h3 class='signature nodoc'>
    #<strong>marshal_dump</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1523-L1597'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1523
1524
1525
1526
1527
1528
1529
1530
1531
1532
1533
1534
1535
1536
1537
1538
1539
1540
1541
1542
1543
1544
1545
1546
1547
1548
1549
1550
1551
1552
1553
1554
1555
1556
1557
1558
1559
1560
1561
1562
1563
1564
1565
1566
1567
1568
1569
1570
1571
1572
1573
1574
1575
1576
1577
1578
1579
1580
1581
1582
1583
1584
1585
1586
1587
1588
1589
1590
1591
1592
1593
1594
1595
1596
1597</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1523</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_mdump(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    VALUE sockaddr, afamily, pfamily, socktype, protocol, canonname, inspectname;
    int afamily_int = ai_get_afamily(rai);
    ID id;

    id = rsock_intern_protocol_family(rai-&gt;pfamily);
    if (id == 0)
        rb_raise(rb_eSocket, &quot;unknown protocol family: %d&quot;, rai-&gt;pfamily);
    pfamily = rb_id2str(id);

    if (rai-&gt;socktype == 0)
        socktype = INT2FIX(0);
    else {
        id = rsock_intern_socktype(rai-&gt;socktype);
        if (id == 0)
            rb_raise(rb_eSocket, &quot;unknown socktype: %d&quot;, rai-&gt;socktype);
        socktype = rb_id2str(id);
    }

    if (rai-&gt;protocol == 0)
        protocol = INT2FIX(0);
    else if (IS_IP_FAMILY(afamily_int)) {
        id = rsock_intern_ipproto(rai-&gt;protocol);
        if (id == 0)
            rb_raise(rb_eSocket, &quot;unknown IP protocol: %d&quot;, rai-&gt;protocol);
        protocol = rb_id2str(id);
    }
    else {
        rb_raise(rb_eSocket, &quot;unknown protocol: %d&quot;, rai-&gt;protocol);
    }

    canonname = rai-&gt;canonname;

    inspectname = rai-&gt;inspectname;

    id = rsock_intern_family(afamily_int);
    if (id == 0)
        rb_raise(rb_eSocket, &quot;unknown address family: %d&quot;, afamily_int);
    afamily = rb_id2str(id);

    switch(afamily_int) {
#ifdef HAVE_SYS_UN_H
      case AF_UNIX:
      {
        struct sockaddr_un *su = &amp;rai-&gt;addr.un;
        char *s, *e;
        s = su-&gt;sun_path;
        e = (char*)su + rai-&gt;sockaddr_len;
        while (s &lt; e &amp;&amp; *(e-1) == &#39;\0&#39;)
            e--;
        sockaddr = rb_str_new(s, e-s);
        break;
      }
#endif

      default:
      {
        char hbuf[NI_MAXHOST], pbuf[NI_MAXSERV];
        int error;
        error = getnameinfo(&amp;rai-&gt;addr.addr, rai-&gt;sockaddr_len,
                            hbuf, (socklen_t)sizeof(hbuf), pbuf, (socklen_t)sizeof(pbuf),
                            NI_NUMERICHOST|NI_NUMERICSERV);
        if (error) {
            rsock_raise_socket_error(&quot;getnameinfo&quot;, error);
        }
        sockaddr = rb_assoc_new(rb_str_new_cstr(hbuf), rb_str_new_cstr(pbuf));
        break;
      }
    }

    return rb_ary_new3(7, afamily, sockaddr, pfamily, socktype, protocol, canonname, inspectname);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="marshal_load-instance_method">
  <h3 class='signature nodoc'>
    #<strong>marshal_load</strong>(ary)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1600-L1708'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1600
1601
1602
1603
1604
1605
1606
1607
1608
1609
1610
1611
1612
1613
1614
1615
1616
1617
1618
1619
1620
1621
1622
1623
1624
1625
1626
1627
1628
1629
1630
1631
1632
1633
1634
1635
1636
1637
1638
1639
1640
1641
1642
1643
1644
1645
1646
1647
1648
1649
1650
1651
1652
1653
1654
1655
1656
1657
1658
1659
1660
1661
1662
1663
1664
1665
1666
1667
1668
1669
1670
1671
1672
1673
1674
1675
1676
1677
1678
1679
1680
1681
1682
1683
1684
1685
1686
1687
1688
1689
1690
1691
1692
1693
1694
1695
1696
1697
1698
1699
1700
1701
1702
1703
1704
1705
1706
1707
1708</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1600</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_mload(VALUE self, VALUE ary)
{
    VALUE v;
    VALUE canonname, inspectname;
    int afamily, pfamily, socktype, protocol;
    union_sockaddr ss;
    socklen_t len;
    rb_addrinfo_t *rai;

    if (check_addrinfo(self))
        rb_raise(rb_eTypeError, &quot;already initialized socket address&quot;);

    ary = rb_convert_type(ary, T_ARRAY, &quot;Array&quot;, &quot;to_ary&quot;);

    v = rb_ary_entry(ary, 0);
    StringValue(v);
    if (rsock_family_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;afamily) == -1)
        rb_raise(rb_eTypeError, &quot;unexpected address family&quot;);

    v = rb_ary_entry(ary, 2);
    StringValue(v);
    if (rsock_family_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;pfamily) == -1)
        rb_raise(rb_eTypeError, &quot;unexpected protocol family&quot;);

    v = rb_ary_entry(ary, 3);
    if (v == INT2FIX(0))
        socktype = 0;
    else {
        StringValue(v);
        if (rsock_socktype_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;socktype) == -1)
            rb_raise(rb_eTypeError, &quot;unexpected socktype&quot;);
    }

    v = rb_ary_entry(ary, 4);
    if (v == INT2FIX(0))
        protocol = 0;
    else {
        StringValue(v);
        if (IS_IP_FAMILY(afamily)) {
            if (rsock_ipproto_to_int(RSTRING_PTR(v), RSTRING_LEN(v), &amp;protocol) == -1)
                rb_raise(rb_eTypeError, &quot;unexpected protocol&quot;);
        }
        else {
            rb_raise(rb_eTypeError, &quot;unexpected protocol&quot;);
        }
    }

    v = rb_ary_entry(ary, 5);
    if (NIL_P(v))
        canonname = Qnil;
    else {
        StringValue(v);
        canonname = v;
    }

    v = rb_ary_entry(ary, 6);
    if (NIL_P(v))
        inspectname = Qnil;
    else {
        StringValue(v);
        inspectname = v;
    }

    v = rb_ary_entry(ary, 1);
    switch(afamily) {
#ifdef HAVE_SYS_UN_H
      case AF_UNIX:
      {
        struct sockaddr_un uaddr;
        INIT_SOCKADDR_UN(&amp;uaddr, sizeof(struct sockaddr_un));

        StringValue(v);
        if (sizeof(uaddr.sun_path) &lt; (size_t)RSTRING_LEN(v))
            rb_raise(rb_eSocket,
                &quot;too long AF_UNIX path (%&quot;PRIuSIZE&quot; bytes given but %&quot;PRIuSIZE&quot; bytes max)&quot;,
                (size_t)RSTRING_LEN(v), sizeof(uaddr.sun_path));
        memcpy(uaddr.sun_path, RSTRING_PTR(v), RSTRING_LEN(v));
        len = (socklen_t)sizeof(uaddr);
        memcpy(&amp;ss, &amp;uaddr, len);
        break;
      }
#endif

      default:
      {
        VALUE pair = rb_convert_type(v, T_ARRAY, &quot;Array&quot;, &quot;to_ary&quot;);
        struct rb_addrinfo *res;
        int flags = AI_NUMERICHOST;
#ifdef AI_NUMERICSERV
        flags |= AI_NUMERICSERV;
#endif
        res = call_getaddrinfo(rb_ary_entry(pair, 0), rb_ary_entry(pair, 1),
                               INT2NUM(pfamily), INT2NUM(socktype), INT2NUM(protocol),
                               INT2NUM(flags), 1);

        len = res-&gt;ai-&gt;ai_addrlen;
        memcpy(&amp;ss, res-&gt;ai-&gt;ai_addr, res-&gt;ai-&gt;ai_addrlen);
        rb_freeaddrinfo(res);
        break;
      }
    }

    DATA_PTR(self) = rai = alloc_addrinfo();
    init_addrinfo(rai, &amp;ss.addr, len,
                  pfamily, socktype, protocol,
                  canonname, inspectname);
    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pfamily-instance_method">
  <h3 class='signature '>
    #<strong>pfamily</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the protocol family as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pfamily'>pfamily</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>PF_INET</span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1735-L1740'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1735
1736
1737
1738
1739
1740</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1735</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_pfamily(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(rai-&gt;pfamily);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="protocol-instance_method">
  <h3 class='signature '>
    #<strong>protocol</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the socket type as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>IPPROTO_TCP</span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1767-L1772'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1767
1768
1769
1770
1771
1772</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1767</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_protocol(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(rai-&gt;protocol);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="socktype-instance_method">
  <h3 class='signature '>
    #<strong>socktype</strong>  &#x21d2; <code>Integer</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the socket type as an integer.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_socktype'>socktype</span> <span class='op'>==</span> <span class='const'><a href="Socket.html" title="Socket (class)">Socket</a></span><span class='op'>::</span><span class='const'>SOCK_STREAM</span> <span class='comment'>#=&gt; true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1751-L1756'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1751
1752
1753
1754
1755
1756</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1751</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_socktype(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    return INT2NUM(rai-&gt;socktype);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_s-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>to_sockaddr</strong>  &#x21d2; <code>String</code> </span>
      <span class='overload'>#<strong>to_s</strong>  &#x21d2; <code>String</code> </span>
    </div>
    <span class='aliases'>Also known as: <span class='names'>#to_sockaddr</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>returns the socket address as packed struct sockaddr string.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_tcp'><a href="#tcp-class_method" title="Addrinfo.tcp (method)">tcp</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_sockaddr'><a href="#to_sockaddr-instance_method" title="Addrinfo#to_sockaddr (method)">to_sockaddr</a></span>
<span class='comment'>#=&gt; &quot;\x02\x00\x00P\x7F\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L1785-L1793'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1785
1786
1787
1788
1789
1790
1791
1792
1793</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 1785</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_to_sockaddr(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    VALUE ret;
    ret = rb_str_new((char*)&amp;rai-&gt;addr, rai-&gt;sockaddr_len);
    OBJ_INFECT(ret, self);
    return ret;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_sockaddr-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>to_sockaddr</strong>  &#x21d2; <code>String</code> </span>
      <span class='overload'>#<strong>to_s</strong>  &#x21d2; <code>String</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#to_s-instance_method" title="Addrinfo#to_s (method)">#to_s</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>
</section>

<section class='method_details' id="unix_path-instance_method">
  <h3 class='signature '>
    #<strong>unix_path</strong>  &#x21d2; <code>path</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the socket path as a string.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Addrinfo</span><span class='period'>.</span><span class='id identifier rubyid_unix'><a href="#unix-class_method" title="Addrinfo.unix (method)">unix</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/tmp/sock</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unix_path'>unix_path</span>       <span class='comment'>#=&gt; &quot;/tmp/sock&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/socket/raddrinfo.c#L2304-L2329'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2304
2305
2306
2307
2308
2309
2310
2311
2312
2313
2314
2315
2316
2317
2318
2319
2320
2321
2322
2323
2324
2325
2326
2327
2328
2329</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/socket/raddrinfo.c', line 2304</span></pre>
<pre class='code cpp'>

static VALUE
addrinfo_unix_path(VALUE self)
{
    rb_addrinfo_t *rai = get_addrinfo(self);
    int family = ai_get_afamily(rai);
    struct sockaddr_un *addr;
    char *s, *e;

    if (family != AF_UNIX)
	rb_raise(rb_eSocket, &quot;need AF_UNIX address&quot;);

    addr = &amp;rai-&gt;addr.un;

    s = addr-&gt;sun_path;
    e = (char*)addr + rai-&gt;sockaddr_len;
    if (e &lt; s)
        rb_raise(rb_eSocket, &quot;too short AF_UNIX address: %&quot;PRIuSIZE&quot; bytes given for minimum %&quot;PRIuSIZE&quot; bytes.&quot;,
            (size_t)rai-&gt;sockaddr_len, (size_t)(s - (char *)addr));
    if (addr-&gt;sun_path + sizeof(addr-&gt;sun_path) &lt; e)
        rb_raise(rb_eSocket,
            &quot;too long AF_UNIX path (%&quot;PRIuSIZE&quot; bytes given but %&quot;PRIuSIZE&quot; bytes max)&quot;,
            (size_t)(e - addr-&gt;sun_path), sizeof(addr-&gt;sun_path));
    while (s &lt; e &amp;&amp; *(e-1) == &#39;\0&#39;)
        e--;
    return rb_str_new(s, e-s);
}
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>