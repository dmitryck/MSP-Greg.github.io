<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: WIN32OLE &mdash; win32ole</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "WIN32OLE",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../index.html'>Home</a> &raquo; 
        <a href='../index.html'>Ruby-2.5.0</a> &raquo; 
        <a href='index.html'>win32ole</a> &raquo; 
        <a href='_index.html#alpha_W'>Index (W)</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>WIN32OLE&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: WIN32OLE</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="WIN32OLE/VARIANT.html" title="WIN32OLE::VARIANT (module)">VARIANT</a>      </div>
    </td></tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>Object</span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3952'>ext/win32ole/win32ole.c</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>WIN32OLE</code> objects represent OLE Automation object in Ruby.</p>

<pre class="code ruby"><code class="ruby">By using WIN32OLE, you can access OLE server like VBScript.

Here is sample script.

  require &#39;win32ole&#39;

  excel = WIN32OLE.new(&#39;Excel.Application&#39;)
  excel.visible = true
  workbook = excel.Workbooks.Add();
  worksheet = workbook.Worksheets(1);
  worksheet.Range(&quot;A1:D1&quot;).value = [&quot;North&quot;,&quot;South&quot;,&quot;East&quot;,&quot;West&quot;];
  worksheet.Range(&quot;A2:B2&quot;).value = [5.2, 10];
  worksheet.Range(&quot;C2&quot;).value = 8;
  worksheet.Range(&quot;D2&quot;).value = 20;

  range = worksheet.Range(&quot;A1:D2&quot;);
  range.select
  chart = workbook.Charts.Add;

  workbook.saved = true;

  excel.ActiveWorkbook.Close(0);
  excel.Quit();

Unfortunately, Win32OLE doesn&#39;t support the argument passed by
reference directly.
Instead, Win32OLE provides WIN32OLE::ARGV or WIN32OLE_VARIANT object.
If you want to get the result value of argument passed by reference,
you can use WIN32OLE::ARGV or WIN32OLE_VARIANT.

  oleobj.method(arg1, arg2, refargv3)
  puts WIN32OLE::ARGV[2]   # the value of refargv3 after called oleobj.method

or

  refargv3 = WIN32OLE_VARIANT.new(XXX,
              WIN32OLE::VARIANT::VT_BYREF|WIN32OLE::VARIANT::VT_XXX)
  oleobj.method(arg1, arg2, refargv3)
  p refargv3.value # the value of refargv3 after called oleobj.method.</code></pre>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='ARGV-constant' class='summary_signature'>ARGV =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>void calcsum(int a, int b, out int c) {</p>

<pre class="code ruby"><code class="ruby">c = a + b;
}</code></pre>

<p>then, the Ruby OLE(COM) client script to retrieve the value of argument c
after invoking calcsum method is following:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='int'>10</span>
<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='int'>20</span>
<span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='id identifier rubyid_comserver'>comserver</span><span class='period'>.</span><span class='id identifier rubyid_calcsum'>calcsum</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='rparen'>)</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_c'>c</span> <span class='comment'># =&gt; 0
</span><span class='id identifier rubyid_p'>p</span> <span class='const'>WIN32OLE</span><span class='op'>::</span><span class='const'>ARGV</span> <span class='comment'># =&gt; [10, 20, 30]</span></code></pre>

<p>You can use <a href="WIN32OLE_VARIANT.html" title="WIN32OLE_VARIANT (class)">::WIN32OLE_VARIANT</a> object to retrieve the value of reference
arguments instead of referring <code>ARGV</code>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4034'># File 'ext/win32ole/win32ole.c', line 4034</a>    <pre class='code c'>After invoking OLE methods with reference arguments, you can access
the value of arguments by using ARGV.

If the method of OLE(COM) server written by C#.NET is following</pre>
  </li>
  <li>
    <span id='CP_ACP-constant' class='summary_signature'>CP_ACP =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>ANSI code page. See <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> and <a href="#codepage=-class_method" title="WIN32OLE.codepage= (method)">.codepage=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4039'># File 'ext/win32ole/win32ole.c', line 4039</a>    <pre class='code c'><span class='int'>0</span></pre>
  </li>
  <li>
    <span id='CP_MACCP-constant' class='summary_signature'>CP_MACCP =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>2</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4049'># File 'ext/win32ole/win32ole.c', line 4049</a>    <pre class='code c'><span class='const'>RB_INT2FIX</span><span class='lparen'>(</span><span class='const'><a href="#CP_MACCP-constant" title="WIN32OLE::CP_MACCP (constant)">CP_MACCP</a></span><span class='rparen'>)</span></pre>
  </li>
  <li>
    <span id='CP_OEMCP-constant' class='summary_signature'>CP_OEMCP =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>OEM code page. See <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> and <a href="#codepage=-class_method" title="WIN32OLE.codepage= (method)">.codepage=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4044'># File 'ext/win32ole/win32ole.c', line 4044</a>    <pre class='code c'><span class='int'>1</span></pre>
  </li>
  <li>
    <span id='CP_SYMBOL-constant' class='summary_signature'>CP_SYMBOL =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>symbol code page. See <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> and <a href="#codepage=-class_method" title="WIN32OLE.codepage= (method)">.codepage=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4060'># File 'ext/win32ole/win32ole.c', line 4060</a>    <pre class='code c'><span class='int'>42</span></pre>
  </li>
  <li>
    <span id='CP_THREAD_ACP-constant' class='summary_signature'>CP_THREAD_ACP =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>current thread ANSI code page. See <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> and
<a href="#codepage=-class_method" title="WIN32OLE.codepage= (method)">.codepage=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4055'># File 'ext/win32ole/win32ole.c', line 4055</a>    <pre class='code c'><span class='int'>3</span></pre>
  </li>
  <li>
    <span id='CP_UTF7-constant' class='summary_signature'>CP_UTF7 =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>UTF-7 code page. See <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> and <a href="#codepage=-class_method" title="WIN32OLE.codepage= (method)">.codepage=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4065'># File 'ext/win32ole/win32ole.c', line 4065</a>    <pre class='code c'><span class='int'>65000</span></pre>
  </li>
  <li>
    <span id='CP_UTF8-constant' class='summary_signature'>CP_UTF8 =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>UTF-8 code page. See <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> and <a href="#codepage=-class_method" title="WIN32OLE.codepage= (method)">.codepage=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4070'># File 'ext/win32ole/win32ole.c', line 4070</a>    <pre class='code c'><span class='int'>65001</span></pre>
  </li>
  <li>
    <span id='LOCALE_SYSTEM_DEFAULT-constant' class='summary_signature'>LOCALE_SYSTEM_DEFAULT =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>default locale for the operating system. See <a href="#locale-class_method" title="WIN32OLE.locale (method)">.locale</a> and
<a href="#locale=-class_method" title="WIN32OLE.locale= (method)">.locale=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4076'># File 'ext/win32ole/win32ole.c', line 4076</a>    <pre class='code c'><span class='int'>0x0800</span></pre>
  </li>
  <li>
    <span id='LOCALE_USER_DEFAULT-constant' class='summary_signature'>LOCALE_USER_DEFAULT =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>default locale for the user or process. See <a href="#locale-class_method" title="WIN32OLE.locale (method)">.locale</a> and
<a href="#locale=-class_method" title="WIN32OLE.locale= (method)">.locale=</a>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4082'># File 'ext/win32ole/win32ole.c', line 4082</a>    <pre class='code c'><span class='int'>0x0400</span></pre>
  </li>
  <li>
    <span id='VERSION-constant' class='summary_signature'>VERSION =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Version string of <code>WIN32OLE</code>.</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L4008'># File 'ext/win32ole/win32ole.c', line 4008</a>    <pre class='code c'><span class='id identifier rubyid_rb_str_new2'>rb_str_new2</span><span class='lparen'>(</span><span class='const'>WIN32OLE_VERSION</span><span class='rparen'>)</span></pre>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='class_Attribute_summary'>Class Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#codepage-class_method" title="codepage (class method)">.<strong>codepage</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns current codepage.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#codepage=-class_method" title="codepage= (class method)">.<strong>codepage=</strong>(CP)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets current codepage.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#locale-class_method" title="locale (class method)">.<strong>locale</strong>  &#x21d2; locale id. </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns current locale id (lcid).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#locale=-class_method" title="locale= (class method)">.<strong>locale=</strong>(lcid)  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets current locale id (lcid).</p></div>
    </div>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#connect-class_method" title="connect (class method)">.<strong>connect</strong>(ole)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns running OLE Automation object or <code>WIN32OLE</code> object from
moniker.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#const_load-class_method" title="const_load (class method)">.<strong>const_load</strong>(ole, mod = WIN32OLE)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Defines the constants of OLE Automation server as mod&#39;s constants.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_guid-class_method" title="create_guid (class method)">.<strong>create_guid</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates GUID.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(server, [host])  &#x21d2; WIN32OLE </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a new <code>WIN32OLE</code> object(OLE Automation object).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_free-class_method" title="ole_free (class method)">.<strong>ole_free</strong>(aWIN32OLE)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Invokes Release method of Dispatch interface of <code>WIN32OLE</code>
object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_reference_count-class_method" title="ole_reference_count (class method)">.<strong>ole_reference_count</strong>(aWIN32OLE)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns reference counter of Dispatch interface of <code>WIN32OLE</code>
object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_show_help-class_method" title="ole_show_help (class method)">.<strong>ole_show_help</strong>(obj[,helpcontext])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Displays helpfile.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#ole_initialize-class_method" title=".ole_initialize (class method)">.<strong>ole_initialize</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#ole_uninitialize-class_method" title=".ole_uninitialize (class method)">.<strong>ole_uninitialize</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(a1, a2, ...)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the value of Collection specified by a1, a2,....</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#[]=-instance_method" title="#[]= (instance method)">#<strong>[]=</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the value to <code>WIN32OLE</code> object specified by a1, a2, ...</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#_getproperty-instance_method" title="#_getproperty (instance method)">#<strong>_getproperty</strong>(dispid, args, types)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs the early binding method to get property.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#_invoke-instance_method" title="#_invoke (instance method)">#<strong>_invoke</strong>(dispid, args, types)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs the early binding method.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#_setproperty-instance_method" title="#_setproperty (instance method)">#<strong>_setproperty</strong>(dispid, args, types)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs the early binding method to set property.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong> {|i| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Iterates over each item of OLE collection which has IEnumVARIANT interface.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#invoke-instance_method" title="#invoke (instance method)">#<strong>invoke</strong>(method, [arg1,...])  &#x21d2; return value of method. </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Runs OLE method.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#method_missing-instance_method" title="#method_missing (instance method)">#<strong>method_missing</strong>(id[,arg1, arg2, ...])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Calls <a href="#invoke-instance_method" title="WIN32OLE#invoke (method)">#invoke</a> method.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_activex_initialize-instance_method" title="#ole_activex_initialize (instance method)">#<strong>ole_activex_initialize</strong>()  &#x21d2; Qnil </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Initialize WIN32OLE object(ActiveX Control) by calling
<code>IPersistMemory::InitNew</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_free-instance_method" title="#ole_free (instance method)">#<strong>ole_free</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>invokes Release method of Dispatch interface of <code>WIN32OLE</code>
object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_func_methods-instance_method" title="#ole_func_methods (instance method)">#<strong>ole_func_methods</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object .</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_get_methods-instance_method" title="#ole_get_methods (instance method)">#<strong>ole_get_methods</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object .</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_method_help-instance_method" title="#ole_method_help (instance method)">#<strong>ole_method_help</strong>(method)  </a>
      (also: #ole_method_help)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns WIN32OLE_METHOD object corresponding with method specified by 1st
argument.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_method_help-instance_method" title="#ole_method_help (instance method)">#<strong>ole_method_help</strong>(method)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#ole_method-instance_method" title="WIN32OLE#ole_method (method)">#ole_method</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_methods-instance_method" title="#ole_methods (instance method)">#<strong>ole_methods</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_obj_help-instance_method" title="#ole_obj_help (instance method)">#<strong>ole_obj_help</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#ole_type-instance_method" title="WIN32OLE#ole_type (method)">#ole_type</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_put_methods-instance_method" title="#ole_put_methods (instance method)">#<strong>ole_put_methods</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object .</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_query_interface-instance_method" title="#ole_query_interface (instance method)">#<strong>ole_query_interface</strong>(iid)  &#x21d2; WIN32OLE </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns WIN32OLE object for a specific dispatch or dual interface specified
by iid.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_respond_to%3F-instance_method" title="#ole_respond_to? (instance method)">#<strong>ole_respond_to?</strong>(method)  &#x21d2; Boolean </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns true when OLE object has OLE method, otherwise returns false.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_obj_help-instance_method" title="#ole_type (instance method)">#<strong>ole_type</strong>  </a>
      (also: #ole_obj_help)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns WIN32OLE_TYPE object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ole_typelib-instance_method" title="#ole_typelib (instance method)">#<strong>ole_typelib</strong>  &#x21d2; WIN32OLE </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the <a href="WIN32OLE_TYPELIB.html" title="WIN32OLE_TYPELIB (class)">::WIN32OLE_TYPELIB</a> object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#setproperty-instance_method" title="#setproperty (instance method)">#<strong>setproperty</strong>(&#39;property&#39;, [arg1, arg2,...])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets property of OLE object.</p></div>
    </div>
  </li>
</ul>
</div>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(server, [host])  &#x21d2; <code>WIN32OLE</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a new <code>WIN32OLE</code> object(OLE Automation object). The
first argument server specifies OLE Automation server. The first argument
should be CLSID or PROGID. If second argument host specified, then returns
OLE Automation object on host.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># =&gt; Excel OLE Automation WIN32OLE object.
</span><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{00024500-0000-0000-C000-000000000046}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># =&gt; Excel OLE Automation WIN32OLE object.</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2454-L2507'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2454
2455
2456
2457
2458
2459
2460
2461
2462
2463
2464
2465
2466
2467
2468
2469
2470
2471
2472
2473
2474
2475
2476
2477
2478
2479
2480
2481
2482
2483
2484
2485
2486
2487
2488
2489
2490
2491
2492
2493
2494
2495
2496
2497
2498
2499
2500
2501
2502
2503
2504
2505
2506
2507</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2454</span></pre>
<pre class='code cpp'>

static VALUE
fole_initialize(int argc, VALUE *argv, VALUE self)
{
    VALUE svr_name;
    VALUE host;
    VALUE others;
    HRESULT hr;
    CLSID   clsid;
    OLECHAR *pBuf;
    IDispatch *pDispatch;
    void *p;
    rb_call_super(0, 0);
    rb_scan_args(argc, argv, &quot;11*&quot;, &amp;svr_name, &amp;host, &amp;others);

    StringValue(svr_name);
    if (rb_safe_level() &gt; 0 &amp;&amp; OBJ_TAINTED(svr_name)) {
        rb_raise(rb_eSecurityError, &quot;insecure object creation - `%s&#39;&quot;,
                 StringValuePtr(svr_name));
    }
    if (!NIL_P(host)) {
        StringValue(host);
        if (rb_safe_level() &gt; 0 &amp;&amp; OBJ_TAINTED(host)) {
            rb_raise(rb_eSecurityError, &quot;insecure object creation - `%s&#39;&quot;,
                     StringValuePtr(host));
        }
        return ole_create_dcom(self, svr_name, host, others);
    }

    /* get CLSID from OLE server name */
    pBuf  = ole_vstr2wc(svr_name);
    hr = CLSIDFromProgID(pBuf, &amp;clsid);
    if(FAILED(hr)) {
        hr = CLSIDFromString(pBuf, &amp;clsid);
    }
    SysFreeString(pBuf);
    if(FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError,
                  &quot;unknown OLE server: `%s&#39;&quot;,
                  StringValuePtr(svr_name));
    }

    /* get IDispatch interface */
    hr = CoCreateInstance(&amp;clsid, NULL, CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER,
                          &amp;IID_IDispatch, &amp;p);
    pDispatch = p;
    if(FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError,
                  &quot;failed to create WIN32OLE object from `%s&#39;&quot;,
                  StringValuePtr(svr_name));
    }

    ole_set_member(self, pDispatch);
    return self;
}
</pre>
  </div>
</div>
</section>

<h2 id='method_missing_details' class='y_details'>Dynamic Method Handling</h2>
  <p class='notice this'>
    This class handles dynamic methods through the <tt>method_missing</tt> method
</p>
<section class='method_details first' id="method_missing-instance_method">
  <h3 class='signature  first'>
    #<strong>method_missing</strong>(id[,arg1, arg2, ...])    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Calls <a href="#invoke-instance_method" title="WIN32OLE#invoke (method)">#invoke</a> method.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3307-L3332'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3307
3308
3309
3310
3311
3312
3313
3314
3315
3316
3317
3318
3319
3320
3321
3322
3323
3324
3325
3326
3327
3328
3329
3330
3331
3332</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3307</span></pre>
<pre class='code cpp'>

static VALUE
fole_missing(int argc, VALUE *argv, VALUE self)
{
    VALUE mid, sym;
    const char* mname;
    long n;
    rb_check_arity(argc, 1, UNLIMITED_ARGUMENTS);
    mid = argv[0];
    sym = rb_check_symbol(&amp;mid);
    if (!NIL_P(sym)) mid = rb_sym2str(sym);
    mname = StringValueCStr(mid);
    if(!mname) {
        rb_raise(rb_eRuntimeError, &quot;fail: unknown method or property&quot;);
    }
    n = RSTRING_LEN(mid);
    if(mname[n-1] == &#39;=&#39;) {
        rb_check_arity(argc, 2, 2);
        argv[0] = rb_enc_associate(rb_str_subseq(mid, 0, n-1), cWIN32OLE_enc);

        return ole_propertyput(self, argv[0], argv[1]);
    }
    else {
        argv[0] = rb_enc_associate(rb_str_dup(mid), cWIN32OLE_enc);
        return ole_invoke(argc, argv, self, DISPATCH_METHOD|DISPATCH_PROPERTYGET, FALSE);
    }
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="codepage-class_method">
  <h3 class='signature rw first'>
    .<strong>codepage</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns current codepage.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_codepage'>codepage</span> <span class='comment'># =&gt; WIN32OLE::CP_ACP</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2236-L2240'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2236
2237
2238
2239
2240</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2236</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_get_code_page(VALUE self)
{
    return RB_INT2FIX(cWIN32OLE_cp);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="codepage=-class_method">
  <h3 class='signature rw'>
    .<strong>codepage=</strong>(CP)   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets current codepage. The <a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> is initialized according to
<code>Encoding.default_internal</code>. If <code>Encoding.default_internal</code> is nil then
<a href="#codepage-class_method" title="WIN32OLE.codepage (method)">.codepage</a> is initialized according to
<code>Encoding.default_external</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_codepage'><a href="#codepage-class_method" title="WIN32OLE.codepage (method)">codepage</a></span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='op'>::</span><span class='const'><a href="#CP_UTF8-constant" title="WIN32OLE::CP_UTF8 (constant)">CP_UTF8</a></span>
<span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_codepage'><a href="#codepage-class_method" title="WIN32OLE.codepage (method)">codepage</a></span> <span class='op'>=</span> <span class='int'>65001</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2273-L2282'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2273
2274
2275
2276
2277
2278
2279
2280
2281
2282</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2273</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_set_code_page(VALUE self, VALUE vcp)
{
    UINT cp = RB_FIX2INT(vcp);
    set_ole_codepage(cp);
    /*
     * Should this method return old codepage?
     */
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="locale-class_method">
  <h3 class='signature rw'>
    .<strong>locale</strong>  &#x21d2; <a href="#locale-class_method" title="WIN32OLE.locale (method)">locale</a> <code>id</code>.  <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns current locale id (lcid). The default locale is
<a href="#LOCALE_SYSTEM_DEFAULT-constant" title="WIN32OLE::LOCALE_SYSTEM_DEFAULT (constant)">LOCALE_SYSTEM_DEFAULT</a>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_lcid'>lcid</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_locale'>locale</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2293-L2297'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2293
2294
2295
2296
2297</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2293</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_get_locale(VALUE self)
{
    return RB_INT2FIX(cWIN32OLE_lcid);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="locale=-class_method">
  <h3 class='signature rw'>
    .<strong>locale=</strong>(lcid)   <span class="extras">(<span class='rw'>rw</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets current locale id (lcid).</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_locale'><a href="#locale-class_method" title="WIN32OLE.locale (method)">locale</a></span> <span class='op'>=</span> <span class='int'>1033</span> <span class='comment'># set locale English(U.S)
</span><span class='id identifier rubyid_obj'>obj</span> <span class='op'>=</span> <span class='const'><a href="WIN32OLE_VARIANT.html" title="WIN32OLE_VARIANT (class)">WIN32OLE_VARIANT</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="WIN32OLE_VARIANT.html#new-class_method" title="WIN32OLE_VARIANT.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$100,000</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>WIN32OLE</span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html" title="WIN32OLE::VARIANT (module)">VARIANT</a></span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html#VT_CY-constant" title="WIN32OLE::VARIANT::VT_CY (constant)">VT_CY</a></span><span class='rparen'>)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2328-L2345'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2328
2329
2330
2331
2332
2333
2334
2335
2336
2337
2338
2339
2340
2341
2342
2343
2344
2345</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2328</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_set_locale(VALUE self, VALUE vlcid)
{
    LCID lcid = RB_FIX2INT(vlcid);
    if (lcid_installed(lcid)) {
        cWIN32OLE_lcid = lcid;
    } else {
        switch (lcid) {
        case LOCALE_SYSTEM_DEFAULT:
        case LOCALE_USER_DEFAULT:
            cWIN32OLE_lcid = lcid;
            break;
        default:
            rb_raise(eWIN32OLERuntimeError, &quot;not installed locale: %u&quot;, (unsigned int)lcid);
        }
    }
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="connect-class_method">
  <h3 class='signature  first'>
    .<strong>connect</strong>(ole)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns running OLE Automation object or <code>WIN32OLE</code> object from
moniker. 1st argument should be OLE program id or class id or moniker.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># =&gt; WIN32OLE object which represents running Excel.</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L1969-L2019'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 1969</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_connect(int argc, VALUE *argv, VALUE self)
{
    VALUE svr_name;
    VALUE others;
    HRESULT hr;
    CLSID   clsid;
    OLECHAR *pBuf;
    IDispatch *pDispatch;
    void *p;
    IUnknown *pUnknown;

    /* initialize to use OLE */
    ole_initialize();

    rb_scan_args(argc, argv, &quot;1*&quot;, &amp;svr_name, &amp;others);
    StringValue(svr_name);
    if (rb_safe_level() &gt; 0 &amp;&amp; OBJ_TAINTED(svr_name)) {
        rb_raise(rb_eSecurityError, &quot;insecure connection - `%s&#39;&quot;,
		StringValuePtr(svr_name));
    }

    /* get CLSID from OLE server name */
    pBuf = ole_vstr2wc(svr_name);
    hr = CLSIDFromProgID(pBuf, &amp;clsid);
    if(FAILED(hr)) {
        hr = CLSIDFromString(pBuf, &amp;clsid);
    }
    SysFreeString(pBuf);
    if(FAILED(hr)) {
        return ole_bind_obj(svr_name, argc, argv, self);
    }

    hr = GetActiveObject(&amp;clsid, 0, &amp;pUnknown);
    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError,
                  &quot;OLE server `%s&#39; not running&quot;, StringValuePtr(svr_name));
    }
    hr = pUnknown-&gt;lpVtbl-&gt;QueryInterface(pUnknown, &amp;IID_IDispatch, &amp;p);
    pDispatch = p;
    if(FAILED(hr)) {
        OLE_RELEASE(pUnknown);
        ole_raise(hr, eWIN32OLERuntimeError,
                  &quot;failed to create WIN32OLE server `%s&#39;&quot;,
                  StringValuePtr(svr_name));
    }

    OLE_RELEASE(pUnknown);

    return create_win32ole_object(self, pDispatch, argc, argv);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="const_load-class_method">
  <h3 class='signature '>
    .<strong>const_load</strong>(ole, mod = WIN32OLE)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Defines the constants of OLE Automation server as mod&#39;s constants. The
first argument is <code>WIN32OLE</code> object or type library name. If 2nd
argument is omitted, the default is <code>WIN32OLE</code>. The first letter
of Ruby&#39;s constant variable name is upper case, so constant variable
name of <code>WIN32OLE</code> object is capitalized. For example, the
&#39;xlTop&#39; constant of Excel is changed to &#39;XlTop&#39; in
<code>WIN32OLE</code>. If the first letter of constant variable is not
[A-Z], then the constant is defined as CONSTANTS hash element.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>EXCEL_CONST</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_const_load'>const_load</span><span class='lparen'>(</span><span class='id identifier rubyid_excel'>excel</span><span class='comma'>,</span> <span class='const'>EXCEL_CONST</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='const'>EXCEL_CONST</span><span class='op'>::</span><span class='const'>XlTop</span> <span class='comment'># =&gt; -4160
</span><span class='id identifier rubyid_puts'>puts</span> <span class='const'>EXCEL_CONST</span><span class='op'>::</span><span class='const'>CONSTANTS</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_xlDialogChartSourceData</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='comment'># =&gt; 541
</span>
<span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_const_load'>const_load</span><span class='lparen'>(</span><span class='id identifier rubyid_excel'>excel</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='const'>WIN32OLE</span><span class='op'>::</span><span class='const'>XlTop</span> <span class='comment'># =&gt; -4160
</span>
<span class='kw'>module</span> <span class='const'>MSO</span>
<span class='kw'>end</span>
<span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_const_load'>const_load</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Microsoft Office 9.0 Object Library</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>MSO</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='const'>MSO</span><span class='op'>::</span><span class='const'>MsoLineSingle</span> <span class='comment'># =&gt; 1</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2050-L2113'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2050
2051
2052
2053
2054
2055
2056
2057
2058
2059
2060
2061
2062
2063
2064
2065
2066
2067
2068
2069
2070
2071
2072
2073
2074
2075
2076
2077
2078
2079
2080
2081
2082
2083
2084
2085
2086
2087
2088
2089
2090
2091
2092
2093
2094
2095
2096
2097
2098
2099
2100
2101
2102
2103
2104
2105
2106
2107
2108
2109
2110
2111
2112
2113</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2050</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_const_load(int argc, VALUE *argv, VALUE self)
{
    VALUE ole;
    VALUE klass;
    struct oledata *pole = NULL;
    ITypeInfo *pTypeInfo;
    ITypeLib *pTypeLib;
    unsigned int index;
    HRESULT hr;
    OLECHAR *pBuf;
    VALUE file;
    LCID    lcid = cWIN32OLE_lcid;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;ole, &amp;klass);
    if (!RB_TYPE_P(klass, T_CLASS) &amp;&amp;
        !RB_TYPE_P(klass, T_MODULE) &amp;&amp;
        !RB_TYPE_P(klass, T_NIL)) {
        rb_raise(rb_eTypeError, &quot;2nd parameter must be Class or Module&quot;);
    }
    if (rb_obj_is_kind_of(ole, cWIN32OLE)) {
        pole = oledata_get_struct(ole);
        hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;GetTypeInfo(pole-&gt;pDispatch,
                                                  0, lcid, &amp;pTypeInfo);
        if(FAILED(hr)) {
            ole_raise(hr, rb_eRuntimeError, &quot;failed to GetTypeInfo&quot;);
        }
        hr = pTypeInfo-&gt;lpVtbl-&gt;GetContainingTypeLib(pTypeInfo, &amp;pTypeLib, &amp;index);
        if(FAILED(hr)) {
            OLE_RELEASE(pTypeInfo);
            ole_raise(hr, rb_eRuntimeError, &quot;failed to GetContainingTypeLib&quot;);
        }
        OLE_RELEASE(pTypeInfo);
        if(!RB_TYPE_P(klass, T_NIL)) {
            ole_const_load(pTypeLib, klass, self);
        }
        else {
            ole_const_load(pTypeLib, cWIN32OLE, self);
        }
        OLE_RELEASE(pTypeLib);
    }
    else if(RB_TYPE_P(ole, T_STRING)) {
        file = typelib_file(ole);
        if (file == Qnil) {
            file = ole;
        }
        pBuf = ole_vstr2wc(file);
        hr = LoadTypeLibEx(pBuf, REGKIND_NONE, &amp;pTypeLib);
        SysFreeString(pBuf);
        if (FAILED(hr))
          ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to LoadTypeLibEx&quot;);
        if(!RB_TYPE_P(klass, T_NIL)) {
            ole_const_load(pTypeLib, klass, self);
        }
        else {
            ole_const_load(pTypeLib, cWIN32OLE, self);
        }
        OLE_RELEASE(pTypeLib);
    }
    else {
        rb_raise(rb_eTypeError, &quot;1st parameter must be WIN32OLE instance&quot;);
    }
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_guid-class_method">
  <h3 class='signature '>
    .<strong>create_guid</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates GUID.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_create_guid'>create_guid</span> <span class='comment'># =&gt; {1CB530F1-F6B1-404D-BCE6-1959BF91F4A8}</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2354-L2370'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2354
2355
2356
2357
2358
2359
2360
2361
2362
2363
2364
2365
2366
2367
2368
2369
2370</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2354</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_create_guid(VALUE self)
{
    GUID guid;
    HRESULT hr;
    OLECHAR bstr[80];
    int len = 0;
    hr = CoCreateGuid(&amp;guid);
    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to create GUID&quot;);
    }
    len = StringFromGUID2(&amp;guid, bstr, sizeof(bstr)/sizeof(OLECHAR));
    if (len == 0) {
        rb_raise(rb_eRuntimeError, &quot;failed to create GUID(buffer over)&quot;);
    }
    return ole_wc2vstr(bstr, FALSE);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_free-class_method">
  <h3 class='signature '>
    .<strong>ole_free</strong>(aWIN32OLE)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Invokes Release method of Dispatch interface of <code>WIN32OLE</code>
object. You should not use this method because this method exists only for
debugging <code>WIN32OLE</code>. The return value is reference counter of
OLE object.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2151-L2163'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2151
2152
2153
2154
2155
2156
2157
2158
2159
2160
2161
2162
2163</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2151</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_free(VALUE self, VALUE obj)
{
    ULONG n = 0;
    struct oledata * pole = NULL;
    pole = oledata_get_struct(obj);
    if(pole-&gt;pDispatch) {
        if (reference_count(pole) &gt; 0) {
            n = OLE_RELEASE(pole-&gt;pDispatch);
        }
    }
    return RB_INT2NUM(n);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_initialize-class_method">
  <h3 class='signature nodoc'>
    .<strong>ole_initialize</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2379-L2384'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2379
2380
2381
2382
2383
2384</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2379</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_ole_initialize(VALUE self)
{
    ole_initialize();
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_reference_count-class_method">
  <h3 class='signature '>
    .<strong>ole_reference_count</strong>(aWIN32OLE)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns reference counter of Dispatch interface of <code>WIN32OLE</code>
object. You should not use this method because this method exists only for
debugging <code>WIN32OLE</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2134-L2140'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2134
2135
2136
2137
2138
2139
2140</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2134</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_reference_count(VALUE self, VALUE obj)
{
    struct oledata * pole = NULL;
    pole = oledata_get_struct(obj);
    return RB_INT2NUM(reference_count(pole));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_show_help-class_method">
  <h3 class='signature '>
    .<strong>ole_show_help</strong>(obj[,helpcontext])    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Displays helpfile. The 1st argument specifies <a href="WIN32OLE_TYPE.html" title="WIN32OLE_TYPE (class)">::WIN32OLE_TYPE</a> object or
<a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object or helpfile.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_typeobj'>typeobj</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_type'>ole_type</span>
<span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_ole_show_help'>ole_show_help</span><span class='lparen'>(</span><span class='id identifier rubyid_typeobj'>typeobj</span><span class='rparen'>)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2197-L2227'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2197
2198
2199
2200
2201
2202
2203
2204
2205
2206
2207
2208
2209
2210
2211
2212
2213
2214
2215
2216
2217
2218
2219
2220
2221
2222
2223
2224
2225
2226
2227</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2197</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_show_help(int argc, VALUE *argv, VALUE self)
{
    VALUE target;
    VALUE helpcontext;
    VALUE helpfile;
    VALUE name;
    HWND  hwnd;
    rb_scan_args(argc, argv, &quot;11&quot;, &amp;target, &amp;helpcontext);
    if (rb_obj_is_kind_of(target, cWIN32OLE_TYPE) ||
        rb_obj_is_kind_of(target, cWIN32OLE_METHOD)) {
        helpfile = rb_funcall(target, rb_intern(&quot;helpfile&quot;), 0);
        if(strlen(StringValuePtr(helpfile)) == 0) {
            name = rb_ivar_get(target, rb_intern(&quot;name&quot;));
            rb_raise(rb_eRuntimeError, &quot;no helpfile of `%s&#39;&quot;,
                     StringValuePtr(name));
        }
        helpcontext = rb_funcall(target, rb_intern(&quot;helpcontext&quot;), 0);
    } else {
        helpfile = target;
    }
    if (!RB_TYPE_P(helpfile, T_STRING)) {
        rb_raise(rb_eTypeError, &quot;1st parameter must be (String|WIN32OLE_TYPE|WIN32OLE_METHOD)&quot;);
    }
    hwnd = ole_show_help(helpfile, helpcontext);
    if(hwnd == 0) {
        rb_raise(rb_eRuntimeError, &quot;failed to open help file `%s&#39;&quot;,
                 StringValuePtr(helpfile));
    }
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_uninitialize-class_method">
  <h3 class='signature nodoc'>
    .<strong>ole_uninitialize</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2387-L2392'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2387
2388
2389
2390
2391
2392</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2387</span></pre>
<pre class='code cpp'>

static VALUE
fole_s_ole_uninitialize(VALUE self)
{
    ole_uninitialize();
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="[]-instance_method">
  <h3 class='signature  first'>
    #<strong>[]</strong>(a1, a2, ...)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the value of Collection specified by a1, a2,....</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_dict'>dict</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Scripting.Dictionary</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_dict'>dict</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Ruby</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_dict'>dict</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='comment'># =&gt; &#39;Ruby&#39; (same as `puts dict.item(&#39;ruby&#39;)&#39;)</span></code></pre>

<p>Remark: You can not use this method to get the property.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># puts excel[&#39;Visible&#39;]  This is error !!!
</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='const'>Visible</span> <span class='comment'># You should to use this style to get the property.</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3124-L3128'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3124
3125
3126
3127
3128</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3124</span></pre>
<pre class='code cpp'>

static VALUE
fole_getproperty_with_bracket(int argc, VALUE *argv, VALUE self)
{
    return ole_invoke(argc, argv, self, DISPATCH_PROPERTYGET, TRUE);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="[]=-instance_method">
  <h3 class='signature '>
    #<strong>[]=</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the value to <code>WIN32OLE</code> object specified by a1, a2, ...</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_dict'>dict</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Scripting.Dictionary</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_dict'>dict</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RUBY</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_dict'>dict</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Ruby</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_dict'>dict</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='comment'># =&gt; &#39;Ruby&#39;</span></code></pre>

<p>Remark: You can not use this method to set the property value.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># excel[&#39;Visible&#39;] = true # This is error !!!
</span><span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='const'>Visible</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='comment'># You should to use this style to set the property.</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3083-L3087'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3083
3084
3085
3086
3087</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3083</span></pre>
<pre class='code cpp'>

static VALUE
fole_setproperty_with_bracket(int argc, VALUE *argv, VALUE self)
{
    return ole_invoke(argc, argv, self, DISPATCH_PROPERTYPUT, TRUE);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_getproperty-instance_method">
  <h3 class='signature '>
    #<strong>_getproperty</strong>(dispid, args, types)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Runs the early binding method to get property. The 1st argument specifies
dispatch ID, the 2nd argument specifies the array of arguments, the 3rd
argument specifies the array of the type of arguments.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid__getproperty'>_getproperty</span><span class='lparen'>(</span><span class='int'>558</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'># same effect as puts excel.visible</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3041-L3045'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3041
3042
3043
3044
3045</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3041</span></pre>
<pre class='code cpp'>

static VALUE
fole_getproperty2(VALUE self, VALUE dispid, VALUE args, VALUE types)
{
    return ole_invoke2(self, dispid, args, types, DISPATCH_PROPERTYGET);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_invoke-instance_method">
  <h3 class='signature '>
    #<strong>_invoke</strong>(dispid, args, types)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Runs the early binding method. The 1st argument specifies dispatch ID, the
2nd argument specifies the array of arguments, the 3rd argument specifies
the array of the type of arguments.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid__invoke'>_invoke</span><span class='lparen'>(</span><span class='int'>302</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'>#  same effect as excel.Quit</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3023-L3027'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3023
3024
3025
3026
3027</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3023</span></pre>
<pre class='code cpp'>

static VALUE
fole_invoke2(VALUE self, VALUE dispid, VALUE args, VALUE types)
{
    return ole_invoke2(self, dispid, args, types, DISPATCH_METHOD);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="_setproperty-instance_method">
  <h3 class='signature '>
    #<strong>_setproperty</strong>(dispid, args, types)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Runs the early binding method to set property. The 1st argument specifies
dispatch ID, the 2nd argument specifies the array of arguments, the 3rd
argument specifies the array of the type of arguments.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid__setproperty'>_setproperty</span><span class='lparen'>(</span><span class='int'>558</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>true</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='const'>WIN32OLE</span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html" title="WIN32OLE::VARIANT (module)">VARIANT</a></span><span class='op'>::</span><span class='const'><a href="WIN32OLE/VARIANT.html#VT_BOOL-constant" title="WIN32OLE::VARIANT::VT_BOOL (constant)">VT_BOOL</a></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'># same effect as excel.visible = true</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3059-L3063'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3059
3060
3061
3062
3063</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3059</span></pre>
<pre class='code cpp'>

static VALUE
fole_setproperty2(VALUE self, VALUE dispid, VALUE args, VALUE types)
{
    return ole_invoke2(self, dispid, args, types, DISPATCH_PROPERTYPUT);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="each-instance_method">
  <h3 class='signature '>
    #<strong>each</strong> {|i| ... }   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Iterates over each item of OLE collection which has IEnumVARIANT interface.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_book'>book</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_workbooks'>workbooks</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span>
<span class='id identifier rubyid_sheets'>sheets</span> <span class='op'>=</span> <span class='id identifier rubyid_book'>book</span><span class='period'>.</span><span class='id identifier rubyid_worksheets'>worksheets</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_cells'>cells</span> <span class='op'>=</span> <span class='id identifier rubyid_sheets'>sheets</span><span class='period'>.</span><span class='id identifier rubyid_cells'>cells</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A1:A5</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_cells'>cells</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cell'>cell</span><span class='op'>|</span>
  <span class='id identifier rubyid_cell'>cell</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='int'>10</span>
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3244-L3299'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3244
3245
3246
3247
3248
3249
3250
3251
3252
3253
3254
3255
3256
3257
3258
3259
3260
3261
3262
3263
3264
3265
3266
3267
3268
3269
3270
3271
3272
3273
3274
3275
3276
3277
3278
3279
3280
3281
3282
3283
3284
3285
3286
3287
3288
3289
3290
3291
3292
3293
3294
3295
3296
3297
3298
3299</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3244</span></pre>
<pre class='code cpp'>

static VALUE
fole_each(VALUE self)
{
    LCID    lcid = cWIN32OLE_lcid;

    struct oledata *pole = NULL;

    unsigned int argErr;
    EXCEPINFO excepinfo;
    DISPPARAMS dispParams;
    VARIANT result;
    HRESULT hr;
    IEnumVARIANT *pEnum = NULL;
    void *p;

    RETURN_ENUMERATOR(self, 0, 0);

    VariantInit(&amp;result);
    dispParams.rgvarg = NULL;
    dispParams.rgdispidNamedArgs = NULL;
    dispParams.cNamedArgs = 0;
    dispParams.cArgs = 0;
    memset(&amp;excepinfo, 0, sizeof(excepinfo));

    pole = oledata_get_struct(self);
    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;Invoke(pole-&gt;pDispatch, DISPID_NEWENUM,
                                         &amp;IID_NULL, lcid,
                                         DISPATCH_METHOD | DISPATCH_PROPERTYGET,
                                         &amp;dispParams, &amp;result,
                                         &amp;excepinfo, &amp;argErr);

    if (FAILED(hr)) {
        VariantClear(&amp;result);
        ole_raise(hr, eWIN32OLERuntimeError, &quot;failed to get IEnum Interface&quot;);
    }

    if (V_VT(&amp;result) == VT_UNKNOWN) {
        hr = V_UNKNOWN(&amp;result)-&gt;lpVtbl-&gt;QueryInterface(V_UNKNOWN(&amp;result),
                                                        &amp;IID_IEnumVARIANT,
                                                        &amp;p);
        pEnum = p;
    } else if (V_VT(&amp;result) == VT_DISPATCH) {
        hr = V_DISPATCH(&amp;result)-&gt;lpVtbl-&gt;QueryInterface(V_DISPATCH(&amp;result),
                                                         &amp;IID_IEnumVARIANT,
                                                         &amp;p);
        pEnum = p;
    }
    if (FAILED(hr) || !pEnum) {
        VariantClear(&amp;result);
        ole_raise(hr, rb_eRuntimeError, &quot;failed to get IEnum Interface&quot;);
    }

    VariantClear(&amp;result);
    rb_ensure(ole_each_sub, (VALUE)pEnum, ole_ienum_free, (VALUE)pEnum);
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="invoke-instance_method">
  <h3 class='signature '>
    #<strong>invoke</strong>(method, [arg1,...])  &#x21d2; <code>return</code> <code>value</code> <code>of</code> <code>method</code>.   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Runs OLE method. The first argument specifies the method name of OLE
Automation object. The others specify argument of the <em>method</em>. If
you can not execute <em>method</em> directly, then use this method instead.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Quit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>  <span class='comment'># =&gt; same as excel.Quit</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L2815-L2819'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


2815
2816
2817
2818
2819</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 2815</span></pre>
<pre class='code cpp'>

static VALUE
fole_invoke(int argc, VALUE *argv, VALUE self)
{
    return ole_invoke(argc, argv, self, DISPATCH_METHOD|DISPATCH_PROPERTYGET, FALSE);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_activex_initialize-instance_method">
  <h3 class='signature '>
    #<strong>ole_activex_initialize</strong>()  &#x21d2; <code>Qnil</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Initialize WIN32OLE object(ActiveX Control) by calling
<code>IPersistMemory::InitNew</code>.</p>

<p>Before calling OLE method, some kind of the ActiveX controls created with
MFC should be initialized by calling <code>IPersistXXX::InitNew</code>.</p>

<p>If and only if you received the exception "HRESULT error code: 0x8000ffff
catastrophic failure", try this method before invoking any ole_method.</p>

<pre class="code ruby"><code class="ruby">obj = WIN32OLE.new(&quot;ProgID_or_GUID_of_ActiveX_Control&quot;)
obj.ole_activex_initialize
obj.method(...)</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3835-L3861'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3835
3836
3837
3838
3839
3840
3841
3842
3843
3844
3845
3846
3847
3848
3849
3850
3851
3852
3853
3854
3855
3856
3857
3858
3859
3860
3861</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3835</span></pre>
<pre class='code cpp'>

static VALUE
fole_activex_initialize(VALUE self)
{
    struct oledata *pole = NULL;
    IPersistMemory *pPersistMemory;
    void *p;

    HRESULT hr = S_OK;

    pole = oledata_get_struct(self);

    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;QueryInterface(pole-&gt;pDispatch, &amp;IID_IPersistMemory, &amp;p);
    pPersistMemory = p;
    if (SUCCEEDED(hr)) {
        hr = pPersistMemory-&gt;lpVtbl-&gt;InitNew(pPersistMemory);
        OLE_RELEASE(pPersistMemory);
        if (SUCCEEDED(hr)) {
            return Qnil;
        }
    }

    if (FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError, &quot;fail to initialize ActiveX control&quot;);
    }

    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_free-instance_method">
  <h3 class='signature '>
    #<strong>ole_free</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>invokes Release method of Dispatch interface of <code>WIN32OLE</code>
object. Usually, you do not need to call this method because Release method
called automatically when <code>WIN32OLE</code> object garbaged.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3196-L3204'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3196
3197
3198
3199
3200
3201
3202
3203
3204</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3196</span></pre>
<pre class='code cpp'>

static VALUE
fole_free(VALUE self)
{
    struct oledata *pole = NULL;
    pole = oledata_get_struct(self);
    OLE_FREE(pole-&gt;pDispatch);
    pole-&gt;pDispatch = NULL;
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_func_methods-instance_method">
  <h3 class='signature '>
    #<strong>ole_func_methods</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object . The element of the array is
property (settable) of <code>WIN32OLE</code> object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_properties'>properties</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_func_methods'>ole_func_methods</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3454-L3458'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3454
3455
3456
3457
3458</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3454</span></pre>
<pre class='code cpp'>

static VALUE
fole_func_methods(VALUE self)
{
    return ole_methods( self, INVOKE_FUNC);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_get_methods-instance_method">
  <h3 class='signature '>
    #<strong>ole_get_methods</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object . The element of the array is
property (gettable) of <code>WIN32OLE</code> object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_properties'>properties</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_get_methods'>ole_get_methods</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3421-L3425'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3421
3422
3423
3424
3425</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3421</span></pre>
<pre class='code cpp'>

static VALUE
fole_get_methods(VALUE self)
{
    return ole_methods( self, INVOKE_PROPERTYGET);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_method-instance_method">
  <h3 class='signature '>
    #<strong>ole_method_help</strong>(method)      <span class='aliases'>Also known as: <span class='names'>#ole_method_help</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns WIN32OLE_METHOD object corresponding with method specified by 1st
argument.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_method'>method</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_method_help'>ole_method_help</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Quit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3792-L3813'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3792
3793
3794
3795
3796
3797
3798
3799
3800
3801
3802
3803
3804
3805
3806
3807
3808
3809
3810
3811
3812
3813</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3792</span></pre>
<pre class='code cpp'>

static VALUE
fole_method_help(VALUE self, VALUE cmdname)
{
    ITypeInfo *pTypeInfo;
    HRESULT hr;
    struct oledata *pole = NULL;
    VALUE obj;

    SafeStringValue(cmdname);
    pole = oledata_get_struct(self);
    hr = typeinfo_from_ole(pole, &amp;pTypeInfo);
    if(FAILED(hr))
        ole_raise(hr, rb_eRuntimeError, &quot;failed to get ITypeInfo&quot;);

    obj = create_win32ole_method(pTypeInfo, cmdname);

    OLE_RELEASE(pTypeInfo);
    if (obj == Qnil)
        rb_raise(eWIN32OLERuntimeError, &quot;not found %s&quot;,
                 StringValuePtr(cmdname));
    return obj;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_method_help-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>ole_method_help</strong>(method)  </span>
      <span class='overload'>#<strong>ole_method_help</strong>(method)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#ole_method-instance_method" title="WIN32OLE#ole_method (method)">#ole_method</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="ole_methods-instance_method">
  <h3 class='signature '>
    #<strong>ole_methods</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object. The element is OLE method of
<code>WIN32OLE</code> object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_methods'>methods</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_methods'>ole_methods</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3405-L3409'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3405
3406
3407
3408
3409</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3405</span></pre>
<pre class='code cpp'>

static VALUE
fole_methods(VALUE self)
{
    return ole_methods( self, INVOKE_FUNC | INVOKE_PROPERTYGET | INVOKE_PROPERTYPUT | INVOKE_PROPERTYPUTREF);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_obj_help-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>ole_type</strong>  </span>
      <span class='overload'>#<strong>ole_obj_help</strong>  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#ole_type-instance_method" title="WIN32OLE#ole_type (method)">#ole_type</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="ole_put_methods-instance_method">
  <h3 class='signature '>
    #<strong>ole_put_methods</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the array of <a href="WIN32OLE_METHOD.html" title="WIN32OLE_METHOD (class)">::WIN32OLE_METHOD</a> object . The element of the array is
property (settable) of <code>WIN32OLE</code> object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_properties'>properties</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_put_methods'>ole_put_methods</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3437-L3441'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3437
3438
3439
3440
3441</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3437</span></pre>
<pre class='code cpp'>

static VALUE
fole_put_methods(VALUE self)
{
    return ole_methods( self, INVOKE_PROPERTYPUT|INVOKE_PROPERTYPUTREF);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_query_interface-instance_method">
  <h3 class='signature '>
    #<strong>ole_query_interface</strong>(iid)  &#x21d2; <code>WIN32OLE</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns WIN32OLE object for a specific dispatch or dual interface specified
by iid.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ie'>ie</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>InternetExplorer.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_ie_web_app'>ie_web_app</span> <span class='op'>=</span> <span class='id identifier rubyid_ie'>ie</span><span class='period'>.</span><span class='id identifier rubyid_ole_query_interface'>ole_query_interface</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{0002DF05-0000-0000-C000-000000000046}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># =&gt; WIN32OLE object for dispinterface IWebBrowserApp</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3536-L3570'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3536
3537
3538
3539
3540
3541
3542
3543
3544
3545
3546
3547
3548
3549
3550
3551
3552
3553
3554
3555
3556
3557
3558
3559
3560
3561
3562
3563
3564
3565
3566
3567
3568
3569
3570</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3536</span></pre>
<pre class='code cpp'>

static VALUE
fole_query_interface(VALUE self, VALUE str_iid)
{
    HRESULT hr;
    OLECHAR *pBuf;
    IID iid;
    struct oledata *pole = NULL;
    IDispatch *pDispatch;
    void *p;

    pBuf  = ole_vstr2wc(str_iid);
    hr = CLSIDFromString(pBuf, &amp;iid);
    SysFreeString(pBuf);
    if(FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError,
                  &quot;invalid iid: `%s&#39;&quot;,
                  StringValuePtr(str_iid));
    }

    pole = oledata_get_struct(self);
    if(!pole-&gt;pDispatch) {
        rb_raise(rb_eRuntimeError, &quot;failed to get dispatch interface&quot;);
    }

    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;QueryInterface(pole-&gt;pDispatch, &amp;iid,
                                                 &amp;p);
    if(FAILED(hr)) {
        ole_raise(hr, eWIN32OLERuntimeError,
                  &quot;failed to get interface `%s&#39;&quot;,
                  StringValuePtr(str_iid));
    }

    pDispatch = p;
    return create_win32ole_object(cWIN32OLE, pDispatch, 0, 0);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_respond_to?-instance_method">
  <h3 class='signature '>
    #<strong>ole_respond_to?</strong>(method)  &#x21d2; <code>Boolean</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns true when OLE object has OLE method, otherwise returns false.</p>

<pre class="code ruby"><code class="ruby">ie = WIN32OLE.new(&#39;InternetExplorer.Application&#39;)
ie.ole_respond_to?(&quot;gohome&quot;) =&gt; true</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3581-L3600'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3581
3582
3583
3584
3585
3586
3587
3588
3589
3590
3591
3592
3593
3594
3595
3596
3597
3598
3599
3600</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3581</span></pre>
<pre class='code cpp'>

static VALUE
fole_respond_to(VALUE self, VALUE method)
{
    struct oledata *pole = NULL;
    BSTR wcmdname;
    DISPID DispID;
    HRESULT hr;
    if(!RB_TYPE_P(method, T_STRING) &amp;&amp; !RB_TYPE_P(method, T_SYMBOL)) {
        rb_raise(rb_eTypeError, &quot;wrong argument type (expected String or Symbol)&quot;);
    }
    if (RB_TYPE_P(method, T_SYMBOL)) {
        method = rb_sym2str(method);
    }
    pole = oledata_get_struct(self);
    wcmdname = ole_vstr2wc(method);
    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;GetIDsOfNames( pole-&gt;pDispatch, &amp;IID_NULL,
	    &amp;wcmdname, 1, cWIN32OLE_lcid, &amp;DispID);
    SysFreeString(wcmdname);
    return SUCCEEDED(hr) ? Qtrue : Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_type-instance_method">
  <h3 class='signature '>
    #<strong>ole_type</strong>      <span class='aliases'>Also known as: <span class='names'>#ole_obj_help</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns WIN32OLE_TYPE object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tobj'>tobj</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_type'>ole_type</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3469-L3490'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3469
3470
3471
3472
3473
3474
3475
3476
3477
3478
3479
3480
3481
3482
3483
3484
3485
3486
3487
3488
3489
3490</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3469</span></pre>
<pre class='code cpp'>

static VALUE
fole_type(VALUE self)
{
    ITypeInfo *pTypeInfo;
    HRESULT hr;
    struct oledata *pole = NULL;
    LCID  lcid = cWIN32OLE_lcid;
    VALUE type = Qnil;

    pole = oledata_get_struct(self);

    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;GetTypeInfo( pole-&gt;pDispatch, 0, lcid, &amp;pTypeInfo );
    if(FAILED(hr)) {
        ole_raise(hr, rb_eRuntimeError, &quot;failed to GetTypeInfo&quot;);
    }
    type = ole_type_from_itypeinfo(pTypeInfo);
    OLE_RELEASE(pTypeInfo);
    if (type == Qnil) {
        rb_raise(rb_eRuntimeError, &quot;failed to create WIN32OLE_TYPE obj from ITypeInfo&quot;);
    }
    return type;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ole_typelib-instance_method">
  <h3 class='signature '>
    #<strong>ole_typelib</strong>  &#x21d2; <code>WIN32OLE</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the <a href="WIN32OLE_TYPELIB.html" title="WIN32OLE_TYPELIB (class)">::WIN32OLE_TYPELIB</a> object. The object represents the type
library which contains the <code>WIN32OLE</code> object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_tlib'>tlib</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_ole_typelib'>ole_typelib</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_tlib'>tlib</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>  <span class='comment'># -&gt; &#39;Microsoft Excel 9.0 Object Library&#39;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3503-L3524'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3503
3504
3505
3506
3507
3508
3509
3510
3511
3512
3513
3514
3515
3516
3517
3518
3519
3520
3521
3522
3523
3524</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3503</span></pre>
<pre class='code cpp'>

static VALUE
fole_typelib(VALUE self)
{
    struct oledata *pole = NULL;
    HRESULT hr;
    ITypeInfo *pTypeInfo;
    LCID  lcid = cWIN32OLE_lcid;
    VALUE vtlib = Qnil;

    pole = oledata_get_struct(self);
    hr = pole-&gt;pDispatch-&gt;lpVtbl-&gt;GetTypeInfo(pole-&gt;pDispatch,
                                              0, lcid, &amp;pTypeInfo);
    if(FAILED(hr)) {
        ole_raise(hr, rb_eRuntimeError, &quot;failed to GetTypeInfo&quot;);
    }
    vtlib = ole_typelib_from_itypeinfo(pTypeInfo);
    OLE_RELEASE(pTypeInfo);
    if (vtlib == Qnil) {
        rb_raise(rb_eRuntimeError, &quot;failed to get type library info.&quot;);
    }
    return vtlib;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="setproperty-instance_method">
  <h3 class='signature '>
    #<strong>setproperty</strong>(&#39;property&#39;, [arg1, arg2,...])    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets property of OLE object. When you want to set property with argument,
you can use this method.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_excel'>excel</span> <span class='op'>=</span> <span class='const'>WIN32OLE</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="WIN32OLE.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Excel.Application</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='const'>Visible</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='id identifier rubyid_book'>book</span> <span class='op'>=</span> <span class='id identifier rubyid_excel'>excel</span><span class='period'>.</span><span class='id identifier rubyid_workbooks'>workbooks</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span>
<span class='id identifier rubyid_sheet'>sheet</span> <span class='op'>=</span> <span class='id identifier rubyid_book'>book</span><span class='period'>.</span><span class='id identifier rubyid_worksheets'>worksheets</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_sheet'>sheet</span><span class='period'>.</span><span class='id identifier rubyid_setproperty'>setproperty</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cells</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>10</span><span class='rparen'>)</span> <span class='comment'># =&gt; The B1 cell value is 10.</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/win32ole/win32ole.c#L3102-L3106'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


3102
3103
3104
3105
3106</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/win32ole/win32ole.c', line 3102</span></pre>
<pre class='code cpp'>

static VALUE
fole_setproperty(int argc, VALUE *argv, VALUE self)
{
    return ole_invoke(argc, argv, self, DISPATCH_PROPERTYPUT, FALSE);
}
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>