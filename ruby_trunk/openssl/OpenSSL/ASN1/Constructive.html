<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: OpenSSL::ASN1::Constructive &mdash; openssl</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "OpenSSL::ASN1::Constructive",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../../../index.html'>Home</a> &raquo; 
        <a href='../../../index.html'>Ruby-2.5.0</a> &raquo; 
        <a href='../../index.html'>openssl</a> &raquo; 
        <a href='../../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a> &raquo; 
        <a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>Constructive&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: OpenSSL::ASN1::Constructive</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          Enumerable,
          <a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">OpenSSL::ASN1::ASN1Data</a></span>
        <ul class='fullTree'>
          <li><a href="../../Object.html" title="Object (class)">::Object</a></li>
          <li class='next'><a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">OpenSSL::ASN1::ASN1Data</a></li>
          <li class='next'>OpenSSL::ASN1::Constructive</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_asn1.c#L1848'>ext/openssl/ossl_asn1.c</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The parent class for all constructed encodings. The <code>value</code> attribute of a
<code>Constructive</code> is always an <code>Array</code>. Attributes are the same as
for <a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a>, with the addition of <code>tagging</code>.</p>

<h3 id="label-SET+and+SEQUENCE">SET and SEQUENCE</h3>

<p>Most constructed encodings come in the form of a SET or a SEQUENCE. These
encodings are represented by one of the two sub-classes of Constructive:</p>
<ul><li>
<p><code>OpenSSL::ASN1::Set</code></p>
</li><li>
<p><code>OpenSSL::ASN1::Sequence</code></p>
</li></ul>

<p>Please note that tagged sequences and sets are still parsed as instances of
<a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a>. Find further details on tagged values there.</p>

<h4 id="label-Example+-+constructing+a+SEQUENCE">Example - constructing a SEQUENCE</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_int'>int</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>Integer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>PrintableString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_sequence'>sequence</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>Sequence</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_int'>int</span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span> <span class='rbracket'>]</span> <span class='rparen'>)</span></code></pre>

<h4 id="label-Example+-+constructing+a+SET">Example - constructing a SET</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_int'>int</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>Integer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
<span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>PrintableString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abc</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_set'>set</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_int'>int</span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span> <span class='rbracket'>]</span> <span class='rparen'>)</span></code></pre>

<h3 id="label-Infinite+length+primitive+values">Infinite length primitive values</h3>

<p>The only case where <code>Constructive</code> is used directly is for
infinite length encodings of primitive values. These encodings are always
constructed, with the contents of the <code>value</code> <code>Array</code> being either
UNIVERSAL non-infinite length partial encodings of the actual value or
again constructive encodings with infinite length (i.e. infinite length
primitive encodings may be constructed recursively with another infinite
length value within an already infinite length value). Each partial
encoding must be of the same UNIVERSAL type as the overall encoding. The
value of the overall encoding consists of the concatenation of each partial
encoding taken in sequence. The <code>value</code> array of the outer infinite length
value must end with a <code>OpenSSL::ASN1::EndOfContent</code> instance.</p>

<p>Please note that it is not possible to encode <code>Constructive</code>
without the <code>infinite_length</code> attribute being set to <code>true</code>, use
<code>OpenSSL::ASN1::Sequence</code> or <code>OpenSSL::ASN1::Set</code> in these cases instead.</p>

<h4 id="label-Example+-+Infinite+length+OCTET+STRING">Example - Infinite length OCTET STRING</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_partial1'>partial1</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>OctetString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x01</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_partial2'>partial2</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>OctetString</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\x02</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_inf_octets'>inf_octets</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>Constructive</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="OpenSSL::ASN1::Constructive.new (method)">new</a></span><span class='lparen'>(</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_partial1'>partial1</span><span class='comma'>,</span>
                                                <span class='id identifier rubyid_partial2'>partial2</span><span class='comma'>,</span>
                                                <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>EndOfContent</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='rbracket'>]</span><span class='comma'>,</span>
                                              <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='op'>::</span><span class='const'>OCTET_STRING</span><span class='comma'>,</span>
                                              <span class='kw'>nil</span><span class='comma'>,</span>
                                              <span class='symbeg'>:</span><span class='const'>UNIVERSAL</span> <span class='rparen'>)</span>
<span class='comment'># The real value of inf_octets is &quot;\x01\x02&quot;, i.e. the concatenation
</span><span class='comment'># of partial1 and partial2
</span><span class='id identifier rubyid_inf_octets'>inf_octets</span><span class='period'>.</span><span class='id identifier rubyid_infinite_length'>infinite_length</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='id identifier rubyid_der'>der</span> <span class='op'>=</span> <span class='id identifier rubyid_inf_octets'>inf_octets</span><span class='period'>.</span><span class='id identifier rubyid_to_der'>to_der</span>
<span class='id identifier rubyid_asn1'>asn1</span> <span class='op'>=</span> <span class='const'><a href="../../OpenSSL.html" title="OpenSSL (module)">OpenSSL</a></span><span class='op'>::</span><span class='const'><a href="../ASN1.html" title="OpenSSL::ASN1 (module)">ASN1</a></span><span class='period'>.</span><span class='id identifier rubyid_decode'><a href="../ASN1.html#decode-class_method" title="OpenSSL::ASN1.decode (method)">decode</a></span><span class='lparen'>(</span><span class='id identifier rubyid_der'>der</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_asn1'>asn1</span><span class='period'>.</span><span class='id identifier rubyid_infinite_length'>infinite_length</span> <span class='comment'># =&gt; true</span></code></pre>

  </div>
</div>
</div>        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(value[, tag, tagging, tag_class ])  &#x21d2; Primitive </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="Primitive.html#new-class_method" title="OpenSSL::ASN1::Primitive.new (method)">Primitive.new</a>.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="ASN1Data.html#new-class_method" title="OpenSSL::ASN1::ASN1Data.new (method)">.new</a></td>
      <td><div class='inline'><p><code>value</code>: Please have a look at <code>Constructive</code> and
<a href="Primitive.html" title="OpenSSL::ASN1::Primitive (class)">Primitive</a> to see how Ruby types are mapped to ASN.1 types
and vice versa.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong> {|asn1| ... } &#x21d2; 1 </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Calls <em>block</em> once for each element in <code>self</code>, passing that element
as parameter <code>asn1</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_der-instance_method" title="#to_der (instance method)">#<strong>to_der</strong>  &#x21d2; DER-encoded String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>See <a href="ASN1Data.html#to_der-instance_method" title="OpenSSL::ASN1::ASN1Data#to_der (method)">ASN1Data#to_der</a> for details.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a> - Inherited</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="ASN1Data.html#to_der-instance_method" title="OpenSSL::ASN1::ASN1Data#to_der (method)">#to_der</a></td>
      <td><div class='inline'><p>Encodes this <a href="ASN1Data.html" title="OpenSSL::ASN1::ASN1Data (class)">ASN1Data</a> into a DER-encoded String value.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(value[, tag, tagging, tag_class ])  &#x21d2; <a href="Primitive.html" title="OpenSSL::ASN1::Primitive (class)">Primitive</a>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="Primitive.html#new-class_method" title="OpenSSL::ASN1::Primitive.new (method)">Primitive.new</a>.</p>

  </div>
</div>

</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="each-instance_method">
  <h3 class='signature  first'>
    #<strong>each</strong> {|asn1| ... } &#x21d2; <code>1</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Calls <em>block</em> once for each element in <code>self</code>, passing that element
as parameter <code>asn1</code>. If no block is given, an enumerator is returned
instead.</p>

<h3 id="label-Example">Example</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_asn1_ary'>asn1_ary</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_asn1'>asn1</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_asn1'>asn1</span>
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_asn1.c#L1291-L1297'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1291
1292
1293
1294
1295
1296
1297</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_asn1.c', line 1291</span></pre>
<pre class='code cpp'>

static VALUE
ossl_asn1cons_each(VALUE self)
{
    rb_block_call(ossl_asn1_get_value(self), id_each, 0, 0, 0, 0);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_der-instance_method">
  <h3 class='signature '>
    #<strong>to_der</strong>  &#x21d2; <code>DER</code>-<code>encoded</code> <code>String</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>See <a href="ASN1Data.html#to_der-instance_method" title="OpenSSL::ASN1::ASN1Data#to_der (method)">ASN1Data#to_der</a> for details.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/trunk/ext/openssl/ossl_asn1.c#L1195-L1276'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/openssl/ossl_asn1.c', line 1195</span></pre>
<pre class='code cpp'>

static VALUE
ossl_asn1cons_to_der(VALUE self)
{
    int tag, tn, tc, explicit, constructed = 1;
    int found_prim = 0, seq_len;
    long length;
    unsigned char *p;
    VALUE value, str, inf_length;

    tn = NUM2INT(ossl_asn1_get_tag(self));
    tc = ossl_asn1_tag_class(self);
    inf_length = ossl_asn1_get_infinite_length(self);
    if (inf_length == Qtrue) {
	VALUE ary, example;
	constructed = 2;
	if (rb_obj_class(self) == cASN1Sequence ||
	    rb_obj_class(self) == cASN1Set) {
	    tag = ossl_asn1_default_tag(self);
	}
	else { /* must be a constructive encoding of a primitive value */
	    ary = ossl_asn1_get_value(self);
	    if (!rb_obj_is_kind_of(ary, rb_cArray))
		ossl_raise(eASN1Error, &quot;Constructive value must be an Array&quot;);
	    /* Recursively descend until a primitive value is found.
	    The overall value of the entire constructed encoding
	    is of the type of the first primitive encoding to be
	    found. */
	    while (!found_prim){
		example = rb_ary_entry(ary, 0);
		if (rb_obj_is_kind_of(example, cASN1Primitive)){
		    found_prim = 1;
		}
		else {
		    /* example is another ASN1Constructive */
		    if (!rb_obj_is_kind_of(example, cASN1Constructive)){
			ossl_raise(eASN1Error, &quot;invalid constructed encoding&quot;);
			return Qnil; /* dummy */
		    }
		    ary = ossl_asn1_get_value(example);
		}
	    }
	    tag = ossl_asn1_default_tag(example);
	}
    }
    else {
	if (rb_obj_class(self) == cASN1Constructive)
	    ossl_raise(eASN1Error, &quot;Constructive shall only be used with infinite length&quot;);
	tag = ossl_asn1_default_tag(self);
    }
    explicit = ossl_asn1_is_explicit(self);
    value = join_der(ossl_asn1_get_value(self));

    seq_len = ASN1_object_size(constructed, RSTRING_LENINT(value), tag);
    length = ASN1_object_size(constructed, seq_len, tn);
    str = rb_str_new(0, length);
    p = (unsigned char *)RSTRING_PTR(str);
    if(tc == V_ASN1_UNIVERSAL)
	ASN1_put_object(&amp;p, constructed, RSTRING_LENINT(value), tn, tc);
    else{
	if(explicit){
	    ASN1_put_object(&amp;p, constructed, seq_len, tn, tc);
	    ASN1_put_object(&amp;p, constructed, RSTRING_LENINT(value), tag, V_ASN1_UNIVERSAL);
	}
	else{
	    ASN1_put_object(&amp;p, constructed, RSTRING_LENINT(value), tn, tc);
	}
    }
    memcpy(p, RSTRING_PTR(value), RSTRING_LEN(value));
    p += RSTRING_LEN(value);

    /* In this case we need an additional EOC (one for the explicit part and
     * one for the Constructive itself. The EOC for the Constructive is
     * supplied by the user, but that for the &quot;explicit wrapper&quot; must be
     * added here.
     */
    if (explicit &amp;&amp; inf_length == Qtrue) {
	ASN1_put_eoc(&amp;p);
    }
    ossl_str_adjust(str, p);

    return str;
}
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>