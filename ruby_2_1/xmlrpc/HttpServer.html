<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: HttpServer &mdash; xmlrpc  Ruby-2.1.10 p492</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "HttpServer",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../index.html'>Home</a> &raquo; 
        <a href='../index.html'>Ruby-2.1.10</a> &raquo; 
        <a href='index.html'>xmlrpc</a> &raquo; 
        <a href='_index.html#alpha_H'>Index (H)</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>HttpServer&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: HttpServer</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="HttpServer/Request.html" title="HttpServer::Request (class)">Request</a>,
        <a href="HttpServer/Response.html" title="HttpServer::Response (class)">Response</a>,
        <a href="HttpServer/Table.html" title="HttpServer::Table (class)">Table</a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          GServer
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          GServer
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'>GServer</span>
        <ul class='fullTree'>
          <li>Object</li>
          <li class='next'>GServer</li>
          <li class='next'>HttpServer</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L11'>lib/xmlrpc/httpserver.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Implements a simple HTTP-server by using John W. Small&#39;s
(jsmall@laser.net) ruby-generic-server: GServer.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='CRLF-constant' class='summary_signature'>CRLF =</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L24-L24'># File 'lib/xmlrpc/httpserver.rb', line 24</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
  <li>
    <span id='DEFAULT_HEADER-constant' class='summary_signature'>DEFAULT_HEADER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Default header for the server name</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L29-L31'># File 'lib/xmlrpc/httpserver.rb', line 29</a>    <pre class='code ruby'><span class='lbrace'>{</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Server</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='const'><a href="#SERVER_NAME-constant" title="HttpServer::SERVER_NAME (constant)">SERVER_NAME</a></span>
<span class='rbrace'>}</span></pre>
  </li>
  <li>
    <span id='HTTP_PROTO-constant' class='summary_signature'>HTTP_PROTO =</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L25-L25'># File 'lib/xmlrpc/httpserver.rb', line 25</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP/1.0</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
  <li>
    <span id='SERVER_NAME-constant' class='summary_signature'>SERVER_NAME =</span>
    <br/>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L26-L26'># File 'lib/xmlrpc/httpserver.rb', line 26</a>    <pre class='code ruby'><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HttpServer (Ruby </span><span class='embexpr_beg'>#{</span><span class='const'>RUBY_VERSION</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span></pre>
  </li>
  <li>
    <span id='StatusCodeMapping-constant' class='summary_signature'>StatusCodeMapping =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Mapping of status codes and error messages</p>

  </div>
</div>
    <a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L34-L41'># File 'lib/xmlrpc/httpserver.rb', line 34</a>    <pre class='code ruby'><span class='lbrace'>{</span>
  <span class='int'>200</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OK</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='int'>400</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bad Request</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='int'>403</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Forbidden</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='int'>405</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Method Not Allowed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='int'>411</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Length Required</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='int'>500</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal Server Error</span><span class='tstring_end'>&quot;</span></span>
<span class='rbrace'>}</span></pre>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(handle_obj, port = 8080, host = DEFAULT_HOST, maxConnections = 4, stdlog = $stdout, audit = true, debug = true)  &#x21d2; HttpServer </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p><code>handle_obj</code> specifies the object, that receives calls from
<code>request_handler</code> and <code>ip_auth_handler</code></p></div>
    </div>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#http_date-instance_method" title="#http_date (instance method)">#<strong>http_date</strong>(aTime)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a string which represents the time as rfc1123-date of HTTP-date.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#http_header-instance_method" title="#http_header (instance method)">#<strong>http_header</strong>(header = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Generates a Hash with the HTTP headers.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#http_resp-instance_method" title="#http_resp (instance method)">#<strong>http_resp</strong>(status_code, status_message = nil, header = nil, body = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a string which includes the status code message as, http headers,
and body for the response.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#serve-instance_method" title="#serve (instance method)">#<strong>serve</strong>(io)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Handles the HTTP request and writes the response back to the client, <code>io</code>.</p></div>
    </div>
  </li>
</ul>
</div>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(handle_obj, port = 8080, host = DEFAULT_HOST, maxConnections = 4, stdlog = $stdout, audit = true, debug = true)  &#x21d2; <code>HttpServer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>handle_obj</code> specifies the object, that receives calls from
<code>request_handler</code> and <code>ip_auth_handler</code></p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L16-L20'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


16
17
18
19
20</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/xmlrpc/httpserver.rb', line 16</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_handle_obj'>handle_obj</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span> <span class='op'>=</span> <span class='int'>8080</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='const'>DEFAULT_HOST</span><span class='comma'>,</span> <span class='id identifier rubyid_maxConnections'>maxConnections</span> <span class='op'>=</span> <span class='int'>4</span><span class='comma'>,</span>
               <span class='id identifier rubyid_stdlog'>stdlog</span> <span class='op'>=</span> <span class='gvar'>$stdout</span><span class='comma'>,</span> <span class='id identifier rubyid_audit'>audit</span> <span class='op'>=</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_debug'>debug</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='ivar'>@handler</span> <span class='op'>=</span> <span class='id identifier rubyid_handle_obj'>handle_obj</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_port'>port</span><span class='comma'>,</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_maxConnections'>maxConnections</span><span class='comma'>,</span> <span class='id identifier rubyid_stdlog'>stdlog</span><span class='comma'>,</span> <span class='id identifier rubyid_audit'>audit</span><span class='comma'>,</span> <span class='id identifier rubyid_debug'>debug</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="http_date-instance_method">
  <h3 class='signature  first'>
    #<strong>http_date</strong>(aTime)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a string which represents the time as rfc1123-date of HTTP-date</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L115-L117'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


115
116
117</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/xmlrpc/httpserver.rb', line 115</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_http_date'>http_date</span><span class='lparen'>(</span> <span class='id identifier rubyid_aTime'>aTime</span> <span class='rparen'>)</span> <span class='comment'># :doc:
</span>  <span class='id identifier rubyid_aTime'>aTime</span><span class='period'>.</span><span class='id identifier rubyid_gmtime'>gmtime</span><span class='period'>.</span><span class='id identifier rubyid_strftime'>strftime</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%a, %d %b %Y %H:%M:%S GMT</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="http_header-instance_method">
  <h3 class='signature '>
    #<strong>http_header</strong>(header = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Generates a Hash with the HTTP headers</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L104-L112'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


104
105
106
107
108
109
110
111
112</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/xmlrpc/httpserver.rb', line 104</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_http_header'>http_header</span><span class='lparen'>(</span><span class='id identifier rubyid_header'>header</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># :doc:
</span>  <span class='id identifier rubyid_new_header'>new_header</span> <span class='op'>=</span> <span class='const'><a href="HttpServer/Table.html" title="HttpServer::Table (class)">Table</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="HttpServer/Table.html#new-class_method" title="HttpServer::Table.new (method)">new</a></span><span class='lparen'>(</span><span class='const'><a href="#DEFAULT_HEADER-constant" title="HttpServer::DEFAULT_HEADER (constant)">DEFAULT_HEADER</a></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_header'>new_header</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_header'>header</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_new_header'>new_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>close</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_new_header'>new_header</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Date</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>       <span class='op'>=</span> <span class='id identifier rubyid_http_date'>http_date</span><span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_new_header'>new_header</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="http_resp-instance_method">
  <h3 class='signature '>
    #<strong>http_resp</strong>(status_code, status_message = nil, header = nil, body = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a string which includes the status code message as, http headers,
and body for the response.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L121-L130'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


121
122
123
124
125
126
127
128
129
130</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/xmlrpc/httpserver.rb', line 121</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_http_resp'>http_resp</span><span class='lparen'>(</span><span class='id identifier rubyid_status_code'>status_code</span><span class='comma'>,</span> <span class='id identifier rubyid_status_message'>status_message</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_header'>header</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_body'>body</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># :doc:
</span>  <span class='id identifier rubyid_status_message'>status_message</span> <span class='op'>||=</span> <span class='const'><a href="#StatusCodeMapping-constant" title="HttpServer::StatusCodeMapping (constant)">StatusCodeMapping</a></span><span class='lbracket'>[</span><span class='id identifier rubyid_status_code'>status_code</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><a href="#HTTP_PROTO-constant" title="HttpServer::HTTP_PROTO (constant)">HTTP_PROTO</a></span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status_code'>status_code</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status_message'>status_message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>&lt;&lt;</span> <span class='const'><a href="#CRLF-constant" title="HttpServer::CRLF (constant)">CRLF</a></span>
  <span class='id identifier rubyid_http_header'>http_header</span><span class='lparen'>(</span><span class='id identifier rubyid_header'>header</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_writeTo'>writeTo</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='const'><a href="#CRLF-constant" title="HttpServer::CRLF (constant)">CRLF</a></span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_body'>body</span> <span class='kw'>unless</span> <span class='id identifier rubyid_body'>body</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="serve-instance_method">
  <h3 class='signature '>
    #<strong>serve</strong>(io)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Handles the HTTP request and writes the response back to the client, <code>io</code>.</p>

<p>If an Exception is raised while handling the request, the client will
receive a 500 "Internal Server Error" message.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v2_1_10/lib/xmlrpc/httpserver.rb#L136-L170'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/xmlrpc/httpserver.rb', line 136</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_serve'>serve</span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span> <span class='comment'># :doc:
</span>  <span class='comment'># perform IP authentication
</span>  <span class='kw'>unless</span> <span class='ivar'>@handler</span><span class='period'>.</span><span class='id identifier rubyid_ip_auth_handler'>ip_auth_handler</span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_io'>io</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_http_resp'>http_resp</span><span class='lparen'>(</span><span class='int'>403</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Forbidden</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='comment'># parse first line
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(\S)\s(\S)\s(\S+)</span><span class='regexp_end'>/</span></span>
    <span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='const'><a href="HttpServer/Request.html" title="HttpServer::Request (class)">Request</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="HttpServer/Request.html#new-class_method" title="HttpServer::Request.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='backref'>$1</span><span class='comma'>,</span> <span class='backref'>$2</span><span class='comma'>,</span> <span class='backref'>$3</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_io'>io</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_http_resp'>http_resp</span><span class='lparen'>(</span><span class='int'>400</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bad Request</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='comment'># parse HTTP headers
</span>  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='op'>=</span><span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span><span class='rparen'>)</span> <span class='op'>!~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(\n|\r)</span><span class='regexp_end'>/</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^([\w-]+):\s*(.*)$</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='lbracket'>[</span><span class='backref'>$1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_binmode'>binmode</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><a href="HttpServer/Response.html" title="HttpServer::Response (class)">Response</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="HttpServer/Response.html#new-class_method" title="HttpServer::Response.new (method)">new</a></span>

  <span class='comment'># execute request handler
</span>  <span class='ivar'>@handler</span><span class='period'>.</span><span class='id identifier rubyid_request_handler'>request_handler</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span>

  <span class='comment'># write response back to the client
</span>  <span class='id identifier rubyid_io'>io</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_http_resp'>http_resp</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_status_message'>status_message</span><span class='comma'>,</span>
                  <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_header'>header</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='rparen'>)</span>

<span class='kw'>rescue</span> <span class='const'>Exception</span>
  <span class='id identifier rubyid_io'>io</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_http_resp'>http_resp</span><span class='lparen'>(</span><span class='int'>500</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal Server Error</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>