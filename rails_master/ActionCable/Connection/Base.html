<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActionCable::Connection::Base &mdash; Rails-master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActionCable::Connection::Base",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../../index.html'>Home</a> &raquo; 
        <a href='../../index.html'>Rails-master</a> &raquo; 
        <a href='../../_index.html#alpha_B'>Index (B)</a> &raquo; 
        <a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a> &raquo; 
        <a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>Base&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: ActionCable::Connection::Base</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Authorization.html" title="ActionCable::Connection::Authorization (module)">Authorization</a>,
          <a href="InternalChannel.html" title="ActionCable::Connection::InternalChannel (module)">InternalChannel</a>,
          <a href="Identification.html" title="ActionCable::Connection::Identification (module)">Identification</a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L43'>actioncable/lib/action_cable/connection/base.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>For every <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> connection the Action Cable
server accepts, a <a href="../Connection.html" title="ActionCable::Connection (module)">::ActionCable::Connection</a> object will be instantiated.
This instance becomes the parent of all of the channel subscriptions that
are created from there on. Incoming messages are then routed to these
channel subscriptions based on an identifier sent by the Action Cable
consumer. The Connection itself does not deal with any specific application
logic beyond authentication and authorization.</p>

<p>Here&#39;s a basic example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>ApplicationCable</span>
  <span class='kw'>class</span> <span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span> <span class='op'>&lt;</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'>Base</span>
    <span class='id identifier rubyid_identified_by'>identified_by</span> <span class='symbeg'>:</span><span class='id identifier rubyid_current_user'>current_user</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_connect'>connect</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_current_user'>current_user</span> <span class='op'>=</span> <span class='id identifier rubyid_find_verified_user'>find_verified_user</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_add_tags'>add_tags</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_disconnect'>disconnect</span>
      <span class='comment'># Any cleanup work needed when the cable connection is cut.
</span>    <span class='kw'>end</span>

    <span class='id identifier rubyid_private'>private</span>
      <span class='kw'>def</span> <span class='id identifier rubyid_find_verified_user'>find_verified_user</span>
        <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find_by_identity'>find_by_identity</span><span class='lparen'>(</span><span class='id identifier rubyid_cookies'>cookies</span><span class='period'>.</span><span class='id identifier rubyid_signed'>signed</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_identity_id'>identity_id</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>||</span>
          <span class='id identifier rubyid_reject_unauthorized_connection'>reject_unauthorized_connection</span>
      <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>First, we declare that this connection can be identified by its
current_user. This allows us to later be able to find all connections
established for that current_user (and potentially disconnect them). You
can declare as many identification indexes as you like. Declaring an
identification means that an attr_accessor is automatically set for that
key.</p>

<p>Second, we rely on the fact that the <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a>
connection is established with the cookies from the domain being sent
along. This makes it easy to use signed cookies that were set when logging
in via a web interface to authorize the
<a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> connection.</p>

<p>Finally, we add a tag to the connection-specific logger with the name of
the current user to easily distinguish their messages in the log.</p>

<p>Pretty simple, eh?</p>

  </div>
</div>
</div>
<h2 class='h2_sum'><a href="Identification.html" title="ActionCable::Connection::Identification (module)">Identification</a> - Attributes &amp; Methods</h2>
<div>
<ul class='summary full'>
  <li>
    <span class='summary_signature rw'>
      <a href="#identifiers-class_method" title=".identifiers (class method)">.<strong>identifiers</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#identifiers-instance_method" title="#identifiers (instance method)">#<strong>identifiers</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#identifiers%3F-class_method" title=".identifiers? (class method)">.<strong>identifiers?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#identifiers%3F-instance_method" title="#identifiers? (instance method)">#<strong>identifiers?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title rw'>rw</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(server, env, coder: ActiveSupport::JSON)  &#x21d2; Base </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#env-instance_method" title="#env (instance method)">#<strong>env</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#event_loop-instance_method" title="#event_loop (instance method)">#<strong>event_loop</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#logger-instance_method" title="#logger (instance method)">#<strong>logger</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#protocol-instance_method" title="#protocol (instance method)">#<strong>protocol</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#pubsub-instance_method" title="#pubsub (instance method)">#<strong>pubsub</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#server-instance_method" title="#server (instance method)">#<strong>server</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#subscriptions-instance_method" title="#subscriptions (instance method)">#<strong>subscriptions</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#worker_pool-instance_method" title="#worker_pool (instance method)">#<strong>worker_pool</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro prot'>
      <a href="#message_buffer-instance_method" title="#message_buffer (instance method)">#<strong>message_buffer</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title protected'>protected</span>
  </li>
  <li>
    <span class='summary_signature ro prot'>
      <a href="#websocket-instance_method" title="#websocket (instance method)">#<strong>websocket</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title protected'>protected</span>
  </li>
  <li>
    <span class='summary_signature ro priv'>
      <a href="#allow_request_origin%3F-instance_method" title="#allow_request_origin? (instance method)">#<strong>allow_request_origin?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#beat-instance_method" title="#beat (instance method)">#<strong>beat</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Close the <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#send_async-instance_method" title="#send_async (instance method)">#<strong>send_async</strong>(method, *arguments)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Invoke a method on the connection asynchronously through the pool of thread
workers.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#statistics-instance_method" title="#statistics (instance method)">#<strong>statistics</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return a basic hash of statistics for the connection keyed with
<code>identifier</code>, <code>started_at</code>, <a href="#subscriptions-instance_method" title="ActionCable::Connection::Base#subscriptions (method)">#subscriptions</a>, and <code>request_id</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#cookies-instance_method" title="#cookies (instance method)">#<strong>cookies</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>The cookies of the request that initiated the
<a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#decode-instance_method" title="#decode (instance method)">#<strong>decode</strong>(websocket_message)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#encode-instance_method" title="#encode (instance method)">#<strong>encode</strong>(cable_message)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#finished_request_message-instance_method" title="#finished_request_message (instance method)">#<strong>finished_request_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#handle_close-instance_method" title="#handle_close (instance method)">#<strong>handle_close</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#handle_open-instance_method" title="#handle_open (instance method)">#<strong>handle_open</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#invalid_request_message-instance_method" title="#invalid_request_message (instance method)">#<strong>invalid_request_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#new_tagged_logger-instance_method" title="#new_tagged_logger (instance method)">#<strong>new_tagged_logger</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Tags are declared in the server but computed in the connection.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#request-instance_method" title="#request (instance method)">#<strong>request</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>The request that initiated the <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a>
connection is available here.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#respond_to_invalid_request-instance_method" title="#respond_to_invalid_request (instance method)">#<strong>respond_to_invalid_request</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#respond_to_successful_request-instance_method" title="#respond_to_successful_request (instance method)">#<strong>respond_to_successful_request</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#send_welcome_message-instance_method" title="#send_welcome_message (instance method)">#<strong>send_welcome_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#started_request_message-instance_method" title="#started_request_message (instance method)">#<strong>started_request_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#successful_request_message-instance_method" title="#successful_request_message (instance method)">#<strong>successful_request_message</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#dispatch_websocket_message-instance_method" title="#dispatch_websocket_message (instance method)">#<strong>dispatch_websocket_message</strong>(websocket_message)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#on_close-instance_method" title="#on_close (instance method)">#<strong>on_close</strong>(reason, code)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#on_error-instance_method" title="#on_error (instance method)">#<strong>on_error</strong>(message)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#on_message-instance_method" title="#on_message (instance method)">#<strong>on_message</strong>(message)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#on_open-instance_method" title="#on_open (instance method)">#<strong>on_open</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Called by the server when a new <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a>
connection is established.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#receive-instance_method" title="#receive (instance method)">#<strong>receive</strong>(websocket_message)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Decodes WebSocket messages and dispatches them to subscribed channels.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#transmit-instance_method" title="#transmit (instance method)">#<strong>transmit</strong>(cable_message)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited'><a href="Authorization.html" title="ActionCable::Connection::Authorization (module)">Authorization</a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Authorization.html#reject_unauthorized_connection-instance_method" title="ActionCable::Connection::Authorization#reject_unauthorized_connection (method)">#reject_unauthorized_connection</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="InternalChannel.html" title="ActionCable::Connection::InternalChannel (module)">InternalChannel</a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="InternalChannel.html#internal_channel-instance_method" title="ActionCable::Connection::InternalChannel#internal_channel (method)">#internal_channel</a>,
        <a class='i_m priv' href="InternalChannel.html#process_internal_message-instance_method" title="ActionCable::Connection::InternalChannel#process_internal_message (method)">#process_internal_message</a>,
        <a class='i_m priv' href="InternalChannel.html#subscribe_to_internal_channel-instance_method" title="ActionCable::Connection::InternalChannel#subscribe_to_internal_channel (method)">#subscribe_to_internal_channel</a>,
        <a class='i_m priv' href="InternalChannel.html#unsubscribe_from_internal_channel-instance_method" title="ActionCable::Connection::InternalChannel#unsubscribe_from_internal_channel (method)">#unsubscribe_from_internal_channel</a>
      </td>
    </tr>
  </tbody>
</table></div>

<h3 class='inherited'><a href="Identification.html" title="ActionCable::Connection::Identification (module)">Identification</a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Identification.html#connection_identifier-instance_method" title="ActionCable::Connection::Identification#connection_identifier (method)">#connection_identifier</a></td>
      <td><div class='inline'><p>Return a single connection identifier that combines the value of all the
registered identifiers into a single gid.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m priv' href="Identification.html#connection_gid-instance_method" title="ActionCable::Connection::Identification#connection_gid (method)">#connection_gid</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(server, env, coder: ActiveSupport::JSON)  &#x21d2; <code>Base</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L51-L63'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


51
52
53
54
55
56
57
58
59
60
61
62
63</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 51</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='label'>coder:</span> <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/JSON.html" title="ActiveSupport::JSON (module)">JSON</a></span><span class='rparen'>)</span>
  <span class='ivar'>@server</span><span class='comma'>,</span> <span class='ivar'>@env</span><span class='comma'>,</span> <span class='ivar'>@coder</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_coder'>coder</span>

  <span class='ivar'>@worker_pool</span> <span class='op'>=</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_worker_pool'>worker_pool</span>
  <span class='ivar'>@logger</span> <span class='op'>=</span> <span class='id identifier rubyid_new_tagged_logger'>new_tagged_logger</span>

  <span class='ivar'>@websocket</span>      <span class='op'>=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="WebSocket.html#new-class_method" title="ActionCable::Connection::WebSocket.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_event_loop'>event_loop</span><span class='rparen'>)</span>
  <span class='ivar'>@subscriptions</span>  <span class='op'>=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="Subscriptions.html" title="ActionCable::Connection::Subscriptions (class)">Subscriptions</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Subscriptions.html#new-class_method" title="ActionCable::Connection::Subscriptions.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@message_buffer</span> <span class='op'>=</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="MessageBuffer.html" title="ActionCable::Connection::MessageBuffer (class)">MessageBuffer</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="MessageBuffer.html#new-class_method" title="ActionCable::Connection::MessageBuffer.new (method)">new</a></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>

  <span class='ivar'>@_internal_subscriptions</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@started_at</span> <span class='op'>=</span> <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Attribute Details</h2>
<section class='method_details first' id="identifiers-class_method">
  <h3 class='signature rw first'>
    .<strong>identifiers</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/identification.rb#L9-L9'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/identification.rb', line 9</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_identifiers'>identifiers</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="identifiers?-class_method">
  <h3 class='signature rw'>
    .<strong>identifiers?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/identification.rb#L9-L9'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/identification.rb', line 9</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_identifiers'>identifiers</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="allow_request_origin?-instance_method">
  <h3 class='signature ro priv first'>
    #<strong>allow_request_origin?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>, <span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L194-L206'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 194</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_allow_request_origin?'>allow_request_origin?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_disable_request_forgery_protection'>disable_request_forgery_protection</span>

  <span class='id identifier rubyid_proto'>proto</span> <span class='op'>=</span> <span class='const'><a href="../../Rack.html" title="Rack (module)">Rack</a></span><span class='op'>::</span><span class='const'>Request</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_ssl?'>ssl?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_allow_same_origin_as_host'>allow_same_origin_as_host</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_ORIGIN</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_proto'>proto</span><span class='embexpr_end'>}</span><span class='tstring_content'>://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_HOST</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>true</span>
  <span class='kw'>elsif</span> <span class='const'><a href="../../Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_allowed_request_origins'>allowed_request_origins</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_allowed_origin'>allowed_origin</span><span class='op'>|</span>  <span class='id identifier rubyid_allowed_origin'>allowed_origin</span> <span class='op'>===</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_ORIGIN</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Request origin not allowed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_ORIGIN</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="env-instance_method">
  <h3 class='signature ro'>
    #<strong>env</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L48-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


48</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="event_loop-instance_method">
  <h3 class='signature ro'>
    #<strong>event_loop</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L49-L49'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


49</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 49</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_event_loop'>event_loop</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_pubsub'>pubsub</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="identifiers-instance_method">
  <h3 class='signature rw'>
    #<strong>identifiers</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/identification.rb#L9-L9'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/identification.rb', line 9</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_identifiers'>identifiers</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="identifiers?-instance_method">
  <h3 class='signature rw'>
    #<strong>identifiers?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/identification.rb#L9-L9'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


9</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/identification.rb', line 9</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_class_attribute'>class_attribute</span> <span class='symbeg'>:</span><span class='id identifier rubyid_identifiers'>identifiers</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="logger-instance_method">
  <h3 class='signature ro'>
    #<strong>logger</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L48-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


48</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="message_buffer-instance_method">
  <h3 class='signature ro prot'>
    #<strong>message_buffer</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='prot'>protected</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L140-L140'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


140</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 140</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_buffer'>message_buffer</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="protocol-instance_method">
  <h3 class='signature ro'>
    #<strong>protocol</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L48-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


48</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="pubsub-instance_method">
  <h3 class='signature ro'>
    #<strong>pubsub</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L49-L49'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


49</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 49</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_delegate'>delegate</span> <span class='symbeg'>:</span><span class='id identifier rubyid_event_loop'>event_loop</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_pubsub'>pubsub</span><span class='comma'>,</span> <span class='label'>to:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="server-instance_method">
  <h3 class='signature ro'>
    #<strong>server</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L48-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


48</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="subscriptions-instance_method">
  <h3 class='signature ro'>
    #<strong>subscriptions</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L48-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


48</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="websocket-instance_method">
  <h3 class='signature ro prot'>
    #<strong>websocket</strong>   <span class="extras">(<span class='readonly'>readonly</span>, <span class='prot'>protected</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L139-L139'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


139</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 139</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_websocket'>websocket</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="worker_pool-instance_method">
  <h3 class='signature ro'>
    #<strong>worker_pool</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L48-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


48</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 48</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_protocol'>protocol</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="beat-instance_method">
  <h3 class='signature  first'>
    #<strong>beat</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L116-L118'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


116
117
118</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 116</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_beat'>beat</span>
  <span class='id identifier rubyid_transmit'>transmit</span> <span class='label'>type:</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../../ActionCable.html#INTERNAL-constant" title="ActionCable::INTERNAL (constant)">INTERNAL</a></span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_message_types'>message_types</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_ping'>ping</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close-instance_method">
  <h3 class='signature '>
    #<strong>close</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Close the <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> connection.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L96-L98'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


96
97
98</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 96</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cookies-instance_method">
  <h3 class='signature priv'>
    #<strong>cookies</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The cookies of the request that initiated the
<a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> connection. Useful for performing
authorization checks.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L152-L154'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


152
153
154</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 152</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cookies'>cookies</span> <span class='comment'># :doc:
</span>  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_cookie_jar'>cookie_jar</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="decode-instance_method">
  <h3 class='signature priv'>
    #<strong>decode</strong>(websocket_message)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L160-L162'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


160
161
162</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 160</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span>
  <span class='ivar'>@coder</span><span class='period'>.</span><span class='id identifier rubyid_decode'>decode</span> <span class='id identifier rubyid_websocket_message'>websocket_message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="dispatch_websocket_message-instance_method">
  <h3 class='signature nodoc'>
    #<strong>dispatch_websocket_message</strong>(websocket_message)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L83-L89'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


83
84
85
86
87
88
89</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 83</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatch_websocket_message'>dispatch_websocket_message</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_alive?'>alive?</span>
    <span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='period'>.</span><span class='id identifier rubyid_execute_command'>execute_command</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ignoring message processed after the WebSocket was closed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="encode-instance_method">
  <h3 class='signature priv'>
    #<strong>encode</strong>(cable_message)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L156-L158'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


156
157
158</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 156</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='id identifier rubyid_cable_message'>cable_message</span><span class='rparen'>)</span>
  <span class='ivar'>@coder</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span> <span class='id identifier rubyid_cable_message'>cable_message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="finished_request_message-instance_method">
  <h3 class='signature priv'>
    #<strong>finished_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L236-L242'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


236
237
238
239
240
241
242</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 236</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_finished_request_message'>finished_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Finished &quot;%s&quot;%s for %s at %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_filtered_path'>filtered_path</span><span class='comma'>,</span>
    <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_possible?'>possible?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> [WebSocket]</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[non-WebSocket]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span>
    <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="handle_close-instance_method">
  <h3 class='signature priv'>
    #<strong>handle_close</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L176-L185'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


176
177
178
179
180
181
182
183
184
185</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 176</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_close'>handle_close</span>
  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_finished_request_message'>finished_request_message</span>

  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_remove_connection'>remove_connection</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='period'>.</span><span class='id identifier rubyid_unsubscribe_from_all'>unsubscribe_from_all</span>
  <span class='id identifier rubyid_unsubscribe_from_internal_channel'>unsubscribe_from_internal_channel</span>

  <span class='id identifier rubyid_disconnect'>disconnect</span> <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_disconnect'>disconnect</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="handle_open-instance_method">
  <h3 class='signature priv'>
    #<strong>handle_open</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L164-L174'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


164
165
166
167
168
169
170
171
172
173
174</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 164</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_open'>handle_open</span>
  <span class='ivar'>@protocol</span> <span class='op'>=</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_protocol'>protocol</span>
  <span class='id identifier rubyid_connect'>connect</span> <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_connect'>connect</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_subscribe_to_internal_channel'>subscribe_to_internal_channel</span>
  <span class='id identifier rubyid_send_welcome_message'>send_welcome_message</span>

  <span class='id identifier rubyid_message_buffer'>message_buffer</span><span class='period'>.</span><span class='id identifier rubyid_process!'>process!</span>
  <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_add_connection'>add_connection</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../Connection.html" title="ActionCable::Connection (module)">Connection</a></span><span class='op'>::</span><span class='const'><a href="Authorization.html" title="ActionCable::Connection::Authorization (module)">Authorization</a></span><span class='op'>::</span><span class='const'><a href="Authorization/UnauthorizedError.html" title="ActionCable::Connection::Authorization::UnauthorizedError (class)">UnauthorizedError</a></span>
  <span class='id identifier rubyid_respond_to_invalid_request'>respond_to_invalid_request</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="invalid_request_message-instance_method">
  <h3 class='signature priv'>
    #<strong>invalid_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L244-L248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


244
245
246
247
248</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 244</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_invalid_request_message'>invalid_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to upgrade to WebSocket (REQUEST_METHOD: %s, HTTP_CONNECTION: %s, HTTP_UPGRADE: %s)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>REQUEST_METHOD</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_CONNECTION</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_UPGRADE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="new_tagged_logger-instance_method">
  <h3 class='signature priv'>
    #<strong>new_tagged_logger</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Tags are declared in the server but computed in the connection. This allows
us per-connection tailored tags.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L222-L225'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


222
223
224
225</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 222</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new_tagged_logger'>new_tagged_logger</span>
  <span class='const'><a href="TaggedLoggerProxy.html" title="ActionCable::Connection::TaggedLoggerProxy (class)">TaggedLoggerProxy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="TaggedLoggerProxy.html#new-class_method" title="ActionCable::Connection::TaggedLoggerProxy.new (method)">new</a></span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span>
    <span class='label'>tags:</span> <span class='id identifier rubyid_server'>server</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_log_tags'>log_tags</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_tag'>tag</span><span class='op'>|</span> <span class='id identifier rubyid_tag'>tag</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_call'>call</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_tag'>tag</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_tag'>tag</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_camelize'>camelize</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_close-instance_method">
  <h3 class='signature nodoc'>
    #<strong>on_close</strong>(reason, code)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L132-L134'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


132
133
134</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 132</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_close'>on_close</span><span class='lparen'>(</span><span class='id identifier rubyid_reason'>reason</span><span class='comma'>,</span> <span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_send_async'>send_async</span> <span class='symbeg'>:</span><span class='id identifier rubyid_handle_close'>handle_close</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_error-instance_method">
  <h3 class='signature nodoc'>
    #<strong>on_error</strong>(message)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L128-L130'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


128
129
130</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 128</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_error'>on_error</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='comment'># ignore
</span><span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_message-instance_method">
  <h3 class='signature nodoc'>
    #<strong>on_message</strong>(message)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L124-L126'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


124
125
126</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 124</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_message'>on_message</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_message_buffer'>message_buffer</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="on_open-instance_method">
  <h3 class='signature nodoc'>
    #<strong>on_open</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L120-L122'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


120
121
122</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 120</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_on_open'>on_open</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_send_async'>send_async</span> <span class='symbeg'>:</span><span class='id identifier rubyid_handle_open'>handle_open</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="process-instance_method">
  <h3 class='signature nodoc'>
    #<strong>process</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Called by the server when a new <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a>
connection is established. This configures the callbacks intended for
overwriting by the user. This method should not be called directly --
instead rely upon on the <code>#connect</code> (and <code>#disconnect</code>) callbacks.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L67-L75'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


67
68
69
70
71
72
73
74
75</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 67</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_started_request_message'>started_request_message</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_possible?'>possible?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_allow_request_origin?'>allow_request_origin?</span>
    <span class='id identifier rubyid_respond_to_successful_request'>respond_to_successful_request</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_respond_to_invalid_request'>respond_to_invalid_request</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="receive-instance_method">
  <h3 class='signature nodoc'>
    #<strong>receive</strong>(websocket_message)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Decodes WebSocket messages and dispatches them to subscribed channels.
<a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a> message transfer encoding is always
JSON.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L79-L81'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


79
80
81</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 79</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='id identifier rubyid_websocket_message'>websocket_message</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_send_async'>send_async</span> <span class='symbeg'>:</span><span class='id identifier rubyid_dispatch_websocket_message'>dispatch_websocket_message</span><span class='comma'>,</span> <span class='id identifier rubyid_websocket_message'>websocket_message</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="request-instance_method">
  <h3 class='signature priv'>
    #<strong>request</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The request that initiated the <a href="WebSocket.html" title="ActionCable::Connection::WebSocket (class)">WebSocket</a>
connection is available here. This gives access to the environment,
cookies, etc.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L144-L149'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


144
145
146
147
148
149</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 144</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_request'>request</span> <span class='comment'># :doc:
</span>  <span class='ivar'>@request</span> <span class='op'>||=</span> <span class='kw'>begin</span>
    <span class='id identifier rubyid_environment'>environment</span> <span class='op'>=</span> <span class='const'><a href="../../Rails.html" title="Rails (module)">Rails</a></span><span class='period'>.</span><span class='id identifier rubyid_application'><a href="../../Rails.html#application-class_method" title="Rails.application (method)">application</a></span><span class='period'>.</span><span class='id identifier rubyid_env_config'>env_config</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'><a href="../../Rails.html" title="Rails (module)">Rails</a></span><span class='period'>.</span><span class='id identifier rubyid_application'><a href="../../Rails.html#application-class_method" title="Rails.application (method)">application</a></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='const'><a href="../../Rails.html" title="Rails (module)">Rails</a></span><span class='period'>.</span><span class='id identifier rubyid_application'><a href="../../Rails.html#application-class_method" title="Rails.application (method)">application</a></span>
    <span class='const'><a href="../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a></span><span class='op'>::</span><span class='const'><a href="../../ActionDispatch/Request.html" title="ActionDispatch::Request (class)">Request</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="../../ActionDispatch/Request.html#new-class_method" title="ActionDispatch::Request.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_environment'>environment</span> <span class='op'>||</span> <span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="respond_to_invalid_request-instance_method">
  <h3 class='signature priv'>
    #<strong>respond_to_invalid_request</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L213-L219'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


213
214
215
216
217
218
219</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 213</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_respond_to_invalid_request'>respond_to_invalid_request</span>
  <span class='id identifier rubyid_close'>close</span> <span class='kw'>if</span> <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_alive?'>alive?</span>

  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='id identifier rubyid_invalid_request_message'>invalid_request_message</span>
  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_finished_request_message'>finished_request_message</span>
  <span class='lbracket'>[</span> <span class='int'>404</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Content-Type</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>text/plain</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Page not found</span><span class='tstring_end'>&quot;</span></span> <span class='rbracket'>]</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="respond_to_successful_request-instance_method">
  <h3 class='signature priv'>
    #<strong>respond_to_successful_request</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L208-L211'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


208
209
210
211</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 208</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_respond_to_successful_request'>respond_to_successful_request</span>
  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='id identifier rubyid_successful_request_message'>successful_request_message</span>
  <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_rack_response'>rack_response</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_async-instance_method">
  <h3 class='signature '>
    #<strong>send_async</strong>(method, *arguments)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Invoke a method on the connection asynchronously through the pool of thread
workers.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L101-L103'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


101
102
103</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 101</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_async'>send_async</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_worker_pool'>worker_pool</span><span class='period'>.</span><span class='id identifier rubyid_async_invoke'>async_invoke</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_arguments'>arguments</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="send_welcome_message-instance_method">
  <h3 class='signature priv'>
    #<strong>send_welcome_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L187-L192'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


187
188
189
190
191
192</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 187</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_send_welcome_message'>send_welcome_message</span>
  <span class='comment'># Send welcome message to the internal connection monitor channel.
</span>  <span class='comment'># This ensures the connection monitor state is reset after a successful
</span>  <span class='comment'># websocket connection.
</span>  <span class='id identifier rubyid_transmit'>transmit</span> <span class='label'>type:</span> <span class='const'><a href="../../ActionCable.html" title="ActionCable (module)">ActionCable</a></span><span class='op'>::</span><span class='const'><a href="../../ActionCable.html#INTERNAL-constant" title="ActionCable::INTERNAL (constant)">INTERNAL</a></span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_message_types'>message_types</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_welcome'>welcome</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="started_request_message-instance_method">
  <h3 class='signature priv'>
    #<strong>started_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L227-L234'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


227
228
229
230
231
232
233
234</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 227</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_started_request_message'>started_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Started %s &quot;%s&quot;%s for %s at %s</span><span class='tstring_end'>&#39;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span><span class='comma'>,</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_filtered_path'>filtered_path</span><span class='comma'>,</span>
    <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_possible?'>possible?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> [WebSocket]</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[non-WebSocket]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span>
    <span class='const'><a href="../../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="statistics-instance_method">
  <h3 class='signature '>
    #<strong>statistics</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return a basic hash of statistics for the connection keyed with
<code>identifier</code>, <code>started_at</code>, <a href="#subscriptions-instance_method" title="ActionCable::Connection::Base#subscriptions (method)">#subscriptions</a>, and <code>request_id</code>. This can be
returned by a health check against the connection.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L107-L114'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


107
108
109
110
111
112
113
114</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 107</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_statistics'>statistics</span>
  <span class='lbrace'>{</span>
    <span class='label'>identifier:</span> <span class='id identifier rubyid_connection_identifier'>connection_identifier</span><span class='comma'>,</span>
    <span class='label'>started_at:</span> <span class='ivar'>@started_at</span><span class='comma'>,</span>
    <span class='label'>subscriptions:</span> <span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='period'>.</span><span class='id identifier rubyid_identifiers'>identifiers</span><span class='comma'>,</span>
    <span class='label'>request_id:</span> <span class='ivar'>@env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>action_dispatch.request_id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="successful_request_message-instance_method">
  <h3 class='signature priv'>
    #<strong>successful_request_message</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L250-L254'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


250
251
252
253
254</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 250</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_successful_request_message'>successful_request_message</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully upgraded to WebSocket (REQUEST_METHOD: %s, HTTP_CONNECTION: %s, HTTP_UPGRADE: %s)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span>
    <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>REQUEST_METHOD</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_CONNECTION</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HTTP_UPGRADE</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="transmit-instance_method">
  <h3 class='signature nodoc'>
    #<strong>transmit</strong>(cable_message)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/actioncable/lib/action_cable/connection/base.rb#L91-L93'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


91
92
93</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actioncable/lib/action_cable/connection/base.rb', line 91</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_transmit'>transmit</span><span class='lparen'>(</span><span class='id identifier rubyid_cable_message'>cable_message</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_websocket'>websocket</span><span class='period'>.</span><span class='id identifier rubyid_transmit'>transmit</span> <span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span><span class='id identifier rubyid_cable_message'>cable_message</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>