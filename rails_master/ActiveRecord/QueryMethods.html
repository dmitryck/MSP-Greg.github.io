<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::QueryMethods &mdash; Rails-master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::QueryMethods",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../index.html'>Home</a> &raquo; 
        <a href='../index.html'>Rails-master</a> &raquo; 
        <a href='../_index.html#alpha_Q'>Index (Q)</a> &raquo; 
        <a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>QueryMethods&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActiveRecord::QueryMethods</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="QueryMethods/WhereChain.html" title="ActiveRecord::QueryMethods::WhereChain (class)">WhereChain</a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="AssociationRelation.html" title="ActiveRecord::AssociationRelation (class)">AssociationRelation</a>,
          <a href="Associations/CollectionProxy.html" title="ActiveRecord::Associations::CollectionProxy (class)">Associations::CollectionProxy</a>,
          <a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a>
      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Class Chain:</div>
        <div class='box_22'>
          self,
          <a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">::ActiveSupport::Concern</a>
        </div>
      </td>
    </tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a class='nodoc' href="../ActiveModel/ForbiddenAttributesProtection.html" title="ActiveModel::ForbiddenAttributesProtection (module)">::ActiveModel::ForbiddenAttributesProtection</a>
        </div>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L8'>activerecord/lib/active_record/relation/query_methods.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='FROZEN_EMPTY_ARRAY-constant' class='summary_signature'>FROZEN_EMPTY_ARRAY =</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L56-L56'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 56</a>    <pre class='code ruby'><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='FROZEN_EMPTY_HASH-constant' class='summary_signature'>FROZEN_EMPTY_HASH =</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L57-L57'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 57</a>    <pre class='code ruby'><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre>
  </li>
  <li>
    <span id='STRUCTURAL_OR_METHODS-constant' class='summary_signature'>STRUCTURAL_OR_METHODS =</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1163-L1163'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1163</a>    <pre class='code ruby'><span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation.html#VALUE_METHODS-constant" title="ActiveRecord::Relation::VALUE_METHODS (constant)">VALUE_METHODS</a></span> <span class='op'>-</span> <span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_extending'>extending</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_where'>where</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_having'>having</span><span class='rbracket'>]</span></pre>
  </li>
  <li>
    <span id='VALID_DIRECTIONS-constant' class='summary_signature nodoc'>VALID_DIRECTIONS =</span>
    <span class='nodoc note title'>Internal use only</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1102-L1103'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1102</a>    <pre class='code ruby'><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_asc'>asc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>ASC</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>DESC</span><span class='comma'>,</span>
<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>asc</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>desc</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ASC</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DESC</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span></pre>
  </li>
  <li>
    <span id='VALID_UNSCOPING_VALUES-constant' class='summary_signature'>VALID_UNSCOPING_VALUES =</span>
    <br/>
    <a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L349-L351'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 349</a>    <pre class='code ruby'><span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_where'>where</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_select'>select</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_group'>group</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_order'>order</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_lock'>lock</span><span class='comma'>,</span>
<span class='symbeg'>:</span><span class='id identifier rubyid_limit'>limit</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_offset'>offset</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_joins'>joins</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_includes'>includes</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_from'>from</span><span class='comma'>,</span>
<span class='symbeg'>:</span><span class='id identifier rubyid_readonly'>readonly</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_having'>having</span><span class='rbracket'>]</span><span class='rparen'>)</span></pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>

<h3 class='inherited'><a href="../ActiveSupport/Concern.html" title="ActiveSupport::Concern (module)">::ActiveSupport::Concern</a> - Extended</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="../ActiveSupport/Concern.html#append_features-instance_method" title="ActiveSupport::Concern#append_features (method)">append_features</a>,
        <a class='i_m ' href="../ActiveSupport/Concern.html#class_methods-instance_method" title="ActiveSupport::Concern#class_methods (method)">class_methods</a>,
        <a class='i_m ' href="../ActiveSupport/Concern.html#included-instance_method" title="ActiveSupport::Concern#included (method)">included</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#bound_attributes-instance_method" title="#bound_attributes (instance method)">#<strong>bound_attributes</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_with-instance_method" title="#create_with (instance method)">#<strong>create_with</strong>(value)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets attributes to be used when creating new records from a relation
object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#distinct-instance_method" title="#distinct (instance method)">#<strong>distinct</strong>(value = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specifies whether the records should be unique or not.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#eager_load-instance_method" title="#eager_load (instance method)">#<strong>eager_load</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Forces eager loading by performing a LEFT OUTER JOIN on <code>args</code>:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#extending-instance_method" title="#extending (instance method)">#<strong>extending</strong>(*modules, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Used to extend a scope with additional methods, either through a module or
through a block provided.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#extensions-instance_method" title="#extensions (instance method)">#<strong>extensions</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#from-instance_method" title="#from (instance method)">#<strong>from</strong>(value, subquery_name = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specifies table from which the records will be fetched.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#group-instance_method" title="#group (instance method)">#<strong>group</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows to specify a group attribute:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#having-instance_method" title="#having (instance method)">#<strong>having</strong>(opts, *rest)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows to specify a HAVING clause.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#includes-instance_method" title="#includes (instance method)">#<strong>includes</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specify relationships to be included in the result set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#joins-instance_method" title="#joins (instance method)">#<strong>joins</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Performs a joins on <code>args</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#left_joins-instance_method" title="#left_joins (instance method)">#<strong>left_joins</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#left_outer_joins-instance_method" title="ActiveRecord::QueryMethods#left_outer_joins (method)">#left_outer_joins</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#left_outer_joins-instance_method" title="#left_outer_joins (instance method)">#<strong>left_outer_joins</strong>(*args)  </a>
      (also: #left_joins)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Performs a left outer joins on <code>args</code>:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#limit-instance_method" title="#limit (instance method)">#<strong>limit</strong>(value)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specifies a limit for the number of records to retrieve.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#lock-instance_method" title="#lock (instance method)">#<strong>lock</strong>(locks = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specifies locking settings (default to <code>true</code>).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#none-instance_method" title="#none (instance method)">#<strong>none</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a chainable relation with zero records.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#offset-instance_method" title="#offset (instance method)">#<strong>offset</strong>(value)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Specifies the number of rows to skip before returning rows.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#or-instance_method" title="#or (instance method)">#<strong>or</strong>(other)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a new relation, which is the logical union of this relation and the
one passed as an argument.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#order-instance_method" title="#order (instance method)">#<strong>order</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows to specify an order attribute:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#preload-instance_method" title="#preload (instance method)">#<strong>preload</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows preloading of <code>args</code>, in the same way that <a href="#includes-instance_method" title="ActiveRecord::QueryMethods#includes (method)">#includes</a> does:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#readonly-instance_method" title="#readonly (instance method)">#<strong>readonly</strong>(value = true)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets readonly attributes for the returned relation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#references-instance_method" title="#references (instance method)">#<strong>references</strong>(*table_names)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Use to indicate that the given <code>table_names</code> are referenced by an SQL
string, and should therefore be JOINed in any query rather than loaded
separately.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reorder-instance_method" title="#reorder (instance method)">#<strong>reorder</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Replaces any existing order defined on the relation with the specified
order.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reverse_order-instance_method" title="#reverse_order (instance method)">#<strong>reverse_order</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Reverse the existing order clause on the relation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#rewhere-instance_method" title="#rewhere (instance method)">#<strong>rewhere</strong>(conditions)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Allows you to change a previously set where condition for a given
attribute, instead of appending to that condition.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#select-instance_method" title="#select (instance method)">#<strong>select</strong>(*fields)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Works in two unique ways.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#unscope-instance_method" title="#unscope (instance method)">#<strong>unscope</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Removes an unwanted relation that is already defined on a chain of
relations.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#where-instance_method" title="#where (instance method)">#<strong>where</strong>(opts = :chain, *rest)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a new relation, which is the result of filtering the current
relation according to the conditions in the arguments.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#arel_columns-instance_method" title="#arel_columns (instance method)">#<strong>arel_columns</strong>(columns)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#assert_mutability!-instance_method" title="#assert_mutability! (instance method)">#<strong>assert_mutability!</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_arel-instance_method" title="#build_arel (instance method)">#<strong>build_arel</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_from-instance_method" title="#build_from (instance method)">#<strong>build_from</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_join_query-instance_method" title="#build_join_query (instance method)">#<strong>build_join_query</strong>(manager, buckets, join_type)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_joins-instance_method" title="#build_joins (instance method)">#<strong>build_joins</strong>(manager, joins)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_left_outer_joins-instance_method" title="#build_left_outer_joins (instance method)">#<strong>build_left_outer_joins</strong>(manager, outer_joins)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_order-instance_method" title="#build_order (instance method)">#<strong>build_order</strong>(arel)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#build_select-instance_method" title="#build_select (instance method)">#<strong>build_select</strong>(arel)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#check_if_method_has_arguments!-instance_method" title="#check_if_method_has_arguments! (instance method)">#<strong>check_if_method_has_arguments!</strong>(method_name, args)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Checks to make sure that the arguments are not blank.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#convert_join_strings_to_ast-instance_method" title="#convert_join_strings_to_ast (instance method)">#<strong>convert_join_strings_to_ast</strong>(table, joins)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#default_value_for-instance_method" title="#default_value_for (instance method)">#<strong>default_value_for</strong>(name)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#does_not_support_reverse%3F-instance_method" title="#does_not_support_reverse? (instance method)">#<strong>does_not_support_reverse?</strong>(order)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#having_clause_factory-instance_method" title="#having_clause_factory (instance method)">#<strong>having_clause_factory</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#where_clause_factory-instance_method" title="ActiveRecord::QueryMethods#where_clause_factory (method)">#where_clause_factory</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#preprocess_order_args-instance_method" title="#preprocess_order_args (instance method)">#<strong>preprocess_order_args</strong>(order_args)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#reverse_sql_order-instance_method" title="#reverse_sql_order (instance method)">#<strong>reverse_sql_order</strong>(order_query)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#structurally_incompatible_values_for_or-instance_method" title="#structurally_incompatible_values_for_or (instance method)">#<strong>structurally_incompatible_values_for_or</strong>(other)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#validate_order_args-instance_method" title="#validate_order_args (instance method)">#<strong>validate_order_args</strong>(args)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#where_clause_factory-instance_method" title="#where_clause_factory (instance method)">#<strong>where_clause_factory</strong>  </a>
      (also: #having_clause_factory)
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#_select!-instance_method" title="#_select! (instance method)">#<strong>_select!</strong>(*fields)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#arel-instance_method" title="#arel (instance method)">#<strong>arel</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the Arel object associated with the relation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#create_with!-instance_method" title="#create_with! (instance method)">#<strong>create_with!</strong>(value)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#distinct!-instance_method" title="#distinct! (instance method)">#<strong>distinct!</strong>(value = true)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Like <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>, but modifies relation in place.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#eager_load!-instance_method" title="#eager_load! (instance method)">#<strong>eager_load!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#extending!-instance_method" title="#extending! (instance method)">#<strong>extending!</strong>(*modules, &amp;block)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#from!-instance_method" title="#from! (instance method)">#<strong>from!</strong>(value, subquery_name = nil)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#get_value-instance_method" title="#get_value (instance method)">#<strong>get_value</strong>(name)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a relation value with a given name.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#group!-instance_method" title="#group! (instance method)">#<strong>group!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#having!-instance_method" title="#having! (instance method)">#<strong>having!</strong>(opts, *rest)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#includes!-instance_method" title="#includes! (instance method)">#<strong>includes!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#joins!-instance_method" title="#joins! (instance method)">#<strong>joins!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#left_outer_joins!-instance_method" title="#left_outer_joins! (instance method)">#<strong>left_outer_joins!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#limit!-instance_method" title="#limit! (instance method)">#<strong>limit!</strong>(value)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#lock!-instance_method" title="#lock! (instance method)">#<strong>lock!</strong>(locks = true)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#none!-instance_method" title="#none! (instance method)">#<strong>none!</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#offset!-instance_method" title="#offset! (instance method)">#<strong>offset!</strong>(value)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#or!-instance_method" title="#or! (instance method)">#<strong>or!</strong>(other)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#order!-instance_method" title="#order! (instance method)">#<strong>order!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#preload!-instance_method" title="#preload! (instance method)">#<strong>preload!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#readonly!-instance_method" title="#readonly! (instance method)">#<strong>readonly!</strong>(value = true)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#references!-instance_method" title="#references! (instance method)">#<strong>references!</strong>(*table_names)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#reorder!-instance_method" title="#reorder! (instance method)">#<strong>reorder!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#reverse_order!-instance_method" title="#reverse_order! (instance method)">#<strong>reverse_order!</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#set_value-instance_method" title="#set_value (instance method)">#<strong>set_value</strong>(name, value)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets the relation value with the given name.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#unscope!-instance_method" title="#unscope! (instance method)">#<strong>unscope!</strong>(*args)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#where!-instance_method" title="#where! (instance method)">#<strong>where!</strong>(opts, *rest)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>

<h3 class='inherited nodoc'><a href="../ActiveModel/ForbiddenAttributesProtection.html" title="ActiveModel::ForbiddenAttributesProtection (module)">::ActiveModel::ForbiddenAttributesProtection</a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m priv nodoc' href="../ActiveModel/ForbiddenAttributesProtection.html#sanitize_for_mass_assignment-instance_method" title="ActiveModel::ForbiddenAttributesProtection#sanitize_for_mass_assignment (method)">#sanitize_for_mass_assignment</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv nodoc' href="../ActiveModel/ForbiddenAttributesProtection.html#sanitize_forbidden_attributes-instance_method" title="ActiveModel::ForbiddenAttributesProtection#sanitize_forbidden_attributes (method)">#sanitize_forbidden_attributes</a></td>
      <td><div class='inline'><p>Alias for
<a href="../ActiveModel/ForbiddenAttributesProtection.html#sanitize_for_mass_assignment-instance_method" title="ActiveModel::ForbiddenAttributesProtection#sanitize_for_mass_assignment (method)">ActiveModel::ForbiddenAttributesProtection#sanitize_for_mass_assignment</a>.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="_select!-instance_method">
  <h3 class='signature nodoc first'>
    #<strong>_select!</strong>(*fields)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L255-L262'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


255
256
257
258
259
260
261
262</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 255</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid__select!'>_select!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='op'>|</span>
    <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_attribute_alias?'>attribute_alias?</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_attribute_alias'>attribute_alias</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span> <span class='op'>:</span> <span class='id identifier rubyid_field'>field</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_select_values'>select_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_fields'>fields</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="arel-instance_method">
  <h3 class='signature nodoc'>
    #<strong>arel</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the Arel object associated with the relation.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L917-L919'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


917
918
919</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 917</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_arel'>arel</span> <span class='comment'># :nodoc:
</span>  <span class='ivar'>@arel</span> <span class='op'>||=</span> <span class='id identifier rubyid_build_arel'>build_arel</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="arel_columns-instance_method">
  <h3 class='signature priv'>
    #<strong>arel_columns</strong>(columns)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1049-L1059'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1049</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_arel_columns'>arel_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_columns'>columns</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_columns'>columns</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span> <span class='op'>===</span> <span class='id identifier rubyid_field'>field</span> <span class='op'>||</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span> <span class='op'>===</span> <span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_has_attribute?'>has_attribute?</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_attribute_alias?'>attribute_alias?</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_from_clause'>from_clause</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span> <span class='op'>===</span> <span class='id identifier rubyid_field'>field</span>
      <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_quote_table_name'>quote_table_name</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_field'>field</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="assert_mutability!-instance_method">
  <h3 class='signature priv'>
    #<strong>assert_mutability!</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="ImmutableRelation.html" title="ActiveRecord::ImmutableRelation (class)">ImmutableRelation</a>)</span>
  </li>
</ul>

</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L934-L937'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


934
935
936
937</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 934</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_mutability!'>assert_mutability!</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="ImmutableRelation.html" title="ActiveRecord::ImmutableRelation (class)">ImmutableRelation</a></span> <span class='kw'>if</span> <span class='ivar'>@loaded</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="ImmutableRelation.html" title="ActiveRecord::ImmutableRelation (class)">ImmutableRelation</a></span> <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@arel</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@arel</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="bound_attributes-instance_method">
  <h3 class='signature '>
    #<strong>bound_attributes</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L77-L100'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 77</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_bound_attributes'>bound_attributes</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_limit_value'>limit_value</span>
    <span class='id identifier rubyid_limit_bind'>limit_bind</span> <span class='op'>=</span> <span class='const'><a href="Attribute.html" title="ActiveRecord::Attribute (class)">Attribute</a></span><span class='period'>.</span><span class='id identifier rubyid_with_cast_value'><a href="Attribute.html#with_cast_value-class_method" title="ActiveRecord::Attribute.with_cast_value (method)">with_cast_value</a></span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LIMIT</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span><span class='comma'>,</span>
      <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_sanitize_limit'>sanitize_limit</span><span class='lparen'>(</span><span class='id identifier rubyid_limit_value'>limit_value</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'><a href="Type.html" title="ActiveRecord::Type (module)">Type</a></span><span class='period'>.</span><span class='id identifier rubyid_default_value'><a href="Type.html#default_value-class_method" title="ActiveRecord::Type.default_value (method)">default_value</a></span><span class='comma'>,</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_offset_value'>offset_value</span>
    <span class='id identifier rubyid_offset_bind'>offset_bind</span> <span class='op'>=</span> <span class='const'><a href="Attribute.html" title="ActiveRecord::Attribute (class)">Attribute</a></span><span class='period'>.</span><span class='id identifier rubyid_with_cast_value'><a href="Attribute.html#with_cast_value-class_method" title="ActiveRecord::Attribute.with_cast_value (method)">with_cast_value</a></span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OFFSET</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span><span class='comma'>,</span>
      <span class='id identifier rubyid_offset_value'>offset_value</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>
      <span class='const'><a href="Type.html" title="ActiveRecord::Type (module)">Type</a></span><span class='period'>.</span><span class='id identifier rubyid_default_value'><a href="Type.html#default_value-class_method" title="ActiveRecord::Type.default_value (method)">default_value</a></span><span class='comma'>,</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_combine_bind_parameters'>combine_bind_parameters</span><span class='lparen'>(</span>
    <span class='label'>from_clause:</span> <span class='id identifier rubyid_from_clause'>from_clause</span><span class='period'>.</span><span class='id identifier rubyid_binds'>binds</span><span class='comma'>,</span>
    <span class='label'>join_clause:</span> <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_bind_values'>bind_values</span><span class='comma'>,</span>
    <span class='label'>where_clause:</span> <span class='id identifier rubyid_where_clause'>where_clause</span><span class='period'>.</span><span class='id identifier rubyid_binds'>binds</span><span class='comma'>,</span>
    <span class='label'>having_clause:</span> <span class='id identifier rubyid_having_clause'>having_clause</span><span class='period'>.</span><span class='id identifier rubyid_binds'>binds</span><span class='comma'>,</span>
    <span class='label'>limit:</span> <span class='id identifier rubyid_limit_bind'>limit_bind</span><span class='comma'>,</span>
    <span class='label'>offset:</span> <span class='id identifier rubyid_offset_bind'>offset_bind</span><span class='comma'>,</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_arel-instance_method">
  <h3 class='signature priv'>
    #<strong>build_arel</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L939-L960'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 939</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_arel'>build_arel</span>
  <span class='id identifier rubyid_arel'>arel</span> <span class='op'>=</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>SelectManager</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_build_joins'>build_joins</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_joins_values'>joins_values</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_joins_values'>joins_values</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_build_left_outer_joins'>build_left_outer_joins</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_left_outer_joins_values'>left_outer_joins_values</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_left_outer_joins_values'>left_outer_joins_values</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_where_clause'>where_clause</span><span class='period'>.</span><span class='id identifier rubyid_ast'>ast</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_where_clause'>where_clause</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_having'>having</span><span class='lparen'>(</span><span class='id identifier rubyid_having_clause'>having_clause</span><span class='period'>.</span><span class='id identifier rubyid_ast'>ast</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_having_clause'>having_clause</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_take'>take</span><span class='lparen'>(</span><span class='const'>Arel</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>BindParam</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_limit_value'>limit_value</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='const'>Arel</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>BindParam</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_offset_value'>offset_value</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_arel_columns'>arel_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_group_values'>group_values</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_group_values'>group_values</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_build_order'>build_order</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_build_select'>build_select</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span><span class='lparen'>(</span><span class='id identifier rubyid_distinct_value'>distinct_value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_build_from'>build_from</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_from_clause'>from_clause</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_lock'>lock</span><span class='lparen'>(</span><span class='id identifier rubyid_lock_value'>lock_value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_lock_value'>lock_value</span>

  <span class='id identifier rubyid_arel'>arel</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_from-instance_method">
  <h3 class='signature priv'>
    #<strong>build_from</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L962-L972'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


962
963
964
965
966
967
968
969
970
971
972</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 962</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_from'>build_from</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_from_clause'>from_clause</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_from_clause'>from_clause</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_opts'>opts</span>
  <span class='kw'>when</span> <span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>subquery</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_as'>as</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_opts'>opts</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_join_query-instance_method">
  <h3 class='signature priv'>
    #<strong>build_join_query</strong>(manager, buckets, join_type)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1006-L1032'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1006</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_join_query'>build_join_query</span><span class='lparen'>(</span><span class='id identifier rubyid_manager'>manager</span><span class='comma'>,</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='comma'>,</span> <span class='id identifier rubyid_join_type'>join_type</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_buckets'>buckets</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_association_joins'>association_joins</span>         <span class='op'>=</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_association_join'>association_join</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_stashed_association_joins'>stashed_association_joins</span> <span class='op'>=</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_stashed_join'>stashed_join</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_join_nodes'>join_nodes</span>                <span class='op'>=</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_join_node'>join_node</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='id identifier rubyid_string_joins'>string_joins</span>              <span class='op'>=</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_string_join'>string_join</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_strip'>strip</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>

  <span class='id identifier rubyid_join_list'>join_list</span> <span class='op'>=</span> <span class='id identifier rubyid_join_nodes'>join_nodes</span> <span class='op'>+</span> <span class='id identifier rubyid_convert_join_strings_to_ast'>convert_join_strings_to_ast</span><span class='lparen'>(</span><span class='id identifier rubyid_manager'>manager</span><span class='comma'>,</span> <span class='id identifier rubyid_string_joins'>string_joins</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_join_dependency'>join_dependency</span> <span class='op'>=</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Associations.html" title="ActiveRecord::Associations (module)">Associations</a></span><span class='op'>::</span><span class='const'><a href="Associations/JoinDependency.html" title="ActiveRecord::Associations::JoinDependency (class)">JoinDependency</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Associations/JoinDependency.html#new-class_method" title="ActiveRecord::Associations::JoinDependency.new (method)">new</a></span><span class='lparen'>(</span>
    <span class='ivar'>@klass</span><span class='comma'>,</span>
    <span class='id identifier rubyid_association_joins'>association_joins</span><span class='comma'>,</span>
    <span class='id identifier rubyid_join_list'>join_list</span>
  <span class='rparen'>)</span>

  <span class='id identifier rubyid_join_infos'>join_infos</span> <span class='op'>=</span> <span class='id identifier rubyid_join_dependency'>join_dependency</span><span class='period'>.</span><span class='id identifier rubyid_join_constraints'>join_constraints</span> <span class='id identifier rubyid_stashed_association_joins'>stashed_association_joins</span><span class='comma'>,</span> <span class='id identifier rubyid_join_type'>join_type</span>

  <span class='id identifier rubyid_join_infos'>join_infos</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_info'>info</span><span class='op'>|</span>
    <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_join'>join</span><span class='op'>|</span> <span class='id identifier rubyid_manager'>manager</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_join'>join</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_manager'>manager</span><span class='period'>.</span><span class='id identifier rubyid_bind_values'>bind_values</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_info'>info</span><span class='period'>.</span><span class='id identifier rubyid_binds'>binds</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_manager'>manager</span><span class='period'>.</span><span class='id identifier rubyid_join_sources'>join_sources</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_join_list'>join_list</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_manager'>manager</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_joins-instance_method">
  <h3 class='signature priv'>
    #<strong>build_joins</strong>(manager, joins)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L987-L1004'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 987</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_joins'>build_joins</span><span class='lparen'>(</span><span class='id identifier rubyid_manager'>manager</span><span class='comma'>,</span> <span class='id identifier rubyid_joins'>joins</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_buckets'>buckets</span> <span class='op'>=</span> <span class='id identifier rubyid_joins'>joins</span><span class='period'>.</span><span class='id identifier rubyid_group_by'>group_by</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_join'>join</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_join'>join</span>
    <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_string_join'>string_join</span>
    <span class='kw'>when</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='comma'>,</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span><span class='comma'>,</span> <span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_association_join'>association_join</span>
    <span class='kw'>when</span> <span class='const'><a href="../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="Associations.html" title="ActiveRecord::Associations (module)">Associations</a></span><span class='op'>::</span><span class='const'><a href="Associations/JoinDependency.html" title="ActiveRecord::Associations::JoinDependency (class)">JoinDependency</a></span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_stashed_join'>stashed_join</span>
    <span class='kw'>when</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>Join</span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_join_node'>join_node</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown class: %s</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='id identifier rubyid_join'>join</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_build_join_query'>build_join_query</span><span class='lparen'>(</span><span class='id identifier rubyid_manager'>manager</span><span class='comma'>,</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='comma'>,</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>InnerJoin</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_left_outer_joins-instance_method">
  <h3 class='signature priv'>
    #<strong>build_left_outer_joins</strong>(manager, outer_joins)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L974-L985'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


974
975
976
977
978
979
980
981
982
983
984
985</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 974</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_left_outer_joins'>build_left_outer_joins</span><span class='lparen'>(</span><span class='id identifier rubyid_manager'>manager</span><span class='comma'>,</span> <span class='id identifier rubyid_outer_joins'>outer_joins</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_buckets'>buckets</span> <span class='op'>=</span> <span class='id identifier rubyid_outer_joins'>outer_joins</span><span class='period'>.</span><span class='id identifier rubyid_group_by'>group_by</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_join'>join</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_join'>join</span>
    <span class='kw'>when</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='comma'>,</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span><span class='comma'>,</span> <span class='const'><a href="../Array.html" title="Array (class)">Array</a></span>
      <span class='symbeg'>:</span><span class='id identifier rubyid_association_join'>association_join</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>only Hash, Symbol and Array are allowed</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_build_join_query'>build_join_query</span><span class='lparen'>(</span><span class='id identifier rubyid_manager'>manager</span><span class='comma'>,</span> <span class='id identifier rubyid_buckets'>buckets</span><span class='comma'>,</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>OuterJoin</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_order-instance_method">
  <h3 class='signature priv'>
    #<strong>build_order</strong>(arel)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1095-L1100'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1095
1096
1097
1098
1099
1100</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1095</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_order'>build_order</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_orders'>orders</span> <span class='op'>=</span> <span class='id identifier rubyid_order_values'>order_values</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='id identifier rubyid_orders'>orders</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_orders'>orders</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_orders'>orders</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_select-instance_method">
  <h3 class='signature priv'>
    #<strong>build_select</strong>(arel)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1041-L1047'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1041
1042
1043
1044
1045
1046
1047</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1041</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_select'>build_select</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_select_values'>select_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_arel_columns'>arel_columns</span><span class='lparen'>(</span><span class='id identifier rubyid_select_values'>select_values</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='ivar'>@klass</span><span class='period'>.</span><span class='id identifier rubyid_arel_table'>arel_table</span><span class='lbracket'>[</span><span class='const'>Arel</span><span class='period'>.</span><span class='id identifier rubyid_star'>star</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="check_if_method_has_arguments!-instance_method">
  <h3 class='signature priv'>
    #<strong>check_if_method_has_arguments!</strong>(method_name, args)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Checks to make sure that the arguments are not blank. Note that if some
blank-like object were initially passed into the query method, then this
method will not raise an error.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='rparen'>)</span>   <span class='comment'># raises an error
</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='comment'># does not raise an error</span></code></pre>

<p>This particular method should be called with a method_name and the args
passed into that method as an input. For example:</p>

<p>def references(*args)</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>references</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='comment'>#...</span></code></pre>

<p>end</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1157-L1161'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1157
1158
1159
1160
1161</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1157</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The method .</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method_name'>method_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>() must contain arguments.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="convert_join_strings_to_ast-instance_method">
  <h3 class='signature priv'>
    #<strong>convert_join_strings_to_ast</strong>(table, joins)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1034-L1039'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1034
1035
1036
1037
1038
1039</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1034</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_convert_join_strings_to_ast'>convert_join_strings_to_ast</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='comma'>,</span> <span class='id identifier rubyid_joins'>joins</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_joins'>joins</span>
    <span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
    <span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rparen'>)</span>
    <span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_join'>join</span><span class='op'>|</span> <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_create_string_join'>create_string_join</span><span class='lparen'>(</span><span class='const'>Arel</span><span class='period'>.</span><span class='id identifier rubyid_sql'>sql</span><span class='lparen'>(</span><span class='id identifier rubyid_join'>join</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_with-instance_method">
  <h3 class='signature '>
    #<strong>create_with</strong>(value)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets attributes to be used when creating new records from a relation
object.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Oscar</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &#39;Oscar&#39;
</span>
<span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DHH</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &#39;DHH&#39;</span></code></pre>

<p>You can pass <code>nil</code> to <code>#create_with</code> to reset attributes:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'># =&gt; &#39;Oscar&#39;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L791-L793'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


791
792
793</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 791</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_with'>create_with</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_create_with!'>create_with!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_with!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>create_with!</strong>(value)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L795-L804'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


795
796
797
798
799
800
801
802
803
804</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 795</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_with!'>create_with!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_sanitize_forbidden_attributes'>sanitize_forbidden_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_with_value'>create_with_value</span> <span class='op'>=</span> <span class='id identifier rubyid_create_with_value'>create_with_value</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_with_value'>create_with_value</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="default_value_for-instance_method">
  <h3 class='signature priv'>
    #<strong>default_value_for</strong>(name)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1175-L1192'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1175</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_default_value_for'>default_value_for</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_create_with'>create_with</span>
    <span class='const'><a href="#FROZEN_EMPTY_HASH-constant" title="ActiveRecord::QueryMethods::FROZEN_EMPTY_HASH (constant)">FROZEN_EMPTY_HASH</a></span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_readonly'>readonly</span>
    <span class='kw'>false</span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_where'>where</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_having'>having</span>
    <span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation/WhereClause.html" title="ActiveRecord::Relation::WhereClause (class)">WhereClause</a></span><span class='period'>.</span><span class='id identifier rubyid_empty'><a href="Relation/WhereClause.html#empty-class_method" title="ActiveRecord::Relation::WhereClause.empty (method)">empty</a></span>
  <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_from'>from</span>
    <span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation/FromClause.html" title="ActiveRecord::Relation::FromClause (class)">FromClause</a></span><span class='period'>.</span><span class='id identifier rubyid_empty'><a href="Relation/FromClause.html#empty-class_method" title="ActiveRecord::Relation::FromClause.empty (method)">empty</a></span>
  <span class='kw'>when</span> <span class='op'>*</span><span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation.html#MULTI_VALUE_METHODS-constant" title="ActiveRecord::Relation::MULTI_VALUE_METHODS (constant)">MULTI_VALUE_METHODS</a></span>
    <span class='const'><a href="#FROZEN_EMPTY_ARRAY-constant" title="ActiveRecord::QueryMethods::FROZEN_EMPTY_ARRAY (constant)">FROZEN_EMPTY_ARRAY</a></span>
  <span class='kw'>when</span> <span class='op'>*</span><span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation.html#SINGLE_VALUE_METHODS-constant" title="ActiveRecord::Relation::SINGLE_VALUE_METHODS (constant)">SINGLE_VALUE_METHODS</a></span>
    <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown relation value </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="distinct-instance_method">
  <h3 class='signature '>
    #<strong>distinct</strong>(value = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specifies whether the records should be unique or not. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
<span class='comment'># Might return two records with the same name
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span>
<span class='comment'># Returns 1 record per distinct name
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
<span class='comment'># You can also remove the uniqueness</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L838-L840'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


838
839
840</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 838</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_distinct'>distinct</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_distinct!'>distinct!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="distinct!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>distinct!</strong>(value = true)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Like <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a>, but modifies relation in place.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L843-L846'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


843
844
845
846</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 843</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_distinct!'>distinct!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_distinct_value'>distinct_value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="does_not_support_reverse?-instance_method">
  <h3 class='signature priv'>
    #<strong>does_not_support_reverse?</strong>(order)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1088-L1093'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1088
1089
1090
1091
1092
1093</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1088</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_does_not_support_reverse?'>does_not_support_reverse?</span><span class='lparen'>(</span><span class='id identifier rubyid_order'>order</span><span class='rparen'>)</span>
  <span class='comment'># Uses SQL function with multiple arguments.
</span>  <span class='lparen'>(</span><span class='id identifier rubyid_order'>order</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_order'>order</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_section'>section</span><span class='op'>|</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='id identifier rubyid_section'>section</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='rparen'>)</span> <span class='op'>||</span>
    <span class='comment'># Uses &quot;nulls first&quot; like construction.
</span>    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>nulls (first|last)\Z</span><span class='regexp_end'>/i</span></span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='id identifier rubyid_order'>order</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="eager_load-instance_method">
  <h3 class='signature '>
    #<strong>eager_load</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Forces eager loading by performing a LEFT OUTER JOIN on <code>args</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_eager_load'>eager_load</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.&quot;id&quot; AS t0_r0, &quot;users&quot;.&quot;name&quot; AS t0_r1, ...
</span><span class='comment'># FROM &quot;users&quot; LEFT OUTER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; =
</span><span class='comment'># &quot;users&quot;.&quot;id&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L156-L159'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


156
157
158
159</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 156</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_eager_load'>eager_load</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_eager_load'>eager_load</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_eager_load!'>eager_load!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="eager_load!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>eager_load!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L161-L164'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


161
162
163
164</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 161</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_eager_load!'>eager_load!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_eager_load_values'>eager_load_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="extending-instance_method">
  <h3 class='signature '>
    #<strong>extending</strong>(*modules, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Used to extend a scope with additional methods, either through a module or
through a block provided.</p>

<p>The object returned is a relation, which can be further extended.</p>

<h3 id="label-Using+a+module">Using a module</h3>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>Pagination</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_number'>number</span><span class='rparen'>)</span>
    <span class='comment'># pagination code goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='const'>Pagination</span><span class='rparen'>)</span>
<span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_page'>page</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>

<p>You can also pass a list of modules:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='const'>Pagination</span><span class='comma'>,</span> <span class='const'>SomethingElse</span><span class='rparen'>)</span></code></pre>

<h3 id="label-Using+a+block">Using a block</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span> <span class='kw'>do</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_number'>number</span><span class='rparen'>)</span>
    <span class='comment'># pagination code goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_page'>page</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_page'>page</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>

<p>You can also use a block and a module list:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='const'>Pagination</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_per_page'>per_page</span><span class='lparen'>(</span><span class='id identifier rubyid_number'>number</span><span class='rparen'>)</span>
    <span class='comment'># pagination code goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L884-L890'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


884
885
886
887
888
889
890</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 884</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_extending'>extending</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_modules'>modules</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_modules'>modules</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>||</span> <span class='id identifier rubyid_block'>block</span>
    <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_extending!'>extending!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_modules'>modules</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="extending!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>extending!</strong>(*modules, &amp;block)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L892-L900'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


892
893
894
895
896
897
898
899
900</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 892</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_extending!'>extending!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_modules'>modules</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_modules'>modules</span> <span class='op'>&lt;&lt;</span> <span class='const'><a href="../Module.html" title="Module (class)">Module</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_modules'>modules</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_extending_values'>extending_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_modules'>modules</span>
  <span class='id identifier rubyid_extend'>extend</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_extending_values'>extending_values</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_extending_values'>extending_values</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="extensions-instance_method">
  <h3 class='signature '>
    #<strong>extensions</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L102-L102'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


102</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 102</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_extensions'>extensions</span> <span class='id identifier rubyid_extending_values'>extending_values</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="from-instance_method">
  <h3 class='signature '>
    #<strong>from</strong>(value, subquery_name = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specifies table from which the records will be fetched. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>posts</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT title FROM posts</span></code></pre>

<p>Can accept other relation objects. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_approved'>approved</span><span class='rparen'>)</span>
<span class='comment'># SELECT title FROM (SELECT * FROM topics WHERE approved = &#39;t&#39;) subquery
</span>
<span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a.title</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='const'>Topic</span><span class='period'>.</span><span class='id identifier rubyid_approved'>approved</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span><span class='rparen'>)</span>
<span class='comment'># SELECT a.title FROM (SELECT * FROM topics WHERE approved = &#39;t&#39;) a</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L819-L821'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


819
820
821</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 819</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_from'>from</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_subquery_name'>subquery_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_from!'>from!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_subquery_name'>subquery_name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="from!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>from!</strong>(value, subquery_name = nil)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L823-L826'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


823
824
825
826</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 823</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_from!'>from!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_subquery_name'>subquery_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_from_clause'>from_clause</span> <span class='op'>=</span> <span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation/FromClause.html" title="ActiveRecord::Relation::FromClause (class)">FromClause</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Relation/FromClause.html#new-class_method" title="ActiveRecord::Relation::FromClause.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_subquery_name'>subquery_name</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_value-instance_method">
  <h3 class='signature nodoc'>
    #<strong>get_value</strong>(name)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a relation value with a given name</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L922-L924'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


922
923
924</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 922</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_value'>get_value</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_default_value_for'>default_value_for</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="group-instance_method">
  <h3 class='signature '>
    #<strong>group</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allows to specify a group attribute:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; GROUP BY name</span></code></pre>

<p>Returns an array with distinct records based on the <code>group</code>
attribute:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;User id: 1, name: &quot;Oscar&quot;&gt;, #&lt;User id: 2, name: &quot;Oscar&quot;&gt;, #&lt;User id: 3, name: &quot;Foo&quot;&gt;]
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;User id: 3, name: &quot;Foo&quot;, ...&gt;, #&lt;User id: 2, name: &quot;Oscar&quot;, ...&gt;]
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name AS grouped_name, age</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;User id: 3, name: &quot;Foo&quot;, age: 21, ...&gt;, #&lt;User id: 2, name: &quot;Oscar&quot;, age: 21, ...&gt;, #&lt;User id: 5, name: &quot;Foo&quot;, age: 23, ...&gt;]</span></code></pre>

<p>Passing in an array of attributes to group by is also supported.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_first_name'>first_name</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_first_name'>first_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;User id: 1, first_name: &quot;Bill&quot;&gt;, #&lt;User id: 2, first_name: &quot;Earl&quot;&gt;, #&lt;User id: 3, first_name: &quot;Beto&quot;&gt;]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L284-L287'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


284
285
286
287</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 284</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_group'>group</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_group!'>group!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="group!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>group!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L289-L294'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


289
290
291
292
293
294</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 289</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_group!'>group!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_group_values'>group_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="having-instance_method">
  <h3 class='signature '>
    #<strong>having</strong>(opts, *rest)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allows to specify a HAVING clause. Note that you can&#39;t use HAVING
without also specifying a GROUP clause.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Order</span><span class='period'>.</span><span class='id identifier rubyid_having'>having</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SUM(price) &gt; 30</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_group'>group</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L668-L670'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


668
669
670</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 668</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_having'>having</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>?</span> <span class='kw'>self</span> <span class='op'>:</span> <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_having!'>having!</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="having!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>having!</strong>(opts, *rest)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L672-L678'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


672
673
674
675
676
677
678</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 672</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_having!'>having!</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_sanitize_forbidden_attributes'>sanitize_forbidden_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_references!'>references!</span><span class='lparen'>(</span><span class='const'><a href="PredicateBuilder.html" title="ActiveRecord::PredicateBuilder (class)">PredicateBuilder</a></span><span class='period'>.</span><span class='id identifier rubyid_references'><a href="PredicateBuilder.html#references-class_method" title="ActiveRecord::PredicateBuilder.references (method)">references</a></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span> <span class='op'>===</span> <span class='id identifier rubyid_opts'>opts</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_having_clause'>having_clause</span> <span class='op'>+=</span> <span class='id identifier rubyid_having_clause_factory'>having_clause_factory</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="having_clause_factory-instance_method">
  <h3 class='signature priv'>
    #<strong>having_clause_factory</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#where_clause_factory-instance_method" title="ActiveRecord::QueryMethods#where_clause_factory (method)">#where_clause_factory</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1173-L1173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1173</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1173</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='id identifier rubyid_having_clause_factory'>having_clause_factory</span> <span class='id identifier rubyid_where_clause_factory'>where_clause_factory</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="includes-instance_method">
  <h3 class='signature '>
    #<strong>includes</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specify relationships to be included in the result set. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span><span class='rparen'>)</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_user'>user</span><span class='op'>|</span>
  <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_city'>city</span>
<span class='kw'>end</span></code></pre>

<p>allows you to access the <code>address</code> attribute of the <code>User</code> model without
firing an additional query. This will often result in a performance
improvement over a simple join.</p>

<p>You can also specify multiple relationships, like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_friends'>friends</span><span class='rparen'>)</span></code></pre>

<p>Loading nested relationships is possible using a Hash:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='label'>friends:</span> <span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_address'>address</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_followers'>followers</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>

<h3 id="label-conditions">conditions</h3>

<p>If you want to add conditions to your included models you&#39;ll have to
explicitly reference them. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>posts.name = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>

<p>Will throw an error, but this will work:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>posts.name = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>example</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span></code></pre>

<p>Note that <code>#includes</code> works with association names while <a href="#references-instance_method" title="ActiveRecord::QueryMethods#references (method)">#references</a>
needs the actual table name.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L137-L140'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


137
138
139
140</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 137</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_includes'>includes</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_includes!'>includes!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="includes!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>includes!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L142-L148'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


142
143
144
145
146
147
148</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 142</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_includes!'>includes!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_includes_values'>includes_values</span> <span class='op'>|=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="joins-instance_method">
  <h3 class='signature '>
    #<strong>joins</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Performs a joins on <code>args</code>. The given symbol(s) should match the name of
the association(s).</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.*
</span><span class='comment'># FROM &quot;users&quot;
</span><span class='comment'># INNER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; = &quot;users&quot;.&quot;id&quot;</span></code></pre>

<p>Multiple joins:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_account'>account</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.*
</span><span class='comment'># FROM &quot;users&quot;
</span><span class='comment'># INNER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; = &quot;users&quot;.&quot;id&quot;
</span><span class='comment'># INNER JOIN &quot;accounts&quot; ON &quot;accounts&quot;.&quot;id&quot; = &quot;users&quot;.&quot;account_id&quot;</span></code></pre>

<p>Nested joins:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='label'>posts:</span> <span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_comments'>comments</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.*
</span><span class='comment'># FROM &quot;users&quot;
</span><span class='comment'># INNER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; = &quot;users&quot;.&quot;id&quot;
</span><span class='comment'># INNER JOIN &quot;comments&quot; &quot;comments_posts&quot;
</span><span class='comment'>#   ON &quot;comments_posts&quot;.&quot;post_id&quot; = &quot;posts&quot;.&quot;id&quot;</span></code></pre>

<p>You can use strings in order to customize your joins:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LEFT JOIN bookmarks ON bookmarks.bookmarkable_type = &#39;Post&#39; AND bookmarks.user_id = users.id</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; LEFT JOIN bookmarks ON bookmarks.bookmarkable_type = &#39;Post&#39; AND bookmarks.user_id = users.id</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L448-L451'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


448
449
450
451</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 448</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_joins'>joins</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_joins!'>joins!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="joins!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>joins!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L453-L458'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


453
454
455
456
457
458</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 453</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_joins!'>joins!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_compact!'>compact!</span>
  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_joins_values'>joins_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="left_joins-instance_method">
  <h3 class='signature '>
    #<strong>left_joins</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#left_outer_joins-instance_method" title="ActiveRecord::QueryMethods#left_outer_joins (method)">#left_outer_joins</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L473-L473'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


473</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 473</span></pre>
<pre class='code ruby'>

<span class='kw'>alias</span> <span class='symbeg'>:</span><span class='id identifier rubyid_left_joins'>left_joins</span> <span class='symbeg'>:</span><span class='id identifier rubyid_left_outer_joins'>left_outer_joins</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="left_outer_joins-instance_method">
  <h3 class='signature '>
    #<strong>left_outer_joins</strong>(*args)  
    <span class='aliases'>Also known as: <span class='names'>#left_joins</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Performs a left outer joins on <code>args</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_left_outer_joins'>left_outer_joins</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span>
<span class='comment'>#=&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot; LEFT OUTER JOIN &quot;posts&quot; ON &quot;posts&quot;.&quot;user_id&quot; = &quot;users&quot;.&quot;id&quot;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L465-L472'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


465
466
467
468
469
470
471
472</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 465</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_left_outer_joins'>left_outer_joins</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_left_outer_joins'>left_outer_joins</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_compact!'>compact!</span>
  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>

  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_left_outer_joins!'>left_outer_joins!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="left_outer_joins!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>left_outer_joins!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L475-L478'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


475
476
477
478</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 475</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_left_outer_joins!'>left_outer_joins!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_left_outer_joins_values'>left_outer_joins_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="limit-instance_method">
  <h3 class='signature '>
    #<strong>limit</strong>(value)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specifies a limit for the number of records to retrieve.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span> <span class='comment'># generated SQL has &#39;LIMIT 10&#39;
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='int'>20</span><span class='rparen'>)</span> <span class='comment'># generated SQL has &#39;LIMIT 20&#39;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L685-L687'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


685
686
687</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 685</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_limit!'>limit!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="limit!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>limit!</strong>(value)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L689-L692'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


689
690
691
692</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 689</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_limit!'>limit!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_limit_value'>limit_value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="lock-instance_method">
  <h3 class='signature '>
    #<strong>lock</strong>(locks = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specifies locking settings (default to <code>true</code>). For more information on
locking, please see <a href="Locking.html" title="ActiveRecord::Locking (module)">Locking</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L712-L714'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


712
713
714</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 712</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_lock'>lock</span><span class='lparen'>(</span><span class='id identifier rubyid_locks'>locks</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_lock!'>lock!</span><span class='lparen'>(</span><span class='id identifier rubyid_locks'>locks</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="lock!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>lock!</strong>(locks = true)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L716-L725'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


716
717
718
719
720
721
722
723
724
725</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 716</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_lock!'>lock!</span><span class='lparen'>(</span><span class='id identifier rubyid_locks'>locks</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_locks'>locks</span>
  <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span><span class='comma'>,</span> <span class='const'><a href="../TrueClass.html" title="TrueClass (class)">TrueClass</a></span><span class='comma'>,</span> <span class='const'><a href="../NilClass.html" title="NilClass (class)">NilClass</a></span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_lock_value'>lock_value</span> <span class='op'>=</span> <span class='id identifier rubyid_locks'>locks</span> <span class='op'>||</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_lock_value'>lock_value</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="none-instance_method">
  <h3 class='signature '>
    #<strong>none</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a chainable relation with zero records.</p>

<p>The returned relation implements the Null Object pattern. It is an object
with defined null behavior and always returns an empty array of records
without querying the database.</p>

<p>Any subsequent condition chained to the returned relation will continue
generating an empty relation and will not fire any query to the database.</p>

<p>Used in cases where a method or scope could return zero records but the
result needs to be chainable.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@posts</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='period'>.</span><span class='id identifier rubyid_visible_posts'>visible_posts</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># the visible_posts method is expected to return a chainable Relation
</span>
<span class='kw'>def</span> <span class='id identifier rubyid_visible_posts'>visible_posts</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_role'>role</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Country Manager</span><span class='tstring_end'>&#39;</span></span>
    <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>country:</span> <span class='id identifier rubyid_country'>country</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Reviewer</span><span class='tstring_end'>&#39;</span></span>
    <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_published'>published</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Bad User</span><span class='tstring_end'>&#39;</span></span>
    <span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_none'>none</span> <span class='comment'># It can&#39;t be chained if [] is returned.
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L755-L757'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


755
756
757</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 755</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_none'>none</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_none!'>none!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="none!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>none!</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L759-L761'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


759
760
761</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 759</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_none!'>none!</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_where!'>where!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1=0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_extending!'>extending!</span><span class='lparen'>(</span><span class='const'><a href="NullRelation.html" title="ActiveRecord::NullRelation (module)">NullRelation</a></span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="offset-instance_method">
  <h3 class='signature '>
    #<strong>offset</strong>(value)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Specifies the number of rows to skip before returning rows.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span> <span class='comment'># generated SQL has &quot;OFFSET 10&quot;</span></code></pre>

<p>Should be used with order.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_offset'>offset</span><span class='lparen'>(</span><span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name ASC</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L701-L703'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


701
702
703</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 701</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_offset'>offset</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_offset!'>offset!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="offset!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>offset!</strong>(value)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L705-L708'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


705
706
707
708</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 705</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_offset!'>offset!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_offset_value'>offset_value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="or-instance_method">
  <h3 class='signature '>
    #<strong>or</strong>(other)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a new relation, which is the logical union of this relation and the
one passed as an argument.</p>

<p>The two relations must be structurally compatible: they must be scoping the
same model, and they must differ only by <a href="#where-instance_method" title="ActiveRecord::QueryMethods#where (method)">#where</a> (if no <a href="#group-instance_method" title="ActiveRecord::QueryMethods#group (method)">#group</a> has been
defined) or <a href="#having-instance_method" title="ActiveRecord::QueryMethods#having (method)">#having</a> (if a <a href="#group-instance_method" title="ActiveRecord::QueryMethods#group (method)">#group</a> is present). Neither relation may have
a <a href="#limit-instance_method" title="ActiveRecord::QueryMethods#limit (method)">#limit</a>, <a href="#offset-instance_method" title="ActiveRecord::QueryMethods#offset (method)">#offset</a>, or <a href="#distinct-instance_method" title="ActiveRecord::QueryMethods#distinct (method)">#distinct</a> set.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id = 1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span><span class='lparen'>(</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>author_id = 3</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='comment'># SELECT `posts`.* FROM `posts` WHERE ((id = 1) OR (author_id = 3))</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L643-L649'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


643
644
645
646
647
648
649</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 643</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>or</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You have passed </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> object to #or. Pass an ActiveRecord::Relation object instead.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_or!'>or!</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="or!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>or!</strong>(other)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L651-L662'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


651
652
653
654
655
656
657
658
659
660
661
662</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 651</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_or!'>or!</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_incompatible_values'>incompatible_values</span> <span class='op'>=</span> <span class='id identifier rubyid_structurally_incompatible_values_for_or'>structurally_incompatible_values_for_or</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_incompatible_values'>incompatible_values</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Relation passed to #or must be structurally compatible. Incompatible values: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_incompatible_values'>incompatible_values</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_where_clause'>where_clause</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_where_clause'>where_clause</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_where_clause'>where_clause</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_having_clause'>having_clause</span> <span class='op'>=</span> <span class='id identifier rubyid_having_clause'>having_clause</span><span class='period'>.</span><span class='id identifier rubyid_or'>or</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_having_clause'>having_clause</span><span class='rparen'>)</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="order-instance_method">
  <h3 class='signature '>
    #<strong>order</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allows to specify an order attribute:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY &quot;users&quot;.&quot;name&quot; ASC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='label'>email:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY &quot;users&quot;.&quot;email&quot; DESC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>email:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY &quot;users&quot;.&quot;name&quot; ASC, &quot;users&quot;.&quot;email&quot; DESC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY name
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY name DESC
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name DESC, email</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;users&quot;.* FROM &quot;users&quot; ORDER BY name DESC, email</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L315-L318'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


315
316
317
318</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 315</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_order'>order</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_order!'>order!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="order!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>order!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L320-L325'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


320
321
322
323
324
325</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 320</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_order!'>order!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_preprocess_order_args'>preprocess_order_args</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_order_values'>order_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="preload-instance_method">
  <h3 class='signature '>
    #<strong>preload</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allows preloading of <code>args</code>, in the same way that <a href="#includes-instance_method" title="ActiveRecord::QueryMethods#includes (method)">#includes</a> does:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_preload'>preload</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span>
<span class='comment'># SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;user_id&quot; IN (1, 2, 3)</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L170-L173'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


170
171
172
173</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 170</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_preload'>preload</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_preload'>preload</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_preload!'>preload!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="preload!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>preload!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L175-L178'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


175
176
177
178</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 175</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_preload!'>preload!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_preload_values'>preload_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="preprocess_order_args-instance_method">
  <h3 class='signature priv'>
    #<strong>preprocess_order_args</strong>(order_args)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1115-L1139'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1115</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_preprocess_order_args'>preprocess_order_args</span><span class='lparen'>(</span><span class='id identifier rubyid_order_args'>order_args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_order_args'>order_args</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
    <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_sanitize_sql_for_order'>sanitize_sql_for_order</span><span class='comma'>,</span> <span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_order_args'>order_args</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='id identifier rubyid_validate_order_args'>validate_order_args</span><span class='lparen'>(</span><span class='id identifier rubyid_order_args'>order_args</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_references'>references</span> <span class='op'>=</span> <span class='id identifier rubyid_order_args'>order_args</span><span class='period'>.</span><span class='id identifier rubyid_grep'>grep</span><span class='lparen'>(</span><span class='const'><a href="../String.html" title="String (class)">String</a></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_references'>references</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span> <span class='id identifier rubyid_arg'>arg</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^([a-zA-Z]\w*)\.(\w+)</span><span class='regexp_end'>/</span></span> <span class='op'>&amp;&amp;</span> <span class='backref'>$1</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_compact!'>compact!</span>
  <span class='id identifier rubyid_references!'>references!</span><span class='lparen'>(</span><span class='id identifier rubyid_references'>references</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_references'>references</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>

  <span class='comment'># if a symbol is given we prepend the quoted table name
</span>  <span class='id identifier rubyid_order_args'>order_args</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_arg'>arg</span>
    <span class='kw'>when</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span>
      <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_asc'>asc</span>
    <span class='kw'>when</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span>
      <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_dir'>dir</span><span class='op'>|</span>
        <span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='id identifier rubyid_dir'>dir</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_arg'>arg</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="readonly-instance_method">
  <h3 class='signature '>
    #<strong>readonly</strong>(value = true)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets readonly attributes for the returned relation. If value is true
(default), attempting to update a record will result in an error.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_users'>users</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_readonly'>readonly</span>
<span class='id identifier rubyid_users'>users</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
<span class='comment'>#=&gt; ActiveRecord::ReadOnlyRecord: User is marked as readonly</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L769-L771'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


769
770
771</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 769</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_readonly'>readonly</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_readonly!'>readonly!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="readonly!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>readonly!</strong>(value = true)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L773-L776'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


773
774
775
776</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 773</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_readonly!'>readonly!</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_readonly_value'>readonly_value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="references-instance_method">
  <h3 class='signature '>
    #<strong>references</strong>(*table_names)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Use to indicate that the given <code>table_names</code> are referenced by an SQL
string, and should therefore be JOINed in any query rather than loaded
separately. This method only works in conjunction with <a href="#includes-instance_method" title="ActiveRecord::QueryMethods#includes (method)">#includes</a>. See
<a href="#includes-instance_method" title="ActiveRecord::QueryMethods#includes (method)">#includes</a> for more details.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.name = &#39;foo&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># Doesn&#39;t JOIN the posts table, resulting in an error.
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_includes'>includes</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.name = &#39;foo&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span>
<span class='comment'># Query now knows the string references posts, so adds a JOIN</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L190-L193'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


190
191
192
193</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 190</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_references'>references</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_references'>references</span><span class='comma'>,</span> <span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_references!'>references!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="references!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>references!</strong>(*table_names)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L195-L201'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


195
196
197
198
199
200
201</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 195</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_references!'>references!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_table_names'>table_names</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_table_names'>table_names</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='id identifier rubyid_table_names'>table_names</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_references_values'>references_values</span> <span class='op'>|=</span> <span class='id identifier rubyid_table_names'>table_names</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reorder-instance_method">
  <h3 class='signature '>
    #<strong>reorder</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Replaces any existing order defined on the relation with the specified
order.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># generated SQL has &#39;ORDER BY id ASC&#39;</span></code></pre>

<p>Subsequent calls to order on the same relation will be appended. For
example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>

<p>generates a query with &#39;ORDER BY id ASC, name ASC&#39;.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L336-L339'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


336
337
338
339</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 336</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reorder'>reorder</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_reorder'>reorder</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_reorder!'>reorder!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reorder!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>reorder!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L341-L347'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


341
342
343
344
345
346
347</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 341</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reorder!'>reorder!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_preprocess_order_args'>preprocess_order_args</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reordering_value'>reordering_value</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_order_values'>order_values</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reverse_order-instance_method">
  <h3 class='signature '>
    #<strong>reverse_order</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Reverse the existing order clause on the relation.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name ASC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse_order'>reverse_order</span> <span class='comment'># generated SQL has &#39;ORDER BY name DESC&#39;</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L905-L907'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


905
906
907</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 905</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reverse_order'>reverse_order</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_reverse_order!'>reverse_order!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reverse_order!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>reverse_order!</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L909-L914'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


909
910
911
912
913
914</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 909</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reverse_order!'>reverse_order!</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_orders'>orders</span> <span class='op'>=</span> <span class='id identifier rubyid_order_values'>order_values</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='id identifier rubyid_orders'>orders</span><span class='period'>.</span><span class='id identifier rubyid_reject!'>reject!</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_order_values'>order_values</span> <span class='op'>=</span> <span class='id identifier rubyid_reverse_sql_order'>reverse_sql_order</span><span class='lparen'>(</span><span class='id identifier rubyid_orders'>orders</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="reverse_sql_order-instance_method">
  <h3 class='signature priv'>
    #<strong>reverse_sql_order</strong>(order_query)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1061-L1086'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1061</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_reverse_sql_order'>reverse_sql_order</span><span class='lparen'>(</span><span class='id identifier rubyid_order_query'>order_query</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_order_query'>order_query</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_arel_attribute'>arel_attribute</span><span class='lparen'>(</span><span class='id identifier rubyid_primary_key'>primary_key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_desc'>desc</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_primary_key'>primary_key</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="IrreversibleOrderError.html" title="ActiveRecord::IrreversibleOrderError (class)">IrreversibleOrderError</a></span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Relation has no current order and table has no primary key to be used as default order</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_order_query'>order_query</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_o'>o</span>
    <span class='kw'>when</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>Attribute</span>
      <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_desc'>desc</span>
    <span class='kw'>when</span> <span class='const'>Arel</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>Ordering</span>
      <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
    <span class='kw'>when</span> <span class='const'><a href="../String.html" title="String (class)">String</a></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_does_not_support_reverse?'>does_not_support_reverse?</span><span class='lparen'>(</span><span class='id identifier rubyid_o'>o</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="IrreversibleOrderError.html" title="ActiveRecord::IrreversibleOrderError (class)">IrreversibleOrderError</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Order </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> can not be reversed automatically</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
        <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_strip!'>strip!</span>
        <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\sasc\Z</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> DESC</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\sdesc\Z</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> ASC</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> DESC</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_o'>o</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rewhere-instance_method">
  <h3 class='signature '>
    #<strong>rewhere</strong>(conditions)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Allows you to change a previously set where condition for a given
attribute, instead of appending to that condition.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='comment'># WHERE `trashed` = 1 AND `trashed` = 0
</span>
<span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rewhere'>rewhere</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='comment'># WHERE `trashed` = 0
</span>
<span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>active:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>true</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_rewhere'>rewhere</span><span class='lparen'>(</span><span class='label'>trashed:</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='comment'># WHERE `active` = 1 AND `trashed` = 0</span></code></pre>

<p>This is short-hand for <code>unscope(where:
conditions.keys).where(conditions)</code>. Note that unlike reorder,
we&#39;re only unscoping the named conditions -- not the entire where
statement.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L629-L631'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


629
630
631</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 629</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rewhere'>rewhere</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='label'>where:</span> <span class='id identifier rubyid_conditions'>conditions</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_conditions'>conditions</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="select-instance_method">
  <h3 class='signature '>
    #<strong>select</strong>(*fields)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Works in two unique ways.</p>

<p>First: takes a block so it can be used just like <code>Array#select</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_field'>field</span> <span class='op'>==</span> <span class='id identifier rubyid_value'>value</span> <span class='rbrace'>}</span></code></pre>

<p>This will build an array of objects from the database for the scope,
converting them into an array and iterating through them using
<code>Array#select</code>.</p>

<p>Second: Modifies the SELECT statement for the query so that only certain
fields are retrieved:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;Model id: nil, field: &quot;value&quot;&gt;]</span></code></pre>

<p>Although in the above example it looks as though this method returns an
array, it actually returns a relation object and can have other query
methods appended to it, such as the other methods in
<a href="../top-level-namespace.html" title="Top Level Namespace (root)">::</a>.</p>

<p>The argument to the method can also be an array of fields.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_other_field'>other_field</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_and_one_more'>and_one_more</span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;Model id: nil, field: &quot;value&quot;, other_field: &quot;value&quot;, and_one_more: &quot;value&quot;&gt;]</span></code></pre>

<p>You can also use one or more strings, which will be used unchanged as
SELECT fields.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>field AS field_one</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>other_field AS field_two</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; [#&lt;Model id: nil, field: &quot;value&quot;, other_field: &quot;value&quot;&gt;]</span></code></pre>

<p>If an alias was specified, it will be accessible from the resulting
objects:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>field AS field_one</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_field_one'>field_one</span>
<span class='comment'># =&gt; &quot;value&quot;</span></code></pre>

<p>Accessing attributes of an object that do not have fields retrieved by a
select except <code>id</code> will throw <a href="../ActiveModel/MissingAttributeError.html" title="ActiveModel::MissingAttributeError (class)">::ActiveModel::MissingAttributeError</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_field'>field</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_other_field'>other_field</span>
<span class='comment'># =&gt; ActiveModel::MissingAttributeError: missing attribute: other_field</span></code></pre>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>ArgumentError</code>)</span>
  </li>
</ul>

</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L242-L253'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


242
243
244
245
246
247
248
249
250
251
252
253</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 242</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>`select&#39; with block doesn&#39;t take arguments.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Call this with at least one field</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid__select!'>_select!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="set_value-instance_method">
  <h3 class='signature nodoc'>
    #<strong>set_value</strong>(name, value)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets the relation value with the given name</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L927-L930'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


927
928
929
930</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 927</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_set_value'>set_value</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_assert_mutability!'>assert_mutability!</span>
  <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="structurally_incompatible_values_for_or-instance_method">
  <h3 class='signature priv'>
    #<strong>structurally_incompatible_values_for_or</strong>(other)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1164-L1168'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1164
1165
1166
1167
1168</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1164</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_structurally_incompatible_values_for_or'>structurally_incompatible_values_for_or</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='const'><a href="#STRUCTURAL_OR_METHODS-constant" title="ActiveRecord::QueryMethods::STRUCTURAL_OR_METHODS (constant)">STRUCTURAL_OR_METHODS</a></span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_method'>method</span><span class='op'>|</span>
    <span class='id identifier rubyid_get_value'>get_value</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_get_value'>get_value</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unscope-instance_method">
  <h3 class='signature '>
    #<strong>unscope</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Removes an unwanted relation that is already defined on a chain of
relations. This is useful when passing around chains of relations and would
like to modify the relations without reconstructing the entire chain.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_order'>order</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span></code></pre>

<p>The method arguments are symbols which correspond to the names of the
methods which should be unscoped. The valid arguments are given in
<a href="#VALID_UNSCOPING_VALUES-constant" title="ActiveRecord::QueryMethods::VALID_UNSCOPING_VALUES (constant)">VALID_UNSCOPING_VALUES</a>. The method can also
be called with multiple arguments. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email DESC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='period'>.</span><span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_order'>order</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_select'>select</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_where'>where</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span></code></pre>

<p>One can additionally pass a hash as an argument to unscope specific
<code>:where</code> values. This is done by passing a hash with a single
key-value pair. The key should be <code>:where</code> and the value should
be the where value to unscope. For example:</p>

<pre class="code ruby"><code class="ruby">User.where(name: &quot;John&quot;, active: true).unscope(where: :name)
    == User.where(active: true)</code></pre>

<p>This method is similar to <code>#except</code>, but unlike <code>#except</code>, it persists
across merges:</p>

<pre class="code ruby"><code class="ruby">User.order(&#39;email&#39;).merge(User.except(:order))
    == User.order(&#39;email&#39;)

User.order(&#39;email&#39;).merge(User.unscope(:order))
    == User.all</code></pre>

<p>This means it can be used in association definitions:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_has_many'>has_many</span> <span class='symbeg'>:</span><span class='id identifier rubyid_comments'>comments</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='label'>where:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_trashed'>trashed</span><span class='rparen'>)</span> <span class='rbrace'>}</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L386-L389'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


386
387
388
389</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 386</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unscope'>unscope</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_if_method_has_arguments!'>check_if_method_has_arguments!</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_unscope'>unscope</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_unscope!'>unscope!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="unscope!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>unscope!</strong>(*args)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L391-L417'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 391</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_unscope!'>unscope!</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_unscope_values'>unscope_values</span> <span class='op'>+=</span> <span class='id identifier rubyid_args'>args</span>

  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_scope'>scope</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_scope'>scope</span>
    <span class='kw'>when</span> <span class='const'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='const'><a href="#VALID_UNSCOPING_VALUES-constant" title="ActiveRecord::QueryMethods::VALID_UNSCOPING_VALUES (constant)">VALID_UNSCOPING_VALUES</a></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_scope'>scope</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Called unscope() with invalid unscoping argument &#39;:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scope'>scope</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;. Valid arguments are :</span><span class='embexpr_beg'>#{</span><span class='const'><a href="#VALID_UNSCOPING_VALUES-constant" title="ActiveRecord::QueryMethods::VALID_UNSCOPING_VALUES (constant)">VALID_UNSCOPING_VALUES</a></span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, :</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_set_value'>set_value</span><span class='lparen'>(</span><span class='id identifier rubyid_scope'>scope</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span>
      <span class='id identifier rubyid_scope'>scope</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_target_value'>target_value</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>!=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_where'>where</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hash arguments in .unscope(*args) must have :where as the key.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_target_values'>target_values</span> <span class='op'>=</span> <span class='const'><a href="../Array.html" title="Array (class)">Array</a></span><span class='lparen'>(</span><span class='id identifier rubyid_target_value'>target_value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_where_clause'>where_clause</span> <span class='op'>=</span> <span class='id identifier rubyid_where_clause'>where_clause</span><span class='period'>.</span><span class='id identifier rubyid_except'>except</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_target_values'>target_values</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unrecognized scoping: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Use .unscope(where: :attribute_name) or .unscope(:order), for example.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_order_args-instance_method">
  <h3 class='signature priv'>
    #<strong>validate_order_args</strong>(args)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1105-L1113'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1105
1106
1107
1108
1109
1110
1111
1112
1113</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1105</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_order_args'>validate_order_args</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__key'>_key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Direction \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot; is invalid. Valid </span><span class='tstring_end'>&quot;</span></span> \
                           <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>directions are: </span><span class='embexpr_beg'>#{</span><span class='const'><a href="#VALID_DIRECTIONS-constant" title="ActiveRecord::QueryMethods::VALID_DIRECTIONS (constant)">VALID_DIRECTIONS</a></span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'><a href="#VALID_DIRECTIONS-constant" title="ActiveRecord::QueryMethods::VALID_DIRECTIONS (constant)">VALID_DIRECTIONS</a></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="where-instance_method">
  <h3 class='signature '>
    #<strong>where</strong>(opts = :chain, *rest)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a new relation, which is the result of filtering the current
relation according to the conditions in the arguments.</p>

<p><code>#where</code> accepts conditions in one of several formats. In the examples
below, the resulting SQL is given as an illustration; the actual query
generated may be different depending on the database adapter.</p>

<h3 id="label-string">string</h3>

<p>A single string, without additional arguments, is passed to the query
constructor as an SQL fragment, and used in the where clause of the query.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>orders_count = &#39;2&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT * from clients where orders_count = &#39;2&#39;;</span></code></pre>

<p>Note that building your own string from user input may expose your
application to injection attacks if not done properly. As an alternative,
it is recommended to use one of the following methods.</p>

<h3 id="label-array">array</h3>

<p>If an array is passed, then the first element of the array is treated as a
template, and the remaining elements are inserted into the template to
generate the condition. Active Record takes care of building the query to
avoid injection attacks, and will convert from the ruby type to the
database type where needed. Elements are inserted into the string in the
order in which they appear.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = ? and email = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;</span></code></pre>

<p>Alternatively, you can use named placeholders in the template, and pass a
hash as the second element of the array. The names in the template are
replaced with the corresponding values from the hash.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = :name and email = :email</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;</span></code></pre>

<p>This can make for more readable code in complex queries.</p>

<p>Lastly, you can use sprintf-style % escapes in the template. This works
slightly differently than the previous methods; you are responsible for
ensuring that the values in the template are properly quoted. The values
are passed to the connector for quoting, but the caller is responsible for
ensuring they are enclosed in quotes in the resulting SQL. After quoting,
the values are inserted using the same escapes as the Ruby core method
<code>Kernel.sprintf</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = &#39;%s&#39; and email = &#39;%s&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;</span></code></pre>

<p>If <code>#where</code> is called with multiple arguments, these are treated as if they
were passed as the elements of a single array.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name = :name and email = :email</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;;</span></code></pre>

<p>When using strings to specify conditions, you can use any operator
available from the database. While this provides the most flexibility, you
can also unintentionally introduce dependencies on the underlying database.
If your code is intended for general consumption, test with multiple
database backends.</p>

<h3 id="label-hash">hash</h3>

<p><code>#where</code> will also accept a hash condition, in which the keys are fields
and the values are values to be searched for.</p>

<p>Fields can be symbols or strings. Values can be single values, arrays, or
ranges.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Joe</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>joe@example.com</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name = &#39;Joe&#39; AND email = &#39;joe@example.com&#39;
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>name:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alice</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bob</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name IN (&#39;Alice&#39;, &#39;Bob&#39;)
</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>created_at:</span> <span class='lparen'>(</span><span class='const'><a href="../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_midnight'>midnight</span> <span class='op'>-</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span><span class='op'>..</span><span class='const'><a href="../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_midnight'>midnight</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE (created_at BETWEEN &#39;2012-06-09 07:00:00.000000&#39; AND &#39;2012-06-10 07:00:00.000000&#39;)</span></code></pre>

<p>In the case of a belongs_to relationship, an association key can be used to
specify the model if an <a href="../ActiveRecord.html" title="ActiveRecord (module)">::ActiveRecord</a> object is used as the value.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_author'>author</span> <span class='op'>=</span> <span class='const'>Author</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>

<span class='comment'># The following queries will be equivalent:
</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>author:</span> <span class='id identifier rubyid_author'>author</span><span class='rparen'>)</span>
<span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>author_id:</span> <span class='id identifier rubyid_author'>author</span><span class='rparen'>)</span></code></pre>

<p>This also works with polymorphic belongs_to relationships:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_treasure'>treasure</span> <span class='op'>=</span> <span class='const'>Treasure</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>gold coins</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_treasure'>treasure</span><span class='period'>.</span><span class='id identifier rubyid_price_estimates'>price_estimates</span> <span class='op'>&lt;&lt;</span> <span class='const'>PriceEstimate</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>price:</span> <span class='int'>125</span><span class='rparen'>)</span>

<span class='comment'># The following queries will be equivalent:
</span><span class='const'>PriceEstimate</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>estimate_of:</span> <span class='id identifier rubyid_treasure'>treasure</span><span class='rparen'>)</span>
<span class='const'>PriceEstimate</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>estimate_of_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Treasure</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>estimate_of_id:</span> <span class='id identifier rubyid_treasure'>treasure</span><span class='rparen'>)</span></code></pre>

<h3 id="label-Joins">Joins</h3>

<p>If the relation is the result of a join, you may create a condition which
uses any of the tables in the join. For string and array conditions, use
the table name in the condition.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.created_at &lt; ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'><a href="../Time.html" title="Time (class)">Time</a></span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='rparen'>)</span></code></pre>

<p>For hash conditions, you can either use the table name in the key, or use a
sub-hash.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>posts.published</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_posts'>posts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span> <span class='label'>posts:</span> <span class='lbrace'>{</span> <span class='label'>published:</span> <span class='kw'>true</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span><span class='rparen'>)</span></code></pre>

<h3 id="label-no+argument">no argument</h3>

<p>If no argument is passed, <code>#where</code> returns a new instance of
<a href="QueryMethods/WhereChain.html" title="ActiveRecord::QueryMethods::WhereChain (class)">QueryMethods::WhereChain</a>, that can be chained with <code>#not</code>
to return a new relation that negates the where clause.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jon</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='comment'># SELECT * FROM users WHERE name != &#39;Jon&#39;</span></code></pre>

<p>See WhereChain for more details on <code>#not</code>.</p>

<h3 id="label-blank+condition">blank condition</h3>

<p>If the condition is any blank-ish object, then <code>#where</code> is a no-op and
returns the current relation.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L599-L607'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


599
600
601
602
603
604
605
606
607</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 599</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_chain'>chain</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='symbeg'>:</span><span class='id identifier rubyid_chain'>chain</span> <span class='op'>==</span> <span class='id identifier rubyid_opts'>opts</span>
    <span class='const'><a href="QueryMethods/WhereChain.html" title="ActiveRecord::QueryMethods::WhereChain (class)">WhereChain</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="QueryMethods/WhereChain.html#new-class_method" title="ActiveRecord::QueryMethods::WhereChain.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_spawn'>spawn</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='kw'>self</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_spawn'>spawn</span><span class='period'>.</span><span class='id identifier rubyid_where!'>where!</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="where!-instance_method">
  <h3 class='signature nodoc'>
    #<strong>where!</strong>(opts, *rest)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L609-L614'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


609
610
611
612
613
614</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 609</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_where!'>where!</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='id identifier rubyid_sanitize_forbidden_attributes'>sanitize_forbidden_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_references!'>references!</span><span class='lparen'>(</span><span class='const'><a href="PredicateBuilder.html" title="ActiveRecord::PredicateBuilder (class)">PredicateBuilder</a></span><span class='period'>.</span><span class='id identifier rubyid_references'><a href="PredicateBuilder.html#references-class_method" title="ActiveRecord::PredicateBuilder.references (method)">references</a></span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'><a href="../Hash.html" title="Hash (class)">Hash</a></span> <span class='op'>===</span> <span class='id identifier rubyid_opts'>opts</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_where_clause'>where_clause</span> <span class='op'>+=</span> <span class='id identifier rubyid_where_clause_factory'>where_clause_factory</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="where_clause_factory-instance_method">
  <h3 class='signature priv'>
    #<strong>where_clause_factory</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
    <span class='aliases'>Also known as: <span class='names'>#having_clause_factory</span></span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation/query_methods.rb#L1170-L1172'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


1170
1171
1172</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/relation/query_methods.rb', line 1170</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_where_clause_factory'>where_clause_factory</span>
  <span class='ivar'>@where_clause_factory</span> <span class='op'>||=</span> <span class='const'><a href="Relation.html" title="ActiveRecord::Relation (class)">Relation</a></span><span class='op'>::</span><span class='const'><a href="Relation/WhereClauseFactory.html" title="ActiveRecord::Relation::WhereClauseFactory (class)">WhereClauseFactory</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Relation/WhereClauseFactory.html#new-class_method" title="ActiveRecord::Relation::WhereClauseFactory.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='comma'>,</span> <span class='id identifier rubyid_predicate_builder'>predicate_builder</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>