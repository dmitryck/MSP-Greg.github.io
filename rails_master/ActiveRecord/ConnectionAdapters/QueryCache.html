<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::ConnectionAdapters::QueryCache &mdash; Rails-master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::ConnectionAdapters::QueryCache",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../../index.html'>Home</a> &raquo; 
        <a href='../../index.html'>Rails-master</a> &raquo; 
        <a href='../../_index.html#alpha_Q'>Index (Q)</a> &raquo; 
        <a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
        <a href="../ConnectionAdapters.html" title="ActiveRecord::ConnectionAdapters (module)">ConnectionAdapters</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>QueryCache&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActiveRecord::ConnectionAdapters::QueryCache</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="QueryCache/ConnectionPoolConfiguration.html" title="ActiveRecord::ConnectionAdapters::QueryCache::ConnectionPoolConfiguration (module)">ConnectionPoolConfiguration</a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L3'>activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#dirties_query_cache-class_method" title=".dirties_query_cache (class method)">.<strong>dirties_query_cache</strong>(base, *method_names)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#included-class_method" title=".included (class method)">.<strong>included</strong>(base)  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#query_cache-instance_method" title="#query_cache (instance method)">#<strong>query_cache</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#query_cache_enabled-instance_method" title="#query_cache_enabled (instance method)">#<strong>query_cache_enabled</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#cache-instance_method" title="#cache (instance method)">#<strong>cache</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Enable the query cache within the block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#clear_query_cache-instance_method" title="#clear_query_cache (instance method)">#<strong>clear_query_cache</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Clears the query cache.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#disable_query_cache!-instance_method" title="#disable_query_cache! (instance method)">#<strong>disable_query_cache!</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enable_query_cache!-instance_method" title="#enable_query_cache! (instance method)">#<strong>enable_query_cache!</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#select_all-instance_method" title="#select_all (instance method)">#<strong>select_all</strong>(arel, name = nil, binds = [], preparable: nil)  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#uncached-instance_method" title="#uncached (instance method)">#<strong>uncached</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disable the query cache within the block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#cache_sql-instance_method" title="#cache_sql (instance method)">#<strong>cache_sql</strong>(sql, name, binds)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#configure_query_cache!-instance_method" title="#configure_query_cache! (instance method)">#<strong>configure_query_cache!</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#locked%3F-instance_method" title="#locked? (instance method)">#<strong>locked?</strong>(arel)  &#x21d2; Boolean </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>If arel is locked this is a SELECT ...</p></div>
    </div>
  </li>
</ul>
</div>
<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="dirties_query_cache-class_method">
  <h3 class='signature  first'>
    .<strong>dirties_query_cache</strong>(base, *method_names)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L12-L21'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


12
13
14
15
16
17
18
19
20
21</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 12</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_dirties_query_cache'>dirties_query_cache</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_method_names'>method_names</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_method_names'>method_names</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_method_name'>method_name</span><span class='op'>|</span>
    <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_class_eval'>class_eval</span> <span class='heredoc_beg'>&lt;&lt;-end_code</span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='comma'>,</span> <span class='kw'>__LINE__</span> <span class='op'>+</span> <span class='int'>1</span>
<span class='tstring_content'>      def </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method_name'>method_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>(*)
        clear_query_cache if @query_cache_enabled
        super
      end
</span><span class='heredoc_end'>    end_code
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="included-class_method">
  <h3 class='signature nodoc'>
    .<strong>included</strong>(base)  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L5-L10'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


5
6
7
8
9
10</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 5</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_included'>included</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span> <span class='comment'>#:nodoc:
</span>  <span class='id identifier rubyid_dirties_query_cache'>dirties_query_cache</span> <span class='id identifier rubyid_base'>base</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_insert'>insert</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_update'>update</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_delete'>delete</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rollback_to_savepoint'>rollback_to_savepoint</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rollback_db_transaction'>rollback_db_transaction</span>

  <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_set_callback'>set_callback</span> <span class='symbeg'>:</span><span class='id identifier rubyid_checkout'>checkout</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_configure_query_cache!'>configure_query_cache!</span>
  <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_set_callback'>set_callback</span> <span class='symbeg'>:</span><span class='id identifier rubyid_checkin'>checkin</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_after'>after</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_disable_query_cache!'>disable_query_cache!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="query_cache-instance_method">
  <h3 class='signature ro first'>
    #<strong>query_cache</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L45-L45'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


45</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 45</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_query_cache'>query_cache</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_query_cache_enabled'>query_cache_enabled</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="query_cache_enabled-instance_method">
  <h3 class='signature ro'>
    #<strong>query_cache_enabled</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L45-L45'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


45</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 45</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_query_cache'>query_cache</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_query_cache_enabled'>query_cache_enabled</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="cache-instance_method">
  <h3 class='signature  first'>
    #<strong>cache</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Enable the query cache within the block.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L54-L60'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


54
55
56
57
58
59
60</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 54</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cache'>cache</span>
  <span class='id identifier rubyid_old'>old</span><span class='comma'>,</span> <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='ivar'>@query_cache_enabled</span><span class='comma'>,</span> <span class='kw'>true</span>
  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='id identifier rubyid_old'>old</span>
  <span class='id identifier rubyid_clear_query_cache'>clear_query_cache</span> <span class='kw'>unless</span> <span class='ivar'>@query_cache_enabled</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="cache_sql-instance_method">
  <h3 class='signature priv'>
    #<strong>cache_sql</strong>(sql, name, binds)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L103-L121'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 103</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cache_sql'>cache_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span><span class='rparen'>)</span>
  <span class='ivar'>@lock</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span>
      <span class='kw'>if</span> <span class='ivar'>@query_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_sql'>sql</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='id identifier rubyid_binds'>binds</span><span class='rparen'>)</span>
        <span class='const'><a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="../../ActiveSupport/Notifications.html" title="ActiveSupport::Notifications (module)">Notifications</a></span><span class='period'>.</span><span class='id identifier rubyid_instrument'><a href="../../ActiveSupport/Notifications.html#instrument-class_method" title="ActiveSupport::Notifications.instrument (method)">instrument</a></span><span class='lparen'>(</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sql.active_record</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='label'>sql:</span> <span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span>
          <span class='label'>binds:</span> <span class='id identifier rubyid_binds'>binds</span><span class='comma'>,</span>
          <span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
          <span class='label'>connection_id:</span> <span class='id identifier rubyid_object_id'>object_id</span><span class='comma'>,</span>
          <span class='label'>cached:</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='rparen'>)</span>
        <span class='ivar'>@query_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_sql'>sql</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_binds'>binds</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='ivar'>@query_cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_sql'>sql</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_binds'>binds</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>yield</span>
      <span class='kw'>end</span>
    <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="clear_query_cache-instance_method">
  <h3 class='signature '>
    #<strong>clear_query_cache</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Clears the query cache.</p>

<p>One reason you may wish to call this method explicitly is between queries
that ask the database to randomize results. Otherwise the cache would see
the same SQL query and repeatedly return the same result each time,
silently undermining the randomness you were expecting.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L85-L89'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


85
86
87
88
89</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 85</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_query_cache'>clear_query_cache</span>
  <span class='ivar'>@lock</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@query_cache</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="configure_query_cache!-instance_method">
  <h3 class='signature priv'>
    #<strong>configure_query_cache!</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L129-L131'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


129
130
131</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 129</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_configure_query_cache!'>configure_query_cache!</span>
  <span class='id identifier rubyid_enable_query_cache!'>enable_query_cache!</span> <span class='kw'>if</span> <span class='id identifier rubyid_pool'>pool</span><span class='period'>.</span><span class='id identifier rubyid_query_cache_enabled'>query_cache_enabled</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disable_query_cache!-instance_method">
  <h3 class='signature '>
    #<strong>disable_query_cache!</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L66-L69'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


66
67
68
69</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 66</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_disable_query_cache!'>disable_query_cache!</span>
  <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_clear_query_cache'>clear_query_cache</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enable_query_cache!-instance_method">
  <h3 class='signature '>
    #<strong>enable_query_cache!</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L62-L64'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


62
63
64</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 62</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_enable_query_cache!'>enable_query_cache!</span>
  <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="initialize-instance_method">
  <h3 class='signature '>
    #<strong>initialize</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L47-L51'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


47
48
49
50
51</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 47</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='op'>*</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='ivar'>@query_cache</span>         <span class='op'>=</span> <span class='const'><a href="../../Hash.html" title="Hash (class)">Hash</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_sql'>sql</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_sql'>sql</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
  <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="locked?-instance_method">
  <h3 class='signature priv'>
    #<strong>locked?</strong>(arel)  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>If arel is locked this is a SELECT ... FOR UPDATE or somesuch. Such queries
should not be cached.</p>

  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L125-L127'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


125
126
127</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 125</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_locked?'>locked?</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_locked'>locked</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_arel'>arel</span><span class='period'>.</span><span class='id identifier rubyid_locked'>locked</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="select_all-instance_method">
  <h3 class='signature '>
    #<strong>select_all</strong>(arel, name = nil, binds = [], preparable: nil)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L91-L99'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


91
92
93
94
95
96
97
98
99</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 91</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_select_all'>select_all</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>preparable:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@query_cache_enabled</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_locked?'>locked?</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span> <span class='op'>=</span> <span class='id identifier rubyid_binds_from_relation'>binds_from_relation</span> <span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span>
    <span class='id identifier rubyid_sql'>sql</span> <span class='op'>=</span> <span class='id identifier rubyid_to_sql'>to_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_arel'>arel</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_cache_sql'>cache_sql</span><span class='lparen'>(</span><span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_binds'>binds</span><span class='comma'>,</span> <span class='label'>preparable:</span> <span class='id identifier rubyid_preparable'>preparable</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="uncached-instance_method">
  <h3 class='signature '>
    #<strong>uncached</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Disable the query cache within the block.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb#L72-L77'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


72
73
74
75
76
77</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb', line 72</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_uncached'>uncached</span>
  <span class='id identifier rubyid_old'>old</span><span class='comma'>,</span> <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='ivar'>@query_cache_enabled</span><span class='comma'>,</span> <span class='kw'>false</span>
  <span class='kw'>yield</span>
<span class='kw'>ensure</span>
  <span class='ivar'>@query_cache_enabled</span> <span class='op'>=</span> <span class='id identifier rubyid_old'>old</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>