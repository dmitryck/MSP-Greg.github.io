<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: 5.1 Release Notes &mdash; Rails-master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../css/common.css' />

<script type='text/javascript'>
  var pathId = "5_1_release_notes",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../index.html'>Home</a> &raquo; 
        <a href='index.html'>Rails-master</a> &raquo; 
        <a href='_index.html'>Index</a> &raquo; 
        <span class='title'><a id='t2_doc_top' href='#'>File: 5.1 Release Notes&nbsp;&#x25B2;</a></span>
            </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="http://guides.rubyonrails.org">http://guides.rubyonrails.org</a>.</strong></p>

<h1>Ruby on Rails 5.1 Release Notes</h1>

<p>Highlights in Rails 5.1:</p>

<ul>
<li>Yarn Support</li>
<li>Optional Webpack support</li>
<li>jQuery no longer a default dependency</li>
<li>System tests</li>
<li>Encrypted secrets</li>
<li>Parameterized mailers</li>
<li>Direct &amp; resolved routes</li>
<li>Unification of form_for and form_tag into form_with</li>
</ul>

<p>These release notes cover only the major changes. To learn about various bug
fixes and changes, please refer to the change logs or check out the <a href="https://github.com/rails/rails/commits/5-1-stable">list of
commits</a> in the main Rails
repository on GitHub.</p>

<hr>

<h2>Upgrading to Rails 5.1</h2>

<p>ToDo</p>

<h2>Major Features</h2>

<h3>Yarn Support</h3>

<p><a href="https://github.com/rails/rails/pull/26836">Pull Request</a></p>

<p>Rails 5.1 will allow managing JavaScript dependencies
from NPM via Yarn.This will make it easy to use libraries like React, VueJS
or any other library from NPM world. The Yarn support is integrated with
the asset pipeline so that all dependencies will work seamlessly with the
Rails 5.1 app.</p>

<h3>Optional Webpack support</h3>

<p>Rails apps can use Webpack easily now using the <a href="https://github.com/rails/webpacker">Webpacker</a>
gem. New Rails 5.1 app can be generated using <code>--webpack</code> switch to enable Webpack integration.</p>

<p>This is fully compatible with the asset pipeline, which you can continue to use for
images, fonts, sounds, whatever. You can even have some JavaScript on the asset pipeline
and some done via Webpack. It’s all managed via Yarn that’s on by default.</p>

<h3>jQuery no longer a default dependency</h3>

<p>jQuery was required by default in earlier versions of Rails to provide features like
<code>data-remote</code>, <code>data-confirm</code> and other parts of Rails UJS. It is no longer required,
as the <code>rails-ujs</code> is now written using plain vanilla JavaScript.</p>

<p>You can still use jQuery if needed, but it is no longer required by default.</p>

<h3>System tests</h3>

<p><a href="https://github.com/rails/rails/pull/26703">Pull Request</a></p>

<p>Rails 5.1 has support for writing Capybara tests baked in in the form of
System tests. Now you don&#39;t have to worry about configuring Capybara and
database cleaning strategies for such tests. Rails 5.1 provides a wrapper
for running such tests in chrome with additional features such as failure
screenshots.</p>

<h3>Encrypted secrets</h3>

<p><a href="https://github.com/rails/rails/pull/28038">Pull Request</a></p>

<p>Rails will now allow management of application secrets in a secure way
built on top of <a href="https://github.com/ahoward/sekrets">sekrets</a> gem.</p>

<p>Run <code>bin/rails secrets:setup</code> to setup a new encrypted secrets file. It will
generate a master key which needs to be stored outside of the repository and it will
allow checking in the actual secrets in the revision control.</p>

<p>The secrets will be decrypted in production either using <code>RAILS_MASTER_KEY</code> from
the ENV or injected key file.</p>

<h3>Parameterized mailers</h3>

<p><a href="https://github.com/rails/rails/pull/27825">Pull Request</a></p>

<p>Allows specifying common params used for all methods in a mailer class
to share instance variables, headers and other common setup.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>InvitationsMailer</span> <span class='op'>&lt;</span> <span class='const'>ApplicationMailer</span>

  <span class='id identifier rubyid_before_action'>before_action</span> <span class='lbrace'>{</span> <span class='ivar'>@inviter</span><span class='comma'>,</span> <span class='ivar'>@invitee</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_inviter'>inviter</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_invitee'>invitee</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_before_action'>before_action</span> <span class='lbrace'>{</span> <span class='ivar'>@account</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_inviter'>inviter</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_account'>account</span> <span class='rbrace'>}</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_account_invitation'>account_invitation</span>
    <span class='id identifier rubyid_mail'>mail</span> <span class='label'>subject:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@inviter</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> invited you to their Basecamp (</span><span class='embexpr_beg'>#{</span><span class='ivar'>@account</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_project_invitation'>project_invitation</span>
    <span class='ivar'>@project</span>    <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_project'>project</span><span class='rbracket'>]</span>
    <span class='ivar'>@summarizer</span> <span class='op'>=</span> <span class='const'>ProjectInvitationSummarizer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='ivar'>@project</span><span class='period'>.</span><span class='id identifier rubyid_bucket'>bucket</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_mail'>mail</span> <span class='label'>subject:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@inviter</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_familiar'>familiar</span><span class='embexpr_end'>}</span><span class='tstring_content'> added you to a project in Basecamp (</span><span class='embexpr_beg'>#{</span><span class='ivar'>@account</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>InvitationsMailer</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span><span class='lparen'>(</span><span class='label'>inviter:</span> <span class='id identifier rubyid_person_a'>person_a</span><span class='comma'>,</span> <span class='label'>invitee:</span> <span class='id identifier rubyid_person_b'>person_b</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_account_invitation'>account_invitation</span><span class='period'>.</span><span class='id identifier rubyid_deliver_later'>deliver_later</span></code></pre>

<h3>Direct &amp; resolved routes</h3>

<p><a href="https://github.com/rails/rails/pull/23138">Pull Request</a></p>

<p>Rails 5.1 has added two new methods - <code>resolve</code> and <code>direct</code> to the routing
DSL.</p>

<p>The <code>resolve</code> method allows customizing polymorphic mapping of models.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_resource'>resource</span> <span class='symbeg'>:</span><span class='id identifier rubyid_basket'>basket</span>

<span class='id identifier rubyid_resolve'>resolve</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Basket</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_basket'>basket</span><span class='rbracket'>]</span> <span class='rbrace'>}</span></code></pre>

<pre class="code erb"><code class="erb">&lt;%= form_for @basket do |form| %&gt;
  &lt;!-- basket form --&gt;
&lt;% end %&gt;
</code></pre>

<p>This will generate the singular URL <code>/basket</code> instead of usual <code>/baskets/:id</code>.</p>

<p>The <code>direct</code> method allows creation of custom URL helpers.</p>

<pre class="code ruby"><code class="ruby">direct(:homepage) { &quot;http://www.rubyonrails.org&quot; }

&gt;&gt; homepage_url
#=&gt; &quot;http://www.rubyonrails.org&quot;</code></pre>

<p>The return value of the block must be a valid argument for the <code>url_for</code>
method. So you can pass a valid string URL, or a hash, or an array, or an
Active Model instance or an Active Model class.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_direct'>direct</span> <span class='symbeg'>:</span><span class='id identifier rubyid_commentable'>commentable</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_model'>model</span><span class='op'>|</span>
  <span class='lbracket'>[</span> <span class='id identifier rubyid_model'>model</span><span class='comma'>,</span> <span class='label'>anchor:</span> <span class='id identifier rubyid_model'>model</span><span class='period'>.</span><span class='id identifier rubyid_dom_id'>dom_id</span> <span class='rbracket'>]</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_direct'>direct</span> <span class='symbeg'>:</span><span class='id identifier rubyid_main'>main</span> <span class='kw'>do</span>
  <span class='lbrace'>{</span> <span class='label'>controller:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pages</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>action:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>index</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>subdomain:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>www</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span></code></pre>

<h3>Unification of form_for and form_tag into form_with</h3>

<p><a href="https://github.com/rails/rails/pull/26976">Pull Request</a></p>

<p>Before Rails 5.1, there were two interfaces for handling HTML forms,
<code>form_for</code> for model instances and <code>form_tag</code> for custom URLs.</p>

<p>Rails 5.1 combines both of these interfaces with <code>form_with</code> and
can generate form tags based on URLs, scopes or models.</p>

<pre class="code erb"><code class="erb"># Using just a URL:

&lt;%= form_with url: posts_path do |form| %&gt;
  &lt;%= form.text_field :title %&gt;
&lt;% end %&gt;

# =&gt;
&lt;form action=&quot;/posts&quot; method=&quot;post&quot; data-remote=&quot;true&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;
&lt;/form&gt;

# Adding a scope prefixes the input field names:

&lt;%= form_with scope: :post, url: posts_path do |form| %&gt;
  &lt;%= form.text_field :title %&gt;
&lt;% end %&gt;
# =&gt;
&lt;form action=&quot;/posts&quot; method=&quot;post&quot; data-remote=&quot;true&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;post[title]&quot;&gt;
&lt;/form&gt;

# Using a model infers both the URL and scope:

&lt;%= form_with model: Post.new do |form| %&gt;
  &lt;%= form.text_field :title %&gt;
&lt;% end %&gt;
# =&gt;
&lt;form action=&quot;/posts&quot; method=&quot;post&quot; data-remote=&quot;true&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;post[title]&quot;&gt;
&lt;/form&gt;

# An existing model makes an update form and fills out field values:

&lt;%= form_with model: Post.first do |form| %&gt;
  &lt;%= form.text_field :title %&gt;
&lt;% end %&gt;
# =&gt;
&lt;form action=&quot;/posts/1&quot; method=&quot;post&quot; data-remote=&quot;true&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;patch&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;post[title]&quot; value=&quot;&lt;the title of the post&gt;&quot;&gt;
&lt;/form&gt;
</code></pre>

<h2>Railties</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/railties/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Action Pack</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/actionpack/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Action View</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/actionview/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Action Mailer</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/actionmailer/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Active Record</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/activerecord/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Active Model</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/activemodel/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Active Job</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/activejob/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Active Support</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/5-1-stable/activesupport/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h2>Credits</h2>

<p>See the
<a href="http://contributors.rubyonrails.org/">full list of contributors to Rails</a> for
the many people who spent many hours making Rails, the stable and robust
framework it is. Kudos to all of them.</p>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>