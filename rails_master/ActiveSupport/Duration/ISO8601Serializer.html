<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: ActiveSupport::Duration::ISO8601Serializer &mdash; Rails-master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "ActiveSupport::Duration::ISO8601Serializer",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
        <a href='../../../index.html'>Home</a> &raquo; 
        <a href='../../index.html'>Rails-master</a> &raquo; 
        <a href='../../_index.html#alpha_I'>Index (I)</a> &raquo; 
        <a href="../../ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a> &raquo; 
        <a href="../Duration.html" title="ActiveSupport::Duration (class)">Duration</a> &raquo; 
        <span class='title'><a class='nodoc' id='t2_doc_top' href='#'>ISO8601Serializer&nbsp;&#x25B2;</a></span>
      </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: ActiveSupport::Duration::ISO8601Serializer</h1>
  <div class='note nodoc inline-block'>
    <strong>Do not use.  This class is for internal use only.</strong>
  </div>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/master/activesupport/lib/active_support/duration/iso8601_serializer.rb#L7'>activesupport/lib/active_support/duration/iso8601_serializer.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Serializes duration to string according to ISO 8601
<a href="../Duration.html" title="ActiveSupport::Duration (class)">::ActiveSupport::Duration</a> format.</p>

  </div>
</div>
</div>        

<h2 class='h2_sum' id='class_Method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(duration, precision: nil)  &#x21d2; ISO8601Serializer </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>
        

<h2 class='h2_sum' id='instance_Method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full nodoc'>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#serialize-instance_method" title="#serialize (instance method)">#<strong>serialize</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Builds and returns output string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv nodoc'>
      <a href="#normalize-instance_method" title="#normalize (instance method)">#<strong>normalize</strong>  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Return pair of duration&#39;s parts and whole duration sign.</p></div>
    </div>
  </li>
</ul>
</div>
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature nodoc first'>
    .<strong>new</strong>(duration, precision: nil)  &#x21d2; <code>ISO8601Serializer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activesupport/lib/active_support/duration/iso8601_serializer.rb#L8-L11'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


8
9
10
11</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/duration/iso8601_serializer.rb', line 8</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_duration'>duration</span><span class='comma'>,</span> <span class='label'>precision:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@duration</span> <span class='op'>=</span> <span class='id identifier rubyid_duration'>duration</span>
  <span class='ivar'>@precision</span> <span class='op'>=</span> <span class='id identifier rubyid_precision'>precision</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="normalize-instance_method">
  <h3 class='signature priv  nodoc first'>
    #<strong>normalize</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return pair of duration&#39;s parts and whole duration sign. Parts are
summarized (as they can become repetitive due to addition, etc). Zero parts
are removed as not significant. If all parts are negative it will negate
all of them and return minus as a sign.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activesupport/lib/active_support/duration/iso8601_serializer.rb#L39-L50'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


39
40
41
42
43
44
45
46
47
48
49
50</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/duration/iso8601_serializer.rb', line 39</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_normalize'>normalize</span>
  <span class='id identifier rubyid_parts'>parts</span> <span class='op'>=</span> <span class='ivar'>@duration</span><span class='period'>.</span><span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='const'><a href="../../Hash.html" title="Hash (class)">Hash</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id identifier rubyid_v'>v</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>
  <span class='kw'>end</span>
  <span class='comment'># If all parts are negative - let&#39;s make a negative duration
</span>  <span class='id identifier rubyid_sign'>sign</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>&lt;</span> <span class='int'>0</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_sign'>sign</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_transform_values!'>transform_values!</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbeg'>:</span><span class='op'>-@</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_parts'>parts</span><span class='comma'>,</span> <span class='id identifier rubyid_sign'>sign</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="serialize-instance_method">
  <h3 class='signature nodoc'>
    #<strong>serialize</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Builds and returns output string.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/master/activesupport/lib/active_support/duration/iso8601_serializer.rb#L14-L31'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activesupport/lib/active_support/duration/iso8601_serializer.rb', line 14</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_serialize'>serialize</span>
  <span class='id identifier rubyid_parts'>parts</span><span class='comma'>,</span> <span class='id identifier rubyid_sign'>sign</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize'>normalize</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PT0S</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span> <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>P</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_years'>years</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>Y</span><span class='tstring_end'>&quot;</span></span>   <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_years'>years</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_months'>months</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>M</span><span class='tstring_end'>&quot;</span></span>  <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_months'>months</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_weeks'>weeks</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>W</span><span class='tstring_end'>&quot;</span></span>   <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_weeks'>weeks</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_days'>days</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>D</span><span class='tstring_end'>&quot;</span></span>    <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_days'>days</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_time'>time</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_hours'>hours</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>H</span><span class='tstring_end'>&quot;</span></span>     <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_hours'>hours</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_time'>time</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>M</span><span class='tstring_end'>&quot;</span></span>   <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_minutes'>minutes</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbeg'>:</span><span class='id identifier rubyid_seconds'>seconds</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_time'>time</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='ivar'>@precision</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%0.0</span><span class='embexpr_beg'>#{</span><span class='ivar'>@precision</span><span class='embexpr_end'>}</span><span class='tstring_content'>f</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%g</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_parts'>parts</span><span class='lbracket'>[</span><span class='symbeg'>:</span><span class='id identifier rubyid_seconds'>seconds</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>S</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>T</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_time'>time</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sign'>sign</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.8 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.5.0p-1)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>