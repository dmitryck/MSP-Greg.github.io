<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Gem::Security &mdash; rubygems  Ruby-2.3.3 p224 2016-11-24</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "Gem::Security",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class viewBox='0 0 90 90'></svg>
  <div id='y_list' class='d h'>
    <header id='list_header'>
      <div id='list_title'>&#160;</div>
      <div id='list_menu'>
        <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
        <span>&#160;</span>
      </div>
      <input  id='list_search_text' type='search' placeholder='List Search' size='12' value='' autocomplete='off' class='search_input'/>
      <svg id='list_search_icon' viewBox='0 0 30 30'>
        <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
        <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
        <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
      </svg>
      <button class='y_minus' title='Collapse All'></button>
      <button class='y_plus' title='Expand All'></button>
    </header>
    <nav id= 'list_nav' class='y_nav l_nav'>
      <ul id='list_items'></ul>
    </nav>
  </div>
  <div id='y_toc' class='f h'>
    <header id='toc_header'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <div>Table of Contents</div>
      <input  id='toc_search_text' type='search' placeholder='Method Search' size='12' value='' autocomplete='off' class='search_input'/>
      <svg id='toc_search_icon' viewBox='0 0 30 30'>
        <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
        <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
        <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
      </svg>
      <button class='y_minus' title='Collapse All'></button>
      <button class='y_plus' title='Expand All' ></button>
    </header>
    <nav id= 'toc_nav' class='y_nav t_nav'>
    <ol id='toc_items'></ol>
    </nav>
  </div>
  <div id='y_main' tabindex='-1'>
    <header id='y_header'>
      <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.3.3</a> &raquo; 
          <a href='../index.html'>rubygems</a> &raquo; 
          <a href='../_index.html#alpha_S'>Index (S)</a> &raquo; 
          <a href="../Gem.html" title="Gem (module)">Gem</a> &raquo; 
          <span class='title'><a id='t2_doc_top' href='#'>Security&nbsp;&#x25B2;</a></span>
        </div>

      <div id='y_measure_em' class='y_measure'></div>
      <div id='y_measure_vh' class='y_measure'></div>
      <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
      <a id='list_href' href="../class_list.html"></a>
      <div id='hdr_button'>
        <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
            <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
          </svg><svg class='o' viewBox='0 0 34 28'>
            <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
          </svg></button>
        <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
          <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
        <button id='toc_loc'  class='f' title='TOC Location' >T<svg class='f' viewBox='0 0 36 28'>
          <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
        <button id='list_vis' title='LIST Show / Hide'>LIST</button>
        <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
      </div>
      <div id='y_debug'></div>
    </header>
<div id='content' class='module'>
<h1>Module: Gem::Security</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a>,
        <a href="Security/Signer.html" title="Gem::Security::Signer (class)">Signer</a>,
        <a href="Security/TrustDir.html" title="Gem::Security::TrustDir (class)">TrustDir</a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Exceptions:</div>
      <div class='box_11'>
          <a href="Security/Exception.html" title="Gem::Security::Exception (class)">Exception</a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L332'>lib/rubygems/security.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/install_update_options.rb#L12'>lib/rubygems/install_update_options.rb</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L2'>lib/rubygems/security/policies.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div><h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>forward-declare</p>

  </div>
</div>
</div><h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
  <ul class='constants summary full'>

  <li>
    <span id='AlmostNoSecurity-constant' class='summary_signature   '>AlmostNoSecurity =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>AlmostNo security policy: only verify that the signing certificate is the
one that actually signed the data.  Make no attempt to verify the signing
certificate chain.</p>

<p>This policy is basically useless. better than nothing, but can still be
easily spoofed, and is not recommended.</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L25-L33'># File 'lib/rubygems/security/policies.rb', line 25</a>
    <pre class='code ruby'><span class='const'><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/Policy.html#new-class_method" title="Gem::Security::Policy.new (method)">new</a></span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Almost No Security</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_data'>verify_data</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_signer'>verify_signer</span>    <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_chain'>verify_chain</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_root'>verify_root</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_trusted'>only_trusted</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_signed'>only_signed</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span>
<span class='rparen'>)</span></pre>
  </li>

  <li>
    <span id='DIGEST_ALGORITHM-constant' class='summary_signature   '>DIGEST_ALGORITHM =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Digest algorithm used to sign gems</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L342-L345'># File 'lib/rubygems/security.rb', line 342</a>
    <pre class='code ruby'><span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA1</span><span class='rparen'>)</span> <span class='kw'>then</span>
  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA1</span>
<span class='kw'>end</span></pre>
  </li>

  <li>
    <span id='EXTENSIONS-constant' class='summary_signature   '>EXTENSIONS =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>The default set of extensions are:</p>
<ul><li>
<p>The certificate is not a certificate authority</p>
</li><li>
<p>The key for the certificate may be used for key and data encipherment and
digital signatures</p>
</li><li>
<p>The certificate contains a subject key identifier</p>
</li></ul>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L387-L392'># File 'lib/rubygems/security.rb', line 387</a>
    <pre class='code ruby'><span class='lbrace'>{</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basicConstraints</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CA:FALSE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyUsage</span><span class='tstring_end'>&#39;</span></span>             <span class='op'>=&gt;</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keyEncipherment,dataEncipherment,digitalSignature</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectKeyIdentifier</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hash</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
<span class='rbrace'>}</span></pre>
  </li>

  <li>
    <span id='HighSecurity-constant' class='summary_signature   '>HighSecurity =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>High security policy: only allow signed gems to be installed, verify the
signing certificate, verify the signing certificate chain all the way to
the root certificate, and only trust root certificates that we have
explicitly allowed trust for.</p>

<p>This security policy is significantly more difficult to bypass, and offers
a reasonable guarantee that the contents of the gem have not been altered.</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L80-L88'># File 'lib/rubygems/security/policies.rb', line 80</a>
    <pre class='code ruby'><span class='const'><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/Policy.html#new-class_method" title="Gem::Security::Policy.new (method)">new</a></span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>High Security</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_data'>verify_data</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_signer'>verify_signer</span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_chain'>verify_chain</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_root'>verify_root</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_trusted'>only_trusted</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_signed'>only_signed</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span>
<span class='rparen'>)</span></pre>
  </li>

  <li>
    <span id='KEY_ALGORITHM-constant' class='summary_signature   '>KEY_ALGORITHM =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Algorithm for creating the key pair used to sign gems</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L358-L361'># File 'lib/rubygems/security.rb', line 358</a>
    <pre class='code ruby'><span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='rparen'>)</span> <span class='kw'>then</span>
  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span>
<span class='kw'>end</span></pre>
  </li>

  <li>
    <span id='KEY_CIPHER-constant' class='summary_signature   '>KEY_CIPHER =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Cipher used to encrypt the key pair used to sign gems. Must be in the list
returned by <tt>OpenSSL::Cipher.ciphers</tt></p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L372-L372'># File 'lib/rubygems/security.rb', line 372</a>
    <pre class='code ruby'><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Cipher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-256-CBC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></pre>
  </li>

  <li>
    <span id='KEY_LENGTH-constant' class='summary_signature   '>KEY_LENGTH =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Length of keys created by <a href="#KEY_ALGORITHM-constant" title="Gem::Security::KEY_ALGORITHM (constant)">KEY_ALGORITHM</a></p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L366-L366'># File 'lib/rubygems/security.rb', line 366</a>
    <pre class='code ruby'><span class='int'>2048</span></pre>
  </li>

  <li>
    <span id='LowSecurity-constant' class='summary_signature   '>LowSecurity =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Low security policy: only verify that the signing certificate is actually
the gem signer, and that the signing certificate is valid.</p>

<p>This policy is better than nothing, but can still be easily spoofed, and is
not recommended.</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L42-L50'># File 'lib/rubygems/security/policies.rb', line 42</a>
    <pre class='code ruby'><span class='const'><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/Policy.html#new-class_method" title="Gem::Security::Policy.new (method)">new</a></span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Low Security</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_data'>verify_data</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_signer'>verify_signer</span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_chain'>verify_chain</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_root'>verify_root</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_trusted'>only_trusted</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_signed'>only_signed</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span>
<span class='rparen'>)</span></pre>
  </li>

  <li>
    <span id='MediumSecurity-constant' class='summary_signature   '>MediumSecurity =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Medium security policy: verify the signing certificate, verify the signing
certificate chain all the way to the root certificate, and only trust root
certificates that we have explicitly allowed trust for.</p>

<p>This security policy is reasonable, but it allows unsigned packages, so a
malicious person could simply delete the package signature and pass the gem
off as unsigned.</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L61-L69'># File 'lib/rubygems/security/policies.rb', line 61</a>
    <pre class='code ruby'><span class='const'><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/Policy.html#new-class_method" title="Gem::Security::Policy.new (method)">new</a></span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Medium Security</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_data'>verify_data</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_signer'>verify_signer</span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_chain'>verify_chain</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_root'>verify_root</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_trusted'>only_trusted</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_signed'>only_signed</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span>
<span class='rparen'>)</span></pre>
  </li>

  <li>
    <span id='NoSecurity-constant' class='summary_signature   '>NoSecurity =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>No security policy: all package signature checks are disabled.</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L7-L15'># File 'lib/rubygems/security/policies.rb', line 7</a>
    <pre class='code ruby'><span class='const'><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/Policy.html#new-class_method" title="Gem::Security::Policy.new (method)">new</a></span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>No Security</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_data'>verify_data</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_signer'>verify_signer</span>    <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_chain'>verify_chain</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_root'>verify_root</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_trusted'>only_trusted</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_signed'>only_signed</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span>
<span class='rparen'>)</span></pre>
  </li>

  <li>
    <span id='ONE_YEAR-constant' class='summary_signature   '>ONE_YEAR =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>One year in seconds</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L377-L377'># File 'lib/rubygems/security.rb', line 377</a>
    <pre class='code ruby'><span class='int'>86400</span> <span class='op'>*</span> <span class='int'>365</span></pre>
  </li>

  <li>
    <span id='Policies-constant' class='summary_signature   '>Policies =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p>Hash of configured security policies</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L106-L113'># File 'lib/rubygems/security/policies.rb', line 106</a>
    <pre class='code ruby'><span class='lbrace'>{</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NoSecurity</span><span class='tstring_end'>&#39;</span></span>       <span class='op'>=&gt;</span> <span class='const'><a href="#NoSecurity-constant" title="Gem::Security::NoSecurity (constant)">NoSecurity</a></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AlmostNoSecurity</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'><a href="#AlmostNoSecurity-constant" title="Gem::Security::AlmostNoSecurity (constant)">AlmostNoSecurity</a></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>LowSecurity</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='const'><a href="#LowSecurity-constant" title="Gem::Security::LowSecurity (constant)">LowSecurity</a></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MediumSecurity</span><span class='tstring_end'>&#39;</span></span>   <span class='op'>=&gt;</span> <span class='const'><a href="#MediumSecurity-constant" title="Gem::Security::MediumSecurity (constant)">MediumSecurity</a></span><span class='comma'>,</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HighSecurity</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='const'><a href="#HighSecurity-constant" title="Gem::Security::HighSecurity (constant)">HighSecurity</a></span><span class='comma'>,</span>
  <span class='comment'># SigningPolicy is not intended for use by `gem -P` so do not list it
</span><span class='rbrace'>}</span></pre>
  </li>

  <li>
    <span id='SigningPolicy-constant' class='summary_signature   '>SigningPolicy =</span>
    <div class='docstring'>
  <div class='discussion'>
    
<p><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Security::Policy</a> used to verify a certificate and key when signing a
gem</p>

  </div>
</div>

 
    <a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security/policies.rb#L93-L101'># File 'lib/rubygems/security/policies.rb', line 93</a>
    <pre class='code ruby'><span class='const'><a href="Security/Policy.html" title="Gem::Security::Policy (class)">Policy</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/Policy.html#new-class_method" title="Gem::Security::Policy.new (method)">new</a></span><span class='lparen'>(</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Signing Policy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_data'>verify_data</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_signer'>verify_signer</span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_chain'>verify_chain</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_verify_root'>verify_root</span>      <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_trusted'>only_trusted</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>
  <span class='symbeg'>:</span><span class='id identifier rubyid_only_signed'>only_signed</span>      <span class='op'>=&gt;</span> <span class='kw'>false</span>
<span class='rparen'>)</span></pre>
  </li>
</ul>
    </div>
        
<h2 class='h2_sum'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#alt_name_or_x509_entry-class_method" title=".alt_name_or_x509_entry (class method)">.<strong>alt_name_or_x509_entry</strong>(certificate, x509_entry)  </a>
    </span>
      </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_cert-class_method" title=".create_cert (class method)">.<strong>create_cert</strong>(subject, key, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Creates an unsigned certificate for <tt>subject</tt>+ and <tt>key</tt>+.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_cert_email-class_method" title=".create_cert_email (class method)">.<strong>create_cert_email</strong>(email, key, age = ONE_YEAR, extensions = EXTENSIONS)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Creates a self-signed certificate with an issuer and subject from <tt>email</tt>+,
a subject alternative name of <tt>email</tt>+ and the given <tt>extensions</tt>+ for the
<tt>key</tt>+.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_cert_self_signed-class_method" title=".create_cert_self_signed (class method)">.<strong>create_cert_self_signed</strong>(subject, key, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Creates a self-signed certificate with an issuer and subject of <tt>subject</tt>+
and the given <tt>extensions</tt>+ for the <tt>key</tt>+.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_key-class_method" title=".create_key (class method)">.<strong>create_key</strong>(length = KEY_LENGTH, algorithm = KEY_ALGORITHM)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Creates a new key pair of the specified <tt>length</tt>+ and <tt>algorithm</tt>+.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#email_to_name-class_method" title=".email_to_name (class method)">.<strong>email_to_name</strong>(email_address)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Turns <tt>email_address</tt>+ into an <tt>OpenSSL::X509::Name</tt></p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#re_sign-class_method" title=".re_sign (class method)">.<strong>re_sign</strong>(expired_certificate, private_key, age = ONE_YEAR, extensions = EXTENSIONS)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Signs <tt>expired_certificate</tt>+ with <tt>private_key</tt>+ if the keys match and the
expired certificate was self-signed.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#reset-class_method" title=".reset (class method)">.<strong>reset</strong>  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Resets the trust directory for verifying gems.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#sign-class_method" title=".sign (class method)">.<strong>sign</strong>(certificate, signing_key, signing_cert, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Sign the public key from <tt>certificate</tt>+ with the <tt>signing_key</tt>+ and
<tt>signing_cert</tt>+, using the <a href="#DIGEST_ALGORITHM-constant" title="Gem::Security::DIGEST_ALGORITHM (constant)">DIGEST_ALGORITHM</a>.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#trust_dir-class_method" title=".trust_dir (class method)">.<strong>trust_dir</strong>  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Returns a <a href="Security/TrustDir.html" title="Gem::Security::TrustDir (class)">TrustDir</a> which wraps the directory where trusted
certificates live.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#trusted_certificates-class_method" title=".trusted_certificates (class method)">.<strong>trusted_certificates</strong>(&amp;block)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Enumerates the trusted certificates via <a href="Security/TrustDir.html" title="Gem::Security::TrustDir (class)">TrustDir</a>.</p>
</div>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#write-class_method" title=".write (class method)">.<strong>write</strong>(pemmable, path, permissions = 0600, passphrase = nil, cipher = KEY_CIPHER)  </a>
    </span>
        <span class='summary_desc'>
      <div class='inline'>
<p>Writes <tt>pemmable</tt>+, which must respond to <tt>to_pem</tt>+ to <a href="../Gem.html#path-class_method" title="Gem.path (method)">path</a>+ with the
given <tt>permissions</tt>+.</p>
</div>
    </span>
  </li>
</ul>
</div>
<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="alt_name_or_x509_entry-class_method">
  <h3 class='signature  first'>
  .<strong>alt_name_or_x509_entry</strong>(certificate, x509_entry)  
</h3>

  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L394-L402'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


394
395
396
397
398
399
400
401
402</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 394</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_alt_name_or_x509_entry'>alt_name_or_x509_entry</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='comma'>,</span> <span class='id identifier rubyid_x509_entry'>x509_entry</span>
  <span class='id identifier rubyid_alt_name'>alt_name</span> <span class='op'>=</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='period'>.</span><span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_extension'>extension</span><span class='op'>|</span>
    <span class='id identifier rubyid_extension'>extension</span><span class='period'>.</span><span class='id identifier rubyid_oid'>oid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x509_entry'>x509_entry</span><span class='embexpr_end'>}</span><span class='tstring_content'>AltName</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_alt_name'>alt_name</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='kw'>if</span> <span class='id identifier rubyid_alt_name'>alt_name</span>

  <span class='id identifier rubyid_certificate'>certificate</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='id identifier rubyid_x509_entry'>x509_entry</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="create_cert-class_method">
  <h3 class='signature '>
  .<strong>create_cert</strong>(subject, key, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Creates an unsigned certificate for <tt>subject</tt>+ and <tt>key</tt>+.  The lifetime of
the key is from the current time to <tt>age</tt>+ which defaults to one year.</p>

<p>The <tt>extensions</tt>+ restrict the key to the indicated uses.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L410-L430'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 410</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_cert'>create_cert</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span> <span class='op'>=</span> <span class='const'><a href="#ONE_YEAR-constant" title="Gem::Security::ONE_YEAR (constant)">ONE_YEAR</a></span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='const'><a href="#EXTENSIONS-constant" title="Gem::Security::EXTENSIONS (constant)">EXTENSIONS</a></span><span class='comma'>,</span>
                     <span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span>    <span class='op'>=</span> <span class='int'>2</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span>     <span class='op'>=</span> <span class='id identifier rubyid_serial'>serial</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_before'>not_before</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_not_after'>not_after</span>  <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='id identifier rubyid_age'>age</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>    <span class='op'>=</span> <span class='id identifier rubyid_subject'>subject</span>

  <span class='id identifier rubyid_ef'>ef</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>ExtensionFactory</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_cert'>cert</span>

  <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ext_name'>ext_name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_ef'>ef</span><span class='period'>.</span><span class='id identifier rubyid_create_extension'>create_extension</span> <span class='id identifier rubyid_ext_name'>ext_name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_cert'>cert</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="create_cert_email-class_method">
  <h3 class='signature '>
  .<strong>create_cert_email</strong>(email, key, age = ONE_YEAR, extensions = EXTENSIONS)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a self-signed certificate with an issuer and subject from <tt>email</tt>+,
a subject alternative name of <tt>email</tt>+ and the given <tt>extensions</tt>+ for the
<tt>key</tt>+.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L437-L443'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


437
438
439
440
441
442
443</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 437</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_cert_email'>create_cert_email</span> <span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span> <span class='op'>=</span> <span class='const'><a href="#ONE_YEAR-constant" title="Gem::Security::ONE_YEAR (constant)">ONE_YEAR</a></span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='const'><a href="#EXTENSIONS-constant" title="Gem::Security::EXTENSIONS (constant)">EXTENSIONS</a></span>
  <span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_email_to_name'>email_to_name</span> <span class='id identifier rubyid_email'>email</span>

  <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_email'>email</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_create_cert_self_signed'>create_cert_self_signed</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="create_cert_self_signed-class_method">
  <h3 class='signature '>
  .<strong>create_cert_self_signed</strong>(subject, key, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a self-signed certificate with an issuer and subject of <tt>subject</tt>+
and the given <tt>extensions</tt>+ for the <tt>key</tt>+.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L449-L454'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


449
450
451
452
453
454</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 449</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_cert_self_signed'>create_cert_self_signed</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span> <span class='op'>=</span> <span class='const'><a href="#ONE_YEAR-constant" title="Gem::Security::ONE_YEAR (constant)">ONE_YEAR</a></span><span class='comma'>,</span>
                                 <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='const'><a href="#EXTENSIONS-constant" title="Gem::Security::EXTENSIONS (constant)">EXTENSIONS</a></span><span class='comma'>,</span> <span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_certificate'>certificate</span> <span class='op'>=</span> <span class='id identifier rubyid_create_cert'>create_cert</span> <span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span>

  <span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span><span class='comma'>,</span> <span class='id identifier rubyid_serial'>serial</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="create_key-class_method">
  <h3 class='signature '>
  .<strong>create_key</strong>(length = KEY_LENGTH, algorithm = KEY_ALGORITHM)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new key pair of the specified <tt>length</tt>+ and <tt>algorithm</tt>+.  The
default is a 2048 bit RSA key.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L460-L462'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


460
461
462</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 460</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_key'>create_key</span> <span class='id identifier rubyid_length'>length</span> <span class='op'>=</span> <span class='const'><a href="#KEY_LENGTH-constant" title="Gem::Security::KEY_LENGTH (constant)">KEY_LENGTH</a></span><span class='comma'>,</span> <span class='id identifier rubyid_algorithm'>algorithm</span> <span class='op'>=</span> <span class='const'><a href="#KEY_ALGORITHM-constant" title="Gem::Security::KEY_ALGORITHM (constant)">KEY_ALGORITHM</a></span>
  <span class='id identifier rubyid_algorithm'>algorithm</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_length'>length</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="email_to_name-class_method">
  <h3 class='signature '>
  .<strong>email_to_name</strong>(email_address)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Turns <tt>email_address</tt>+ into an <tt>OpenSSL::X509::Name</tt></p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L467-L477'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


467
468
469
470
471
472
473
474
475
476
477</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 467</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email_to_name'>email_to_name</span> <span class='id identifier rubyid_email_address'>email_address</span>
  <span class='id identifier rubyid_email_address'>email_address</span> <span class='op'>=</span> <span class='id identifier rubyid_email_address'>email_address</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[^\w@.-]+</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_cn'>cn</span><span class='comma'>,</span> <span class='id identifier rubyid_dcs'>dcs</span> <span class='op'>=</span> <span class='id identifier rubyid_email_address'>email_address</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_dcs'>dcs</span> <span class='op'>=</span> <span class='id identifier rubyid_dcs'>dcs</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CN=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cn'>cn</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dcs'>dcs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_dc'>dc</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DC=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dc'>dc</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Name</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span> <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="re_sign-class_method">
  <h3 class='signature '>
  .<strong>re_sign</strong>(expired_certificate, private_key, age = ONE_YEAR, extensions = EXTENSIONS)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Signs <tt>expired_certificate</tt>+ with <tt>private_key</tt>+ if the keys match and the
expired certificate was self-signed.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<a href="Security/Exception.html" title="Gem::Security::Exception (class)">Gem::Security::Exception</a>)</span>
  </li>
</ul>

</div>  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L485-L506'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 485</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_re_sign'>re_sign</span> <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='comma'>,</span> <span class='id identifier rubyid_private_key'>private_key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span> <span class='op'>=</span> <span class='const'><a href="#ONE_YEAR-constant" title="Gem::Security::ONE_YEAR (constant)">ONE_YEAR</a></span><span class='comma'>,</span>
                 <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='const'><a href="#EXTENSIONS-constant" title="Gem::Security::EXTENSIONS (constant)">EXTENSIONS</a></span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'>Security</span><span class='op'>::</span><span class='const'><a href="Security/Exception.html" title="Gem::Security::Exception (class)">Exception</a></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>incorrect signing key for re-signing </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span>
    <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span> <span class='op'>==</span> <span class='id identifier rubyid_private_key'>private_key</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span>
         <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_subject'>subject</span> <span class='op'>=</span> <span class='id identifier rubyid_alt_name_or_x509_entry'>alt_name_or_x509_entry</span> <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subject'>subject</span>
    <span class='id identifier rubyid_issuer'>issuer</span>  <span class='op'>=</span> <span class='id identifier rubyid_alt_name_or_x509_entry'>alt_name_or_x509_entry</span> <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_issuer'>issuer</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><a href="../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'>Security</span><span class='op'>::</span><span class='const'><a href="Security/Exception.html" title="Gem::Security::Exception (class)">Exception</a></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subject'>subject</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not self-signed, contact </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_issuer'>issuer</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>to obtain a valid certificate</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='period'>.</span><span class='id identifier rubyid_serial'>serial</span> <span class='op'>+</span> <span class='int'>1</span>

  <span class='id identifier rubyid_create_cert_self_signed'>create_cert_self_signed</span><span class='lparen'>(</span><span class='id identifier rubyid_expired_certificate'>expired_certificate</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_private_key'>private_key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span><span class='comma'>,</span>
                          <span class='id identifier rubyid_extensions'>extensions</span><span class='comma'>,</span> <span class='id identifier rubyid_serial'>serial</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="reset-class_method">
  <h3 class='signature '>
  .<strong>reset</strong>  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Resets the trust directory for verifying gems.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L511-L513'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


511
512
513</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 511</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
  <span class='ivar'>@trust_dir</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="sign-class_method">
  <h3 class='signature '>
  .<strong>sign</strong>(certificate, signing_key, signing_cert, age = ONE_YEAR, extensions = EXTENSIONS, serial = 1)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Sign the public key from <tt>certificate</tt>+ with the <tt>signing_key</tt>+ and
<tt>signing_cert</tt>+, using the <a href="#DIGEST_ALGORITHM-constant" title="Gem::Security::DIGEST_ALGORITHM (constant)">DIGEST_ALGORITHM</a>.  Uses the
default certificate validity range and extensions.</p>

<p>Returns the newly signed certificate.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L522-L545'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 522</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='comma'>,</span> <span class='id identifier rubyid_signing_key'>signing_key</span><span class='comma'>,</span> <span class='id identifier rubyid_signing_cert'>signing_cert</span><span class='comma'>,</span>
              <span class='id identifier rubyid_age'>age</span> <span class='op'>=</span> <span class='const'><a href="#ONE_YEAR-constant" title="Gem::Security::ONE_YEAR (constant)">ONE_YEAR</a></span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='const'><a href="#EXTENSIONS-constant" title="Gem::Security::EXTENSIONS (constant)">EXTENSIONS</a></span><span class='comma'>,</span> <span class='id identifier rubyid_serial'>serial</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_signee_subject'>signee_subject</span> <span class='op'>=</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>
  <span class='id identifier rubyid_signee_key'>signee_key</span>     <span class='op'>=</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='period'>.</span><span class='id identifier rubyid_public_key'>public_key</span>

  <span class='id identifier rubyid_alt_name'>alt_name</span> <span class='op'>=</span> <span class='id identifier rubyid_certificate'>certificate</span><span class='period'>.</span><span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_extension'>extension</span><span class='op'>|</span>
    <span class='id identifier rubyid_extension'>extension</span><span class='period'>.</span><span class='id identifier rubyid_oid'>oid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_alt_name'>alt_name</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='kw'>if</span>
    <span class='id identifier rubyid_alt_name'>alt_name</span>

  <span class='id identifier rubyid_issuer_alt_name'>issuer_alt_name</span> <span class='op'>=</span> <span class='id identifier rubyid_signing_cert'>signing_cert</span><span class='period'>.</span><span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_extension'>extension</span><span class='op'>|</span>
    <span class='id identifier rubyid_extension'>extension</span><span class='period'>.</span><span class='id identifier rubyid_oid'>oid</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>subjectAltName</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_extensions'>extensions</span> <span class='op'>=</span> <span class='id identifier rubyid_extensions'>extensions</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>issuerAltName</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_issuer_alt_name'>issuer_alt_name</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='kw'>if</span>
    <span class='id identifier rubyid_issuer_alt_name'>issuer_alt_name</span>

  <span class='id identifier rubyid_signed'>signed</span> <span class='op'>=</span> <span class='id identifier rubyid_create_cert'>create_cert</span> <span class='id identifier rubyid_signee_subject'>signee_subject</span><span class='comma'>,</span> <span class='id identifier rubyid_signee_key'>signee_key</span><span class='comma'>,</span> <span class='id identifier rubyid_age'>age</span><span class='comma'>,</span> <span class='id identifier rubyid_extensions'>extensions</span><span class='comma'>,</span> <span class='id identifier rubyid_serial'>serial</span>
  <span class='id identifier rubyid_signed'>signed</span><span class='period'>.</span><span class='id identifier rubyid_issuer'>issuer</span> <span class='op'>=</span> <span class='id identifier rubyid_signing_cert'>signing_cert</span><span class='period'>.</span><span class='id identifier rubyid_subject'>subject</span>

  <span class='id identifier rubyid_signed'>signed</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span> <span class='id identifier rubyid_signing_key'>signing_key</span><span class='comma'>,</span> <span class='const'><a href="../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'>Security</span><span class='op'>::</span><span class='const'><a href="#DIGEST_ALGORITHM-constant" title="Gem::Security::DIGEST_ALGORITHM (constant)">DIGEST_ALGORITHM</a></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="trust_dir-class_method">
  <h3 class='signature '>
  .<strong>trust_dir</strong>  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a <a href="Security/TrustDir.html" title="Gem::Security::TrustDir (class)">Security::TrustDir</a> which wraps the directory where trusted
certificates live.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L551-L557'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


551
552
553
554
555
556
557</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 551</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_trust_dir'>trust_dir</span>
  <span class='kw'>return</span> <span class='ivar'>@trust_dir</span> <span class='kw'>if</span> <span class='ivar'>@trust_dir</span>

  <span class='id identifier rubyid_dir'>dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='const'><a href="../Gem.html" title="Gem (module)">Gem</a></span><span class='period'>.</span><span class='id identifier rubyid_user_home'><a href="../Gem.html#user_home-class_method" title="Gem.user_home (method)">user_home</a></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.gem</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>trust</span><span class='tstring_end'>&#39;</span></span>

  <span class='ivar'>@trust_dir</span> <span class='op'>||=</span> <span class='const'><a href="../Gem.html" title="Gem (module)">Gem</a></span><span class='op'>::</span><span class='const'>Security</span><span class='op'>::</span><span class='const'><a href="Security/TrustDir.html" title="Gem::Security::TrustDir (class)">TrustDir</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="Security/TrustDir.html#new-class_method" title="Gem::Security::TrustDir.new (method)">new</a></span> <span class='id identifier rubyid_dir'>dir</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="trusted_certificates-class_method">
  <h3 class='signature '>
  .<strong>trusted_certificates</strong>(&amp;block)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Enumerates the trusted certificates via <a href="Security/TrustDir.html" title="Gem::Security::TrustDir (class)">Security::TrustDir</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L562-L564'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


562
563
564</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 562</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_trusted_certificates'>trusted_certificates</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_trust_dir'>trust_dir</span><span class='period'>.</span><span class='id identifier rubyid_each_certificate'>each_certificate</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<section class='method_details' id="write-class_method">
  <h3 class='signature '>
  .<strong>write</strong>(pemmable, path, permissions = 0600, passphrase = nil, cipher = KEY_CIPHER)  
</h3>

<div class='docstring'>
  <div class='discussion'>
    
<p>Writes <tt>pemmable</tt>+, which must respond to <tt>to_pem</tt>+ to <a href="../Gem.html#path-class_method" title="Gem.path (method)">Gem.path</a>+ with the
given <tt>permissions</tt>+. If passed <tt>cipher</tt>+ and <tt>passphrase</tt>+ those arguments
will be passed to <tt>to_pem</tt>+.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/rubygems/security.rb#L571-L583'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num'>


571
572
573
574
575
576
577
578
579
580
581
582
583</pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/rubygems/security.rb', line 571</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_pemmable'>pemmable</span><span class='comma'>,</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_permissions'>permissions</span> <span class='op'>=</span> <span class='int'>0600</span><span class='comma'>,</span> <span class='id identifier rubyid_passphrase'>passphrase</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_cipher'>cipher</span> <span class='op'>=</span> <span class='const'><a href="#KEY_CIPHER-constant" title="Gem::Security::KEY_CIPHER (constant)">KEY_CIPHER</a></span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span> <span class='id identifier rubyid_path'>path</span>

  <span class='id identifier rubyid_open'>open</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_permissions'>permissions</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_io'>io</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_passphrase'>passphrase</span> <span class='kw'>and</span> <span class='id identifier rubyid_cipher'>cipher</span>
      <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_pemmable'>pemmable</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span> <span class='id identifier rubyid_cipher'>cipher</span><span class='comma'>,</span> <span class='id identifier rubyid_passphrase'>passphrase</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span> <span class='id identifier rubyid_pemmable'>pemmable</span><span class='period'>.</span><span class='id identifier rubyid_to_pem'>to_pem</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_path'>path</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.9.0 (ruby-2.3.2p182)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>